## Reinforcement Learning Example [01-10]

Recommended article: 【Control Theory】 [Stochastic Control Theory](https://jb243.github.io/pages/895) 

---

<br>

## Q5.

Let (X<sub>t</sub>)<sub>t≥0</sub> be a stochastic process with state space S. Let P be a transition operator on functions f : S → ℝ, and let I denote the identity operator. For every bounded function f : S → ℝ, define

M<sub>t</sub><sup>f</sup> = f(X<sub>t</sub>) - f(X<sub>0</sub>) - ∑<sub>τ = 0 to (t-1)</sub> (P - I)f(X<sub>τ</sub>),

and let ℱ<sub>t</sub> = σ(X<sub>0</sub>, …, X<sub>t</sub>) be the natural filtration generated by X. Show that the following two statements are equivalent:

1. (X<sub>t</sub>)<sub>t≥0</sub> is a Markov chain with transition operator P.

2. For every bounded function f, the process (M<sub>t</sub><sup>f</sup>)<sub>t≥0</sub> is a martingale with respect to the filtration (ℱ<sub>t</sub>)<sub>t≥0</sub>.

## A5.

<br>

<br>

## Q8. 

An individual is offered 3 to 1 odds in a coin tossing game where she wins whenever a tail occurs. However, she suspects that the coin is biased and has an a priori probability distribution with CDF F(p) and pdf f(p), for the probability p that a head occurs at each toss. A maximum of T coin tosses is allowed. The individual's objective is to determine a policy of deciding whether to continue or stop participating in the game, given the outcomes of the game so far, so as to maximize her earnings.

(i) Identify an information state for the problem and write down the equation determining its evolution.

(ii) Write down the dynamic program for this problem.

## A8.

Information state can be defined as the posterior probability ℙ(outcome ㅣ prior).

**Case 1.** For general information state,

<br>

<img width="658" height="257" alt="스크린샷 2025-11-23 오후 4 54 06" src="https://github.com/user-attachments/assets/c87c2e34-0270-4a64-9710-ab0b2b064a45" />

<br>

**Case 1.** For specific information state,

<br>

<img width="703" height="353" alt="스크린샷 2025-11-23 오후 4 52 32" src="https://github.com/user-attachments/assets/b507139c-5ff2-44dd-863f-d6c91b54e452" />

<br>

<br>

## Q9. 

Show that W<sub>∞</sub>(i), i=1,…,I is the solution of the linear program: Maximize ∑<sub>i=1 to I</sub> z(i) subject to z(i) ≤ c(i,u) + β∑<sub>j=1 to I</sub> P<sub>ij</sub>(u) z(j), ∀u,i

## A9.

Let β ∈ (0, 1), a probabilistic transition matrix P(u), and the one-step cost c be given. Define the Bellman operator T by 

<br>

<center>(Tv)(i) = min<sub>u</sub> { c(i, u) + β Σ<sub>j</sub> P<sub>ij</sub>(u) v(j) }</center>

<br>

W<sub>∞</sub> is the unique fixed point of this equation: W<sub>∞</sub> = TW<sub>∞</sub>. For all i and u, we have

<br>

<center>W∞(i) = min<sub>u'</sub> { c(i, u') + β Σ<sub>j</sub> P<sub>ij</sub>(u') W<sub>∞</sub>(j) } ≤ c(i, u) + β Σ<sub>j</sub> P<sub>ij</sub>(u) W<sub>∞</sub>(j)</center>

<br>

so W<sub>∞</sub>(i) also satisfies the given inequality constraint. Since the constraint holds for all u, we have

<br>

<center>z(i) ≤ c(i, u) + β Σ<sub>j</sub> P<sub>ij</sub>(u) z(j) for all u ⇒ z(i) ≤ (Tz)(i)</center>

<br>

Here we can see the monotonicity of the operator T: 

<br>

<center>x ≤ y ⇒ c(i, u) + β Σ<sub>j</sub> P<sub>ij</sub>(u) x(j) ≤ c(i, u) + β Σ<sub>j</sub> P<sub>ij</sub>(u) y(j) ⇒ (Tx)(i) ≤ (Ty)(i)</center>

<br>

Therefore, z ≤ Tz ≤ T<sup>2</sup>z ≤ ··· ≤ lim<sub>n→∞</sub> T<sup>n</sup>z = W<sub>∞</sub>. The uniqueness of W∞ and the fact that any z converges to W<sub>∞</sub> are already guaranteed by the Banach fixed-point theorem and the Bellman contraction mapping. Moreover, any feasible z is bounded as follows:

<br>

<center>||z||<sub>∞</sub> ≤ max<sub>i,u</sub> c(i, u) + β ||z||<sub>∞</sub> ⇔ ||z||<sub>∞</sub> ≤ max<sub>i,u</sub> c(i, u) / (1 − β)</center>

<br>

Hence Σ<sub>i</sub> z(i) ≤ Σ<sub>i</sub> W<sub>∞</sub>(i). In summary, W<sub>∞</sub> is a feasible solution that satisfies the constraints of the given linear program, and since z ≤ W<sub>∞</sub> for all feasible z, the solution that maximizes Σ<sub>i</sub> z(i) is z = W<sub>∞</sub>, and this W<sub>∞</sub> is unique.

<br>

<br>

## Q10.

Show that the minimum cost is the solution of the linear program: maximize J\* subject to J\* + w(i) ≤ c(i,u) + ∑<sub>j=1 to I</sub> P<sub>ij</sub>(u)w(j), 1 ≤ i ≤ I, u ∈ U.

## A10.

We can define J<sub>opt</sub>\* as follows: J<sub>opt</sub>\* + h(i) = min<sub>u∈U</sub> {c(i,u) + ∑<sub>j</sub> P<sub>ij</sub>(u)h(j)}, ∀i. If we set w(i) = h(i), we know J<sub>opt</sub>\*, which is LP feasible solution, achieves the minimum cost, implying 

<br>

<img width="342" height="83" alt="스크린샷 2025-11-23 오후 6 17 00" src="https://github.com/user-attachments/assets/eec71741-3dfc-49f8-81f9-2ede93d90aee" />

<br>

For any arbitrary i, u, and LP feasible solution L, we have

<br>

<img width="650" height="239" alt="스크린샷 2025-11-23 오후 6 20 29" src="https://github.com/user-attachments/assets/c263a250-d760-4bf6-8363-2b3f4852904e" />

<br>

Let g be an **optimal stationary policy** whose long-run average cost is J<sub>opt</sub>*. Then 

<br>

<img width="451" height="117" alt="스크린샷 2025-11-23 오후 6 23 00" src="https://github.com/user-attachments/assets/c7542dbd-6944-4e9b-a62e-a484907413d1" />

<br>

Here, I used the sample-path optimality (a stronger statement), which can be derived from the Martingale difference sequence (MDS). Let J\* := sup{J ㅣ ∃w s.t. (J, w) is LP feasible} be the optimal value of the LP. Since J<sub>opt</sub>\* ≥ J for every LP feasible J, we have J<sub>opt</sub>\* ≥ J\*. Therefore, the minimal cost J<sub>opt</sub>\* from the Bellman optimality equation is identical to J\* from: max J\* s.t. J\* + w(i) ≤ c(i, u) + ∑<sub>j</sub> P<sub>ij</sub>(u) w(j).

<br>

---

_Input: 2025.11.21 01:30_
