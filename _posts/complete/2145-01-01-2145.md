## **Chapter 21. Information Theory**

Higher category: „ÄêStatistics„Äë [Statistics Table of Contents](https://jb243.github.io/pages/1641)

---

**1.** [Information Theory](#1-information-theory)

**2.** [Variational Inference](#2-variational-inference)

**3.** [Modern Information Theory](#3-modern-information-theory)

---

<br>

## **1. Information Theory** 

‚ë¥ Overview

> ‚ë† low probability event: high information (surprising)

> ‚ë° high probability event: low information (unsurprising)

‚ëµ **entropy**

> ‚ë† Problem situation: X is Raining / Not Raining. Y is Cloudy / Not Cloudy

<br>

![image](https://github.com/user-attachments/assets/f4447d82-f083-4fba-bfaf-878ce3eddad5)

**Figure. 1.** Entropy example

<br>

> ‚ë° Basic concepts of statistics

<br>

![image](https://github.com/user-attachments/assets/90a112db-da94-4402-b82e-1fec9f6f8250)

<br>

> ‚ë¢ **Information** (information content) or **Uncertainty** (surprisal, unexpectedness, randomness)

>> ‚óã The amount of mathematical uncertainty measured.

<br>

![image](https://github.com/user-attachments/assets/eecbe1e8-4df2-4734-b607-b052a68d2970)

<br>

>> ‚óã When the base is 2, the unit used is **bits**

>> ‚óã When the base is e (natural logarithm), the unit used is **nats**

>> ‚óã **Feature 1.** If p(x<sub>i</sub>) = 1, I(x<sub>i</sub>) = 0

>> ‚óã **Feature 2.** I(x<sub>i</sub>) ‚â• 0

>> ‚óã **Feature 3.** If P(x = x<sub>i</sub>) < P(x = x<sub>j</sub>), I(x<sub>i</sub>) > I(x<sub>j</sub>)

>> ‚óã **Feature 4.** If x<sub>i</sub> and x<sub>j</sub> are independent, I(x<sub>i</sub>x<sub>j</sub>) = I(x<sub>i</sub>) + I(x<sub>j</sub>)

> ‚ë£ **entropy** (self information, Shannon entropy)

<br>

![image](https://github.com/user-attachments/assets/1cc47b13-3030-4c88-a752-67883f0a78e0)

<br>

>> ‚óã Understanding

>>> ‚óã In other words, entropy is defined as the average value of uncertainty

>>> ‚óã Similar to entropy in physics, higher values are obtained as disorder increases: higher entropy means higher heterogeneity

>>> ‚óã It applies the surprisal (-log p(x)) of each event to the probability weight (p(x)) of each event

>>> ‚óã Redundancy = Maximum entropy - Actual entropy 

>> ‚óã Examples

>>> ‚óã Fair coin toss: H = -0.5 log<sub>2</sub> 0.5 - 0.5 log<sub>2</sub> 0.5 = 1

>>> ‚óã Fair die ****: H = 6 √ó (-(1/6) log2 (1/6)) = log<sub>2</sub> 6 = 2.58

>>> ‚óã If X follows a uniform distribution, H(X) = log n holds

>> ‚óã **Source Coding Theorem**

>>> ‚óã Definition: For a very long data sequence, if the compression rate is maximized, the average number of bits of the compressed data approaches the entropy.

>>> ‚óã In other words, it refers to the number of bits required to represent a given set of possibilities.

>>> ‚óã When stored in base log2, it represents the number of bits; when stored in base logk, it indicates the required storage capacity in a k-ary system.

>>> ‚óã Kraft's Inequality: A constraint that ensures every entity can be represented by a unique bit sequence.

<br>

<img width="110" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 26 20" src="https://github.com/user-attachments/assets/2c4e1074-4ad3-4761-bc84-d71a8a2e7e60">

<br>

>>> ‚óã Proof of the Source Coding Theorem: For the average number of bits p<sub>1</sub>L<sub>1</sub> + ¬∑¬∑¬∑ + p<sub>n</sub>L<sub>n</sub>, 

<br>

<img width="408" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 26 39" src="https://github.com/user-attachments/assets/9eead6f7-6a45-4122-97cd-78e3419c5bb2">

<br>

>> ‚óã **Feature 1.** H(X) is shift-invariant

>>> ‚óã When Y = X + a, H(Y) = H(X) is established because p<sub>Y</sub>(y) = p<sub>X</sub>(x)

>> ‚óã **Feature 2.** H(X) ‚â• 0

>> ‚óã **Feature 3.** H<sub>b</sub>(X) = (log<sub>b</sub>a) H<sub>a</sub>(X) (where a and b are under the log)

>>> ‚óã log<sub>b</sub>p = (log<sub>b</sub>a) log<sub>a</sub>p

>> ‚óã [Python code](https://jb243.github.io/pages/1892#6-data-science)

<br>

```python
import numpy as np

def shannon_index(data):
    # Count unique values and their occurrences in the data
    values, counts = np.unique(data, return_counts=True)
    # Calculate proportions using the counts
    proportions = counts / sum(counts)
    # Calculate Shannon index, considering only non-zero proportions
    return -np.sum(proportions * np.log(proportions))

# Example data, where '1' appears 3 times, '2' appears 2 times, and '3' appears 1 time
data = [1, 1, 1, 2, 2, 3]

# Calculate the Shannon index
index = shannon_index(data)
print(f"Shannon index: {index}")
```

<br>

> ‚ë§ **joint entropy**

<br>

![image](https://github.com/user-attachments/assets/a1629e13-50e6-41dc-ab4c-d3e019f43956)

<br>

>> ‚óã **Feature 1.** H(X, Y) ‚â§ H(X) + H(Y): If X and Y are independent, H(X, Y) = H(X) + H(Y)

<br>

![image](https://github.com/user-attachments/assets/99f05cd3-ae07-47be-9fea-6b47cf76bab6)

<br>

> ‚ë• Conditional entropy 

<br>

<img width="399" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 27 05" src="https://github.com/user-attachments/assets/79573d57-e38c-4814-a98a-c6b406887948">

**Figure 2.** Conditional entropy visualization

<br>

>> ‚óã Conditional entropy for a specific condition

<br>

![image](https://github.com/user-attachments/assets/02940ee2-e413-4764-86c1-c5908990fad6)

<br>

>> ‚óã Total conditional entropy

<br>

![image](https://github.com/user-attachments/assets/7515233b-4df3-4c8e-bb12-633fb81515ca)

<br>

>> ‚óã Information gain (IG): The increase in order when knowing the information X

<br>

![image](https://github.com/user-attachments/assets/3cafead2-4743-49b1-b16c-a31f94078af7)

<br>

>> ‚óã Information bottleneck method (IB): Describing the trade-off between complexity and accuracy using information theory

>>> ‚óã Application: For example, it can determine the number of clusters in given data.

>> ‚óã **Feature 1.** <span>If X and Y are independent, H(Y | X) = H(Y) (cf. H(Y | X) ‚â§ H(Y))</span>

>> ‚óã **Feature 2.** <span>H(Y | Y) = 0</span>

>> ‚óã **Feature 3.** <span>H(X, Y) = H(X) + H(Y | X) = H(Y) + H(X | Y) (Chain rule)</span>

<br>

![image](https://github.com/user-attachments/assets/3f18240f-075c-4472-a5d7-654367f1ec05)

<br>

>> ‚óã **Feature 4.** <span>H(X, Y | Z) = H(X | Z) + H(Y | X, Z)</span>

<br>

![image](https://github.com/user-attachments/assets/db9b3304-b22b-45c1-ba1a-fc5144bc54c4)

<br>

> ‚ë¶ Mutual information

<br>

![image](https://github.com/user-attachments/assets/48c3b578-404b-4a60-8716-075f76d167a4)

**Figure 3.** Mutual information visualization

<br>

![image](https://github.com/user-attachments/assets/cf5601dc-4005-46e4-90eb-aac7d2ea3213)

<br>

>> ‚óã Information gain and mutual information are equivalent.

<br>

![image](https://github.com/user-attachments/assets/623c7074-1df2-4754-aea9-462b3bd902cd)

<br>

>> ‚óã **Feature 1.** <span>I(X; Y) = H(Y) - H(Y | X) = H(X) - H(X | Y)</span>

>> ‚óã **Feature 2.** Mutual information ‚â• 0 (equality condition: X and Y are independent)

<br>

![image](https://github.com/user-attachments/assets/59461716-2a41-4e0e-a12d-c71b84cd7176)

<br>

>> ‚óã **Feature 3.** <span>H(X | Y) ‚â§ H(X)</span> (equality condition: X and Y are independent)

<br>

![image](https://github.com/user-attachments/assets/35f238be-2a97-43df-91d4-03ba6f4da15e)

<br>

>> ‚óã **Feature 4.** I(X; Y) ‚â§ H(X, Y): H(X, Y) - I(X; Y) satisfies the definition of [mathematical distance](https://jb243.github.io/pages/1897).

>> ‚óã **Application 1.** Mutual information can be used for assessing image [similarity](https://jb243.github.io/pages/879).

>> ‚óã **Application 2.** mRMR (maximum relevance minimum redundancy): A technique used to select features that have high mutual information with the output while having low mutual information among themselves. It is commonly used in machine learning. Matlab code is as follows:

<br>

```python
% Rank features using mRMR
selected_features_idx = fscmrmr(features, labels);
```

<br>

> ‚ëß Relative entropy (Kullback Leibler divergence, KL divergence, KLD) 

<br>

![image](https://github.com/user-attachments/assets/8b185bbb-b87b-4aed-9c94-13473e673ecb)

<br>

>> ‚óã Overview

>>> ‚óã A measure of how two probability distributions diverge.

>>> ‚óã It indicates the divergence between an approximate distribution p(x), which aims to mimic the true distribution, and the true distribution q(x).

>>> ‚óã Typically, the true distribution is a complex probability distribution function, while the approximate distribution is represented using a parameterized model.

>>> ‚óã The approximate distribution can be made manageable, often resembling a simple distribution like the normal distribution.

>>> ‚óã Strictly speaking, it does not satisfy the definition of [mathematical distance](https://jb243.github.io/pages/1897).

>> ‚óã **Feature 1.** asymmetry: <span>D<sub>KL</sub>(p(x) || q(x)) ‚â† D<sub>KL</sub>(q(x) || p(x)) (‚à¥ violates the definition of [mathematical distance](https://jb243.github.io/pages/1897#2-vector-space))</span>

<br>

![image](https://github.com/user-attachments/assets/c8c4f819-5503-4f00-87d3-7b3dd8467844)

**Figure 4.** The difference between D<sub>KL</sub>(p <span>||</span> q) and D<sub>KL</sub>(q <span>||</span> p)

<br>

>> ‚óã **Feature 2.** <span>D(p || q) ‚â• 0 (equality condition: p(x) = q(x))</span>

<br>

![image](https://github.com/user-attachments/assets/83f900e8-5a68-4c98-addf-9f05977d65b5)

<br>

>> ‚óã **Feature 3.** H(X) ‚â§ log n (where n is the number of elements X can take)

<br>

![image](https://github.com/user-attachments/assets/1a2088c2-6894-4ea2-8401-4f826c073399)

<br>

>> ‚óã **Application.** Determining the predictive data distribution p with the smallest KL distance to the true unknown data distribution q.

>>> ‚óã Maximizing log-likelihood minimizes KL distance.

<br>

![image](https://github.com/user-attachments/assets/ad9dee99-bddb-4510-b47e-49df98ab4fa1)

<br>

>> ‚óã **Application.** Jensen-Shannon divergence (JSD)

<br>

<img width="320" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-05 ·Ñã·Ö©·Ñí·ÖÆ 8 19 21" src="https://github.com/user-attachments/assets/7da22610-67d2-4a0f-a0a3-2c58ed8fcfdf">

<br>

> ‚ë® **cross entropy**

>> ‚óã Definition: Average number of bits required to distinguish two probability distributions, p and q.

>> ‚óã In machine learning, model prediction.

<br>

<img width="368" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 29 36" src="https://github.com/user-attachments/assets/53aeb867-600e-4992-a32f-81d2ff344d9a">

<br>

>> ‚óã **Feature 1.** <span>-‚àë p<sub>i</sub> log q<sub>i</sub> = H(p) + D<sub>KL</sub>(p || q)</span>

>> ‚óã **Feature 2.** <span>Minimizing D<sub>KL</sub>(p || q) is the same as minimizing cross-entropy because H(p) is constant.</span>

>> ‚óã **Feature 3.** When minimizing -‚àë p<sub>i</sub> log qi under the assumption that p<sub>i</sub> follows a uniform distribution, this is called [maximum likelihood estimation](https://jb243.github.io/pages/1630).

> ‚ë© Asymptotic equipartition property (AEP)

<br>

![image](https://github.com/user-attachments/assets/2b493dbc-eb31-4576-bb58-a747e1ae8770)

<br>

‚ë∂ **Comparison 1.** `R√©nyi Entropy`

> ‚ë† Hartley (max) entropy: For a source represented by M symbols (e.g., if expressed with the alphabet, M = 26)

<br>

<img width="99" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 42 57" src="https://github.com/user-attachments/assets/dfc6dad8-e734-4a56-8ea6-12ac59454d20">

<br>

> ‚ë° Min entropy: Related to signal processing

<br>
 
<img width="164" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 43 23" src="https://github.com/user-attachments/assets/3a4c9f50-0410-42b8-847e-e0e4ca37ad74">

<br>

> ‚ë¢ R√©nyi entropy: Encompasses Shannon entropy (Œ± ‚Üí 1; by [L'H√¥pital's rule](https://jb243.github.io/pages/1810)), max entropy (Œ± ‚Üí 0), and min entropy (Œ± ‚Üí ‚àû)

<br>

<img width="209" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 43 42" src="https://github.com/user-attachments/assets/50945683-db17-4a63-be38-7ba92b3f8181">

<br>

> ‚ë£ R√©nyi divergence: As Œ± ‚Üí ‚àû, R√©nyi divergence converges to KL divergence (‚àµ [L'H√¥pital's rule](https://jb243.github.io/pages/1810))

<br>

<img width="504" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-01 ·Ñã·Ö©·Ñí·ÖÆ 1 44 09" src="https://github.com/user-attachments/assets/9d1695e0-3858-4a2f-b4c7-7d890a7a9ae3">

<br>

‚ë∑ **Comparison 2.** Sample Entropy

> ‚ë† A dynamic measure that reflects time

> ‚ë° Important in signal processing

‚ë∏ **Comparison 3.** `Gini impurity`

<br>

![image](https://github.com/user-attachments/assets/88b5c89d-77b8-49c2-8e50-a9db6bb72306)

<br>

> ‚ë† Entropy is not the unique measure, alternative measures like Gini impurity are proposed.

> ‚ë° Gini impurity considers the probability of mislabeling (1 - P(x<sub>i</sub>)) weighted by the weight of each sample (P(x<sub>i</sub>)).

> ‚ë¢ Both Gini impurity and entropy increase as the given data becomes more disordered: Origin of impurity.

> ‚ë£ (Conceptual Distinction) The Gini Coefficient in Economics

>> ‚óã The concept was first introduced to evaluate income inequality: It can assess not only income but also the degree of inequality in the distribution of a discrete variable.

>> ‚óã As the Gini coefficient moved from economics to the fields of machine learning and information theory, it implies similar inequality, but the mathematical definition changes.

>> ‚óã Difference: If the distribution of the variable is entirely uniform,

>>> ‚óã In economics, the Gini coefficient becomes extremely egalitarian, so it has a value of 0.

>>> ‚óã In information theory, the Gini coefficient attains its maximum value due to the Cauchy-Schwarz inequality. Intuitively, it becomes most disordered, thus reaching the maximum value.

‚ëπ **Comparison 4.** `Connectivity index (CI)`

> ‚ë† In a spatial lattice, if a specific spot and its nearest neighbor are in different clusters, the CI value increases.

> ‚ë° Therefore, a higher CI value implies higher heterogeneity.

‚ë∫ **Comparison 5.** `Simpson index`

> ‚ë† Another measure based on information theory, along with Shannon entropy. D = ‚àë<sub>i</sub> p<sub>i</sub><sup>2</sup>

> ‚ë° Based on spatial transcriptomics, the probability of two random spots belonging to the same cluster ([ref](https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-023-01185-4#Sec2))

> ‚ë¢ The lower the Simpson index, the higher the heterogeneity implied

‚ëª **Comparison 6.** `Cluster modularity`

> ‚ë† Based on spatial transcriptomics, a metric indicating the purity (homogeneity) of spots within a cluster ([ref](https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-023-01185-4#Sec2))

‚ëº **Comparison 7.** `Lempel-Ziv complexity`

‚ëΩ **Comparison 8.** `Silhouette coefficient`

‚ëæ **Comparison 9.** `Calinski-Harabasz index`

<br>

<br>

## **2. Variational Inference**

‚ë¥ Overview

> ‚ë† The probability that B was the cause when A was observed, denoted as P(B <span>|</span> A), is called the posterior probability (cf. Bayes' theorem).

> ‚ë° Variational Inference: A method to infer a complex posterior distribution by introducing a simpler variational distribution and conducting inference in a way that reduces the difference between the two.

‚ëµ ELBO (Evidence Lower Bound): The standard method for variational inference

> ‚ë† Jensen's inequality: For functions like the logarithmic function, which are concave, the following holds:

<br>

<img width="173" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-09 ·Ñã·Ö©·Ñå·Ö•·Ü´ 10 37 33" src="https://github.com/user-attachments/assets/bcac6af1-fe2c-415b-b9be-274b6b760867">

<br>

> ‚ë° Problem situation: It is difficult to directly calculate the log evidence of a model, log p(x), for the given data x and latent variables z.

<br>

<img width="238" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-09 ·Ñã·Ö©·Ñå·Ö•·Ü´ 10 37 59" src="https://github.com/user-attachments/assets/4cffefc3-3dbd-4dd2-b043-12baa731711b">

<br>

> ‚ë¢ [Mathematical formulation](https://mpatacchiola.github.io/blog/2021/01/25/intro-variational-inference.html):

<br>

<img width="550" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-09 ·Ñã·Ö©·Ñå·Ö•·Ü´ 10 38 44" src="https://github.com/user-attachments/assets/f19a0dc8-7ed9-44c2-8483-2bb896181d3d">

<br>

>> ‚óã ELBO = ùîº<sub>q(z)</sub> [log p(x,z)] - ùîº<sub>q(z)</sub> [log q(z)]

>> ‚óã In variational inference, maximizing the ELBO makes the inequality approach equality.

>> ‚óã When the equality is established p(x,z)/q(z) becomes constant with respect to z.

>> ‚óã p(x,z) / q(z) = constant with respect to z ‚áî q(z) ‚àù p(x,z) ‚áî q(z) = q(z„Ö£x) = p(x,z) / p(x) = p(z„Ö£x) 

>> ‚óã **Conclusion:** Maximizing the ELBO makes the variational distribution q(z„Ö£x) close to the true posterior p(z„Ö£x).

> ‚ë£ **Example 1**

<br>

<img width="503" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2024-10-09 ·Ñã·Ö©·Ñå·Ö•·Ü´ 10 39 49" src="https://github.com/user-attachments/assets/9b3762d5-cb07-45b7-8e92-7b085f2bf10d">

<br>

> ‚ë§ **Example 2.** [Loss functions of Variational Autoencoder (VAE) and Graph Variational Autoencoder (GVAE)](https://jb243.github.io/pages/2432)

<br>

<br>

## **3. Modern Information Theory** 

‚ë¥ History

> ‚ë† Ludwig Boltzmann (1872): Proposed the H-theorem to explain the entropy of gas particles.

> ‚ë° Harry Nyquist (1924): Quantified the speed at which "intelligence" is propagated through a communication system.

> ‚ë¢ John von Neumann (1927): Extended Gibbs free energy to quantum mechanics.

> ‚ë£ Ralph Hartley (1928): Expressed the number of distinguishable information by using logarithms.

> ‚ë§ Alan Turing (1940): Introduced deciban for decrypting the German Enigma cipher.

> ‚ë• Richard W. Hamming (1947): Developed Hamming code.

> ‚ë¶ Claude E. Shannon (1948): Pioneered information theory. [A Mathematical Theory of Communication](https://people.math.harvard.edu/~ctm/home/text/others/shannon/entropy/entropy.pdf)

> ‚ëß Solomon Kullback & Richard Leibler (1951): Introduced Kullback-Leibler divergence

> ‚ë® David A. Huffman (1951): Developed Huffman encoding.

> ‚ë© Alexis Hocquenghem & Raj Chandra Bose & Dwijendra Kumar Ray-Chaudhuri (1960): Developed BCH code.

> ‚ë™ Irving S. Reed & Gustave Solomon (1960): Developed Reed-Solomon code.

> ‚ë´ Robert G. Gallager (1962): Introduced low-density parity check.

> ‚ë¨ Kolmogorov (1963): Introduced Kolmogorov complexity (minimum description length).

> ‚ë≠ Abraham Lempel & Jacob Ziv (1977): Developed Lempel-Ziv compression (LZ77).

> ‚ëÆ Claude Berrou & Alain Glavieux & Punya Thitimajshima (1993): Developed Turbo code.

> ‚ëØ Erdal Arƒ±kan (2008): Introduced polar code.

‚ëµ **Type 1.** Encryption

> ‚ë† Huffman code

> ‚ë° Shannon code

> ‚ë¢ Shannon-Fano-Elias code (alphabetic code)

‚ë∂ **Type 2.** Compression

> ‚ë† Uniquely decodable (UD)

> ‚ë° Kraft inequality

‚ë∑ **Type 3.** Network information theory

‚ë∏ **Type 4.** Quantum information theory

<br>

---

_Input: 2021-11-10 22:28_

_Modified: 2023-03-21 16:22_
