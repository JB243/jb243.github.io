## **Proof of Fermat's Last Theorem**

Recommended posts: 【Modern Mathematics】 [Group Theory](https://jb243.github.io/pages/2082)

---

**1.** [Overview](#1-overview)

**2.** [Step 1. Kummer’s attempt](#2-step-1-kummers-attempt-1840s)

**3.** [Step 2. Ribet’s theorem (Serre’s $$\varepsilon$$-conjecture)](#3-step-2-ribets-theorem-serres-varepsilon-conjecture)

**4.** [Step 3. Wiles’s proof](#4-step-3-wiless-proof)

**5.** [Subsequent research](#5-subsequent-research)

---

<br>

## **1. Overview**

⑴ Infinite descent

> ① **Problem :** Prove that $$\sqrt{2}$$ is irrational.

> ② **Proof :** Proven by the Pythagorean school

>> Let $$\sqrt{2} = \frac{b}{a}$$ with $$a,b \in \mathbb{Z}$$.

>> **∴** $$2a^2 = b^2 \Rightarrow 2 \mid b \Rightarrow 2 \mid a \Rightarrow 2^2 \mid b \Rightarrow 2^2 \mid a \Rightarrow \cdots$$

>> **∴** $$2^\infty \mid a, b \Rightarrow$$ impossible

>> **∴** $$\sqrt{2} \notin \mathbb{Q}$$

⑵ Fermat’s infinite descent

> ① **Problem :** Prove that there are no integer solutions $$x, y, z$$ to $$x^4 + y^4 = z^2$$.

> ② **Proof :** Proven by Fermat

>> Even if an arbitrary $$(x, y, z)$$ is given, after reducing appropriately we may assume $$\gcd(x, y) = 1$$. If $$\gcd(x, y) = 1$$, then $$(x^2, y^2, z)$$ are pairwise coprime, so they form a Pythagorean triple. We may assume without loss of generality that $$x^2 = m^2 - n^2, y^2 = 2mn, z = m^2 + n^2$$. From this we see that $$y$$ is even, so we may assume without loss of generality that $$m = 2a, n = 2b+1$$. Looking at $$x^2 = m^2 - n^2 = (m+n)(m-n)$$, we have $$\gcd(m+n, m-n) = \gcd(m+n, 2n) = 1$$ (**∵** $$\gcd(x, y) = 1$$). Therefore we can set $$m+n = v^2, m-n = w^2$$, and since $$v, w$$ are odd, the remainders of $$(m+n)$$ and $$(m-n)$$ upon division by $$4$$ are $$1$$. We have $$2m = (m+n) + (m-n) \equiv 1 + 1 = 2 \pmod{4}$$, but $$2m = 4a \equiv 0 \pmod{4}$$, a contradiction. Of note, this solution did not use the method of infinite descent.

⑶ Fermat’s right-triangle problem: Claimed in a letter to Digby and Carcavi

> ① **Problem:** Show that among right triangles with rational side lengths, none has area $$1$$.

⑷ Fermat's Last Theorem (Fermat's Last Theorem, FLT; 1637)

> ① **Problem:** Let the Fermat equation be $$x^n + y^n = z^n$$ ($$n \ge 3$$). Prove that there is no integer solution $$x, y, z \in \mathbb{Z}$$ with $$xyz \ne 0$$.

> ② **Proof:** To solve the difficult FLT, prove an even more difficult elliptic-curve problem (see below).

> ③ For $$n = 4$$ there is a separate proof by Fermat, and for $$n = 3$$ Euler proved it.

> ④ “The margin is too small to contain the proof”: A famous note Fermat left in the margin next to a particular problem in Diophantus’s *Arithmetica*

<br>

<br>

## **2. Step 1.** Kummer’s attempt (1840s)

⑴ **Summary**: FLT, a purely integer Diophantine problem, is equivalent to a problem about certain algebraic objects (rings/curves/groups).

⑵ **Group-theoretic concepts**

> ① Units: You must know what a unit is to distinguish being a $$p$$-th power from being a unit times a $$p$$-th power

> ② Ideal: An additive subset closed under multiplication inside the ring of integers $$\mathbb{Z}[\zeta]$$

> > ○ Mathematical expression: $$M\cdot\mathbb{Z}[\zeta] \subset \Omega \subset \mathbb{Z}[\zeta]$$ (some $$M \in \mathbb{Z}$$) s.t. $$\alpha\Omega \subset \Omega$$ if $$\alpha \in \mathbb{Z}[\zeta]$$

> > ○ **Type 1.** Principal ideal: $$\Omega = \beta\cdot\mathbb{Z}[\zeta]$$, etc.

> > ○ **Type 2.** Non-principal ideal: The case where unique factorization (UFD) breaks

> ③ Ideal class group: $$\mathrm{Cl}_{\mathbb{Z}[\zeta]} = {\text{all ideals}}/{\text{principal ideals}}$$

> > ○ That is, the ideal group modulo the subgroup of principal ideals.

⑶ **1-1.** If a counterexample to FLT exists, then $$z^p = x^p + y^p = (x + \zeta^0 y) \times \cdots \times (x + \zeta^{p-1} y)$$, where $$\zeta = \exp\left(\frac{2\pi i}{p}\right)$$.

> ① For example, the fact that $$\sum_{k=0}^{p-1}\zeta^k = 0$$ can be seen from the fact that the vector sum on the complex plane is $$0$$.

⑷ **1-2.** Between each factor $$(x + \zeta^i y)$$ and $$(x + \zeta^j y)$$, they are “almost coprime.”

> ① For example, when computing the gcd of $$x + \zeta y$$ and $$x + \zeta^2 y$$ via the Euclidean algorithm, we obtain $$(x + \zeta y)(1 + \zeta) - (x + \zeta^2 y) = \zeta(x + y)$$.

> ② That is, for $$(x + \zeta y)$$ and $$(x + \zeta^2 y)$$ to share a common divisor, that divisor must also appear on the $$(x+y)$$ side, imposing many constraints on $$(x+y)$$.

> ③ Hence it is likely that $$(x + \zeta y)$$ and $$(x + \zeta^2 y)$$ are coprime (this is the meaning of “almost coprime”).

⑸ **1-3.** From the “almost coprime” condition and the fact that the left-hand side of FLT is $$z^p$$, it suggests each factor must be a $$p$$-th power of some number.

⑹ **1-4.** If $$p \nmid$$ ＃$$\mathrm{Cl}(\mathbb{Z}[\zeta])$$, then one can lift an ideal $$p$$-th power to an element $$p$$-th power or its unit multiple, yielding a contradiction → prove FLT by contradiction

> ① $$ (a) = \mathfrak{I}^p $$ means $$[\mathfrak{I}]^p = 1$$ in the class group.

> ② Since $$p \nmid$$ ＃$$\mathrm{Cl}$$, there is no $$p$$-torsion in $$\mathrm{Cl}$$, so $$[\mathfrak{I}] = 1$$, i.e., $$\mathfrak{I}$$ is principal.

> ③ Therefore $$\mathfrak{I} = (b)$$ and $$(a) = (b^p)$$, so $$a = u b^p$$ (unit: $$u$$).

> ④ [Conrad’s proof](https://kconrad.math.uconn.edu/blurbs/gradnumthy/fltreg.pdf)
>: Under this condition one obtains $$x + y \equiv 0 \pmod{p}$$ or $$x \equiv y \equiv -z \pmod{p}$$, and in each concrete case one can easily find a contradiction.

⑺ **1-5.** The case $$p \mid$$ ＃$$\mathrm{Cl}_\mathbb{Z}[\zeta] \Leftrightarrow p \mid B_2 \times \cdots \times B_{p-3}$$ (where $$B_i$$ are Bernoulli numbers) is outside the range where Kummer’s attempt applies.

> ① Here $$\frac{t}{\exp(t) - 1} = 1 + \frac{B_0 t^0}{0!} + \cdots + \frac{B_n t^n}{n!} + \cdots$$ holds.

> ② Mazur–Wiles: Analyze the entire structure of how the part related to $$p$$ grows and which function exactly generates that structure.

<br>

<br>

## **3. Step 2.** Ribet’s theorem (Serre’s $$\varepsilon$$-conjecture)

⑴ **Summary**: If the Frey curve is (under the assumption) ‘modular’, then no counterexample to FLT can exist.

⑵ **Group-theoretic concepts**

> ① $$\mathrm{Frob}_\ell$$: A handle for reading information at each prime

> > ○ $$\zeta_p$$: A primitive $$p$$-th root of unity. It satisfies $$\frac{x^p - 1}{x - 1} = x^{p-1} + \cdots + 1 = 0$$. e.g. $$e^{2\pi i/p}$$

> > ○ $$\mathbb{Q}(\zeta_p)$$: A number field containing $$\zeta_p$$ (cyclotomic field, cyclotomic character)

> > ○ $$\sigma \in \mathrm{Gal}(\mathbb{Q}(\zeta_p)/\mathbb{Q})$$: A map fixing $$\mathbb{Q}$$ and sending $$\mathbb{Q}(\zeta_p)$$ to itself. In particular, $$\sigma(\zeta_p)$$ satisfies the condition of being another primitive $$p$$-th root of unity.

> > ○ $$(\cdot)^\times$$: The elements in the set that have multiplicative inverses (units)

> > ○ $$\mathbb{Z}/p\mathbb{Z}$$: The residual classes mod $$p$$, i.e. $$\{0, 1, 2, \cdots, p-1\}$$

> > ○ $$(\mathbb{Z}/p\mathbb{Z})^\times = \{a \in \mathbb{Z}/p\mathbb{Z}\mid \exists b \text{ s.t. } ab \equiv 1 \pmod{p}\}$$, i.e. the set of elements with inverses mod $$p$$

> > ○ $$\mathrm{Gal}(\mathbb{Q}(\zeta_p)/\mathbb{Q}) \simeq (\mathbb{Z}/p\mathbb{Z})^\times$$: Describes that, as in Kummer’s attempt, the number field corresponds 1:1 with residual classes.

> > ○ Concretely, we can write the above isomorphism as $${\sigma_\ell : \zeta_p \mapsto \zeta_p^\ell} \leftrightarrow \ell \bmod p$$

> > > ○ If $$\ell$$ is coprime to $$p$$ (in particular, a prime $$\ell \ne p$$), then $$\ell \bmod p \in (\mathbb{Z}/p\mathbb{Z})^\times$$

> > > ○ If $$\ell \equiv 1 \pmod{p}$$ then $$\sigma_\ell(\zeta_p) = \zeta_p$$, so the element becomes close to the identity.

> > > ○ If $$\ell \equiv -1 \pmod{p}$$ then $$\zeta_p \mapsto \zeta_p^{-1}$$ (over the complex numbers this is linked to complex conjugation).

> > ○ We call $$\sigma_\ell$$ the Frobenius at $$\ell$$ (i.e. $$\mathrm{Frob}_\ell$$)

> > > ○ Why it is called Frobenius: A prime $$\ell \ne p$$ is unramified in $$\mathbb{Q}(\zeta_p)/\mathbb{Q}$$ (ramification occurs only at $$p$$).

> ② **Kronecker–Weber theorem**

> > ○ Every abelian extension of $$\mathbb{Q}$$ is generated by roots of unity. The simplest success case.

> ③ **Class field theory** (Hilbert, Takagi, Artin, Hasse, etc.)

> > ○ Extend the Kronecker–Weber theorem to a general number field $$F$$: Complete classification of abelian extensions (1-dimensional representations)

> > > ○ Example: $$F = \mathbb{Q}(2^{1/3})$$

> > ○ $$\exists F_{\mathfrak{p}} \text{ s.t. } \mathrm{Gal}(F_{\mathfrak{p}}/F) \simeq (\mathcal{O}_F/\mathfrak{p}\mathcal{O}_F)^\times / (\text{image of } \mathcal{O}_{F,+}^\times)$$ where $$\mathcal{O}_F = \mathbb{Z}[2^{1/3}]$$,
> > and $$\mathcal{O}_{F,+}^\times =$$ units of $$\mathcal{O}_F$$

> > > ○ $$F_{\mathfrak{p}}$$: A ray class field that may ramify only at $$\mathfrak{p}$$ (or the prime factors of $$\mathfrak{p}\mathcal{O}_F$$) and is unramified elsewhere (mod $$\mathfrak{p}$$ or $$\mathfrak{p}\cdot\infty$$).

> > > ○ $$(\mathcal{O}_F/\mathfrak{p}\mathcal{O}_F)^\times$$ or $$(\mathcal{O}_F/\mathfrak{p})^\times$$: A generalization of $$(\mathbb{Z}/p\mathbb{Z})^\times$$ from $$\mathbb{Q}$$

> > > ○ image of $$\mathcal{O}_F^\times$$: Reducing each unit $$u \in \mathcal{O}_F^\times$$ modulo $$\mathfrak{p}$$ gives $$u \mapsto \bar{u} \in (\mathcal{O}_F/\mathfrak{p})^\times$$. The set of such reduced units inside $$(\mathcal{O}_F/\mathfrak{p})^\times$$ is called the image of $$\mathcal{O}_F^\times$$.

> > ○ In general, the ray class group $$\mathrm{Cl}_{\mathfrak{p}}$$ = residual unit information mod $$\mathfrak{p}$$ + the original ideal class group information

> > > ○ Because of the residual unit information, $$\mathrm{Gal}(F_{\mathfrak{p}}/F)$$ equals exactly $$(\mathcal{O}_F/\mathfrak{p})^\times/\mathrm{im}(\mathcal{O}_F^\times)$$ only when $$\mathrm{Cl}(\mathcal{O}_F)=1$$ (= ideal class group).

> > > ○ That is, $$1 \to (\mathcal{O}_F/\mathfrak{p})^\times/\mathrm{im}(\mathcal{O}_F^\times) \to \mathrm{Cl}_{\mathfrak{p}} \to \mathrm{Cl}(\mathcal{O}_F) \to 1$$

> ④ **Elliptic curves**

> > ○ $$E/\mathbb{Q}$$: An elliptic curve $$E$$ given by an equation with coefficients in $$\mathbb{Q}$$

> > ○ Weierstrass form: $$y^2 = x^3 + Ax + B \quad (A, B \in \mathbb{Q})$$

> > ○ $$E(\mathbb{C}) \simeq \mathbb{C}/\Lambda, \Lambda = \mathbb{Z} + \mathbb{Z}_{\tau}$$ (with $$\mathrm{Im}(\tau) > 0$$)

> > > ○ Meaning: An elliptic curve over the complex numbers is analytically identical to a torus obtained by folding the complex plane by a lattice.

> > ○ $$E(\mathbb{C})[p^n] \simeq (\mathbb{Z}/p^n\mathbb{Z}) \oplus (\mathbb{Z}/p^n\mathbb{Z}) = (\mathbb{Z}/p^n\mathbb{Z})^2$$

> > > ○ In $$\mathbb{C}/\Lambda$$, $$n$$-torsion points are those that become $$0$$ after adding $$n$$ times, so $$E(\mathbb{C})[n] = (\mathbb{C}/\Lambda)[n] = (1/n)\Lambda/\Lambda$$

> > > ○ Since there are $$n$$-subdivisions in each of the two lattice-generator directions, $$E(\mathbb{C})[n] = (1/n)\Lambda/\Lambda \cong (\mathbb{Z}/n\mathbb{Z}) \oplus (\mathbb{Z}/n\mathbb{Z})$$

> > ○ $$\mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q})$$: The absolute Galois group of $$\mathbb{Q}$$ = the group of all field automorphisms of $$\overline{\mathbb{Q}}$$ fixing $$\mathbb{Q}$$

> > ○ $$\mathrm{GL}_2(\mathbb{Z}/\ell\mathbb{Z})$$: The group of invertible $$2\times 2$$ matrices over $$\mathbb{Z}/\ell\mathbb{Z}$$ (= $$\mathbb{F}_\ell$$), i.e. all $$2\times 2$$ matrices with nonzero determinant (multiplication is matrix multiplication)

> > ○ $$\mathrm{Gal}(\mathbb{Q}(E[p^n])/\mathbb{Q}) \hookrightarrow \mathrm{GL}_2(\mathbb{Z}/p^n\mathbb{Z})$$

> > > ○ $$E[n] = \{P \in E(\overline{\mathbb{Q}})\mid nP = O\}$$ (the $$\ell$$-torsion points)

> > > ○ $$\rho_{E,n} : G_{\mathbb{Q}} \to \mathrm{Aut}(E[n]) \simeq \mathrm{GL}_2(\mathbb{Z}/n\mathbb{Z})$$ (a 2-dimensional Galois representation)

> > > ○ $$\ker(\rho_{E,n}) = \mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q}(E[n]))$$

> > > ○ Meaning of $$\hookrightarrow$$: Recording the action on torsion as matrices

> > ○ A smooth plane cubic curve has exactly 9 inflection points over an algebraic closure (including one point at infinity (the identity))

> > > ○ Mathematical expression: $$\left\|E[3]\right\|$$ $$= 9, E[3] \simeq (\mathbb{Z}/3\mathbb{Z})^2$$

> > > ○ [Note](https://ocw.mit.edu/courses/18-783-elliptic-curves-spring-2021/59e0623c0d3454b39d8e07b493a0e9b0_MIT18_783S21_Slides5.pdf?utm_source=chatgpt.com): In $$y^2 = x^3 + Ax + B$$, the 8 inflection points are $$\{(x, y)\mid \psi_3(x) = 3x^4 + 6Ax^2 + 12Bx - A^2 = 0, y = \pm\sqrt{x^3 + Ax + B}\}$$

> ⑤ **Langlands / modularity**

> > ○ Definition of a modular form: $$f\left(\frac{az+b}{cz+d}\right) = (cz+d)^2 f(z)$$
> > (including a level condition)

> > > ○ where $$f(z) = \sum_{n=0}^{\infty} a_n e^{2\pi i n z}$$

> > > ○ where $$\begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \mathrm{SL}_2(\mathbb{Z})$$, $$c \equiv 0 \pmod{N}$$

> > ○ Langlands’ idea

> > > ○ Modular forms are special functions/forms arising from 2-dimensional Galois representations in $$\mathrm{GL}_2$$.

> > > ○ Langlands generalizes this to all of $$\mathrm{GL}_n(\mathcal{O}_F)$$ and treats it in the language of automorphic representations.

> > > ○ Using functions invariant under a subgroup, collect symmetric functions and extract the representation hidden inside.

> > > ○ The resulting automorphic representations on the $$\mathrm{GL}_n$$ side correspond to $$n$$-dimensional representations of the Galois group $$\mathrm{Gal}(\overline{F}/F)$$.

> > ○ Adeles (Adelic representation) are recommended even more than Langlands representations, as a tool bundling all finite primes and the infinite place at once.

⑶ **2-1.** Assume FLT has a counterexample.

> ① Assume there exists $$a^p + b^p = c^p$$ (with $$a, b, c \in \mathbb{Z}$$ and $$p$$ a prime $$\ge 3$$).

⑷ **2-2.** Then the Frey–Hellegouarch curve (proposed in 1985) $$E$$ arises.

> ① Frey curve $$E_{a,b,p}$$: $$y^2 = x(x - a^p)(x + b^p)$$ has distinct roots, hence is an elliptic curve.

> ② By a coordinate change (i.e. substituting $$x - (b^p - a^p)/2$$ for $$x$$ in the Frey curve), it can be written in Weierstrass form $$y^2 = x^3 + Ax + B$$
> (with $$A, B \in \mathbb{Q}$$).

> ③ Discriminant of the cubic = product of squared root differences
> $$= (a^p - 0)^2(0 - (-b^p))^2(a^p - (-b^p))^2 = (a^p b^p c^p)^2 \ne 0$$.

> ④ The elliptic curve discriminant $$\Delta(E) = 16(abc)^{2p}$$ means that (if it exists) the Frey curve has very special ramification/conductor properties
> (connected to **2-5**).

⑸ **2-3.** Extract the mod $$p$$ residual representation $$\bar{\rho} = \rho_{E,p}$$ from $$E$$.

> ① If $$E/\mathbb{Q}$$ is an elliptic curve and $$p$$ is prime, then the Galois action on $$E[p]$$ gives a mod $$p$$ representation
> $$\rho_{E,p} : \mathrm{Gal}(\overline{\mathbb{Q}}/\mathbb{Q}) \to \mathrm{GL}_2(\mathbb{F}_p)$$.

> ② Example: the case $$p = 3$$

> > ○ $$\rho : \mathrm{Gal}(\mathbb{Q}(E[3])/\mathbb{Q}) \hookrightarrow \mathrm{GL}_2(\mathbb{Z}/3\mathbb{Z}) \to \mathrm{PGL}_2(\mathbb{Z}/3\mathbb{Z}) \simeq S_4$$

> > ○ Langlands–Tunnell: When $$\mathrm{PGL}_2(\mathbb{F}_3) \simeq S_4$$ (solvable), it guarantees that (under certain conditions) a mod $$3$$ 2-dimensional Galois representation $$\bar{\rho}$$ is modular.

> > ○ Therefore, if $$\rho_{E,3}$$ of the elliptic curve $$E$$ is in this situation, it is connected to modularity at the mod $$3$$ level.

> ③ Because of the Weil pairing, $$\det \bar{\rho}$$ is fixed.

> > ○ Related to the fact that when points on the plane are moved by a linear transformation, the new area of the moved points scales by a factor of $$\det$$.

> > ○ The Weil pairing implies that the area scale $$\det \bar{\rho}$$ is constant.

⑹ **2-4.** **Modularity Assumption of Elliptic Curve**: If we assume $$E$$ is modular, then $$\bar{\rho}$$ must come from a weight $$2$$ newform of some level $$N$$
(= $$\bar{\rho}$$ equals the Galois representation attached to a modular form of that level $$N$$).

> ① This assumption is called the Shimura–Taniyama–Weil conjecture or the Breuil–Conrad–Diamond–Taylor modularity theory.

> ② Mathematical expression

> > ○ $$\{\text{Elliptic curves}/\mathbb{Q}\} \mapsto \{\text{modular form of weight }2,\ \text{some level}\}$$

> > ○ $$\mathrm{Gal}(\mathbb{Q}(E[p^n])/\mathbb{Q}) \hookrightarrow \mathrm{GL}_2(\mathbb{Z}/p^n\mathbb{Z})$$

> > ○ $$\mathrm{Frob}_\ell \mapsto \text{element with trace } a_\ell$$

⑺ **2-5.** **Level-lowering**: Because the Frey curve has special discriminant/reduction properties, $$\bar{\rho}$$ becomes in fact less twisted (unramified/weakly ramified) at many primes $$\ell$$ → repeatedly applying Ribet level lowering makes odd primes keep dropping out of the level.

> ① **Specialness**: A prime $$\ell \ne p$$ is unramified in $$\mathbb{Q}(\zeta_p)/\mathbb{Q}$$ (ramification occurs only at $$p$$) (finite primes).

> ② **Proof**

>> At some stage, by the “modularity assumption”, suppose $$\rho$$ comes from a weight $$2$$ newform of level

$$N = 2\cdot 3\cdot 5\cdot 7.$$ 

>> Now if $$\rho$$ is unramified at $$7$$, then $$7$$ can be removed from the level. That is, 

$$2\cdot 3\cdot 5\cdot 7 \Rightarrow 2\cdot 3\cdot 5.$$ 

>> Next, if it is also unramified at $$5$$, then $$5$$ can be removed from the level. That is,

$$2\cdot 3\cdot 5 \Rightarrow 2\cdot 3.$$ 

>> Next, if it is also unramified at $$3$$, then $$3$$ can be removed from the level. That is,

$$2\cdot 3 \Rightarrow 2.$$

⑻ **2-6.** In the end, there must be a weight $$2$$ newform of level $$2$$, but none exists, a contradiction.

> ① [**Proof**](https://wstein.org/books/modform/modform/weight_two.html)

<br>

```python
from math import prod
from sympy import factorint, divisors, totient, gcd

def chi_minus4(p:int)->int:
    # Kronecker (-4/p): for odd p, 1 if p ≡ 1 (mod 4), -1 if p ≡ 3 (mod 4); for p = 2, 0.
    if p == 2:
        return 0
    return 1 if p % 4 == 1 else -1

def chi_minus3(p:int)->int:
    # Kronecker (-3/p): 0 if p = 3; for other primes, it is +1 if p ≡ 1 (mod 3) and -1 if p ≡ 2 (mod 3) (for p = 2, -1).
    if p == 3:
        return 0
    return 1 if p % 3 == 1 else -1

def index_gamma0(N:int)->int:
    # μ = [SL2(Z): Γ0(N)] = N * Π_{p|N} (1 + 1/p)
    ps = factorint(N).keys()
    return int(N * prod([(1 + 1/p) for p in ps]))

def num_cusps(N:int)->int:
    # c = Σ_{d|N} φ(gcd(d, N/d))
    return int(sum(totient(gcd(d, N//d)) for d in divisors(N)))

def e2_count(N:int)->int:
    # elliptic points of order 2
    if N % 4 == 0:
        return 0
    ps = factorint(N).keys()
    return int(prod([1 + chi_minus4(p) for p in ps]))

def e3_count(N:int)->int:
    # elliptic points of order 3
    if N % 3 == 0:
        return 0
    ps = factorint(N).keys()
    return int(prod([1 + chi_minus3(p) for p in ps]))

def genus_X0(N:int)->int:
    mu = index_gamma0(N)
    c  = num_cusps(N)
    e2 = e2_count(N)
    e3 = e3_count(N)
    g = 1 + mu/12 - e2/4 - e3/3 - c/2
    return int(round(g))  # Must be an integer.

# Key check
for N in [1,2,3,4,5,6,7,8,9,10,11]:
    g = genus_X0(N)
    print(N, g)
```

<br>

> > ○ The dimension of the weight $$2$$ cusp form space $$S_2(\Gamma_0(N))$$ equals the genus of the modular curve $$X_0(N)$$ :
> > $$= 1 + \mu/12 - e_2/4 - e_3/3 - c/2 = 0$$

> > ○ For $$N = 2$$, $$\dim S_2(\Gamma_0(2)) = 0$$ (**∵** $$e_2 = 1,\ e_3 = 0,\ c = 2,\ \mu = 3$$)

> > ○ Of note, the first nonzero case is $$N = 11$$ with $$g = 1$$.

⑼ **2-7.** Since the assumption in **2-1** cannot hold, FLT holds (proof by contradiction).

<br>

<br>

## **4. Step 3.** Wiles’s proof

⑴ **Summary**: (In a certain range) elliptic curves are modular.

⑵ **Group-theoretic concepts**

> ① (On the representation side) A deformation ring $$R$$ that classifies certain Galois representations

> ② (On the modular-form side) A Hecke algebra $$T$$ containing modular forms satisfying the same conditions

> ③ Goal: $$R \simeq T$$ (if equal, it follows that “the representation comes from a modular form”)

> ④ In general, $$R$$ and $$T$$ are not identical: The degrees of freedom (variables) arising from global conditions (Galois side) and the relations (constraints) on the modular-form side must match perfectly; otherwise either “freedom” remains or constraints are insufficient, making it hard to pin down $$R = T$$.

⑶ **3-1.** For each $$n$$, attach an auxiliary prime set $$Q_n$$ to form $$R_{Q_n}$$ (Galois deformation ring) and $$T_{Q_n}$$ (Hecke algebra).

⑷ **3-2.** Adding auxiliary primes introduces additional local conditions describing how things must behave at those primes.

> ① That is, the raised-level problem is in fact the problem with extra conditions: those conditions serve to exactly control the leftover global degrees of freedom.

> ② Level $$Q_n$$: (base conditions) + (conditions at auxiliary primes $$Q_n$$)

> ③ Level $$Q_{n+1}$$: (base conditions) + (conditions at auxiliary primes $$Q_n$$) + (additional conditions at a new prime)

⑸ **3-3.** Since $$Q_{n+1} \supset Q_n$$, there is a downward map that “forgets” conditions.

⑹ **3-4.** Arrange compatibility so that these downward maps commute between the Galois side and the modular-form side.

> ① Compatibility on the Galois representation side: solution set satisfying more conditions → projection to a solution set where fewer conditions are required.

> ② Compatibility on the modular-form/Hecke algebra side: Hecke eigenvalues at higher level must descend and agree with the eigenvalues seen at $$Q_n$$ without contradiction.

<br>

<div style="max-width: 720px; margin: 14px 0; font-family: 'Times New Roman', serif;">
<div style="text-align: center; margin-bottom: 6px;">(push down the Galois representation side)</div>
<table style="margin: 0 auto; border-collapse: collapse; border-spacing: 0; border: none;" data-ke-align="alignLeft">
<tbody>
<tr>
<td style="border: none; padding: 6px 14px; white-space: nowrap; text-align: center; font-size: 18px;">R<sub>Q<sub>n+1</sub></sub></td>
<td style="border: none; padding: 6px 10px; font-size: 18px;">&rarr;</td>
<td style="border: none; padding: 6px 14px; white-space: nowrap; text-align: center; font-size: 18px;">R<sub>Q<sub>n</sub></sub></td>
</tr>
<tr>
<td style="border: none; padding: 2px 14px; text-align: center; vertical-align: top;">
<div style="font-size: 18px; line-height: 18px;">&darr;</div>
<div style="font-size: 12px; line-height: 1.25; margin-top: 2px;">(at each level) R ≃ T</div>
</td>
<td style="border: none;">&nbsp;</td>
<td style="border: none; padding: 2px 14px; text-align: center; vertical-align: top;">
<div style="font-size: 18px; line-height: 18px;">&darr;</div>
<div style="font-size: 12px; line-height: 1.25; margin-top: 2px;">(at each level) R ≃ T</div>
</td>
</tr>
<tr>
<td style="border: none; padding: 6px 14px; white-space: nowrap; text-align: center; font-size: 18px;">T<sub>Q<sub>n+1</sub></sub></td>
<td style="border: none; padding: 6px 10px; font-size: 18px;">&rarr;</td>
<td style="border: none; padding: 6px 14px; white-space: nowrap; text-align: center; font-size: 18px;">T<sub>Q<sub>n</sub></sub></td>
</tr>
</tbody>
</table>
<div style="text-align: center; margin-top: 6px;">(push down the modular forms / Hecke algebra side)</div>
</div>

<br>

⑺ **3-5.** Infinite descent: Thanks to this compatibility, take inverse limits/patching of $$\{R_{Q_n}\}$$ and $$\{T_{Q_n}\}$$ to build an infinite-level equality like $$R_\infty \simeq T_\infty$$

> ① In practice, it’s not just rings—we also patch the modules, which makes a meaningful comparison possible.

⑻ **3-6.** Finally, specialize (send to $$0$$) the variables/degrees of freedom introduced by auxiliary primes (= remove auxiliary-prime conditions) in $$R_\infty, T_\infty$$ to obtain the original target equality $$R \simeq T$$ at minimal level.

<br>

<div style="max-width: 720px; margin: 14px 0; font-family: 'Times New Roman', serif;">
<table style="margin: 0 auto; border-collapse: collapse; border-spacing: 0; border: none;" data-ke-align="alignLeft">
<tbody>
<tr>
<td style="border: none; padding: 6px 14px; white-space: nowrap; font-size: 18px; text-align: center;">R<sub>&infin;</sub> := lim&larr; R<sub>Q<sub>n</sub></sub></td>
<td style="border: none; padding: 6px 10px; font-size: 18px; text-align: center;">≃</td>
<td style="border: none; padding: 6px 14px; white-space: nowrap; font-size: 18px; text-align: center;">T<sub>&infin;</sub> := lim&larr; T<sub>Q<sub>n</sub></sub></td>
</tr>
<tr>
<td style="border: none; padding: 2px 14px; text-align: center; vertical-align: top;">
<div style="font-size: 18px; line-height: 18px;">&darr;</div>
<div style="font-size: 12px; line-height: 1.25; margin-top: 2px;">(patched isomorphism)</div>
</td>
<td style="border: none;">&nbsp;</td>
<td style="border: none; padding: 2px 14px; text-align: center; vertical-align: top;">
<div style="font-size: 18px; line-height: 18px;">&darr;</div>
<div style="font-size: 12px; line-height: 1.25; margin-top: 2px;">(patched isomorphism)</div>
</td>
</tr>
</tbody>
</table>
<div style="text-align: center; margin-top: 10px;">
<div style="font-size: 12px; line-height: 1.25; margin-bottom: 2px;">(specialization: removing the auxiliary primes)</div>
<div style="font-size: 18px; line-height: 18px;">&darr;</div>
<div style="font-size: 18px; margin-top: 4px;">R (or T) at the original level</div>
</div>
</div>

<br>

⑼ **Application 1.** [ECDSA](https://jb243.github.io/pages/878): It is based on the fact that, by leveraging the group operation properties of elliptic curves defined over a finite field (modulo arithmetic), one can easily derive a public key, whereas inferring the corresponding private key in reverse is computationally intractable.

<br>

<br>

## **5. Subsequent research**

⑴ Khare–Wintenberger theorem (Serre’s modularity conjecture)

> ① **Summary :** For $$\mathrm{GL}_2/\mathbb{Q}$$, every odd irreducible mod $$\ell$$ representation comes from a modular form.

> > ○ Wiles: Proved modularity for $$\ell$$-adic 2-dimensional representations coming from elliptic curves (weight $$2$$, certain local conditions, semistable).

> > ○ Serre/KW: Proved modularity for all odd irreducible mod $$\ell$$ 2-dimensional representations.

> ② If $$\det \rho$$ is odd (i.e., when inserting complex conjugation $$c^*$$ into $$\rho$$, $$\det(\rho(c)) = -1$$), then $$\rho$$ is irreducible.

> > ○ Irreducible = not decomposable into a sum of two 1-dimensional representations = no invariant 1-dimensional subspace

> ③ Such $$\rho$$ is modular: more precisely, it is the reduction mod $$\ell$$ of the Galois representation arising from a Hecke eigenform.

> ④ Proof: Wiles’s modularity lifting + level changing

> ⑤ For $$\mathrm{GL}_n$$ ($$n > 2$$) or for a general number field $$F$$ instead of $$\mathbb{Q}$$, this proof strategy does not seem to remain effective.

⑵ [Lean](https://imperialcollegelondon.github.io/FLT/blueprint.pdf) **:**
An open-source project at Imperial College London that formalizes a modern variant of FLT (including Taylor–Wiles-type techniques) using the Lean theorem prover.

<br>

---

_Created: 2023.08.26 00:02_

_Updated: 2026.01.04 00:22_
