## **Chapter 14-9. Kolmogorov-Smirnov Test**

Recommended Post: „ÄêStatistics„Äë Chapter 14. [Statistical Test](https://jb243.github.io/pages/1631)

---

**1.** [General Kolmogorov-Smirnov Test](#1-general-kolmogorov-smirnov-test)

**2.** [Parametric Kolmogorov-Smirnov Test](#2-parametric-kolmogorov-smirnov-test)

**3.** [Cram√©r‚Äìvon Mises Test](#3-cram√©r‚Äìvon-mises-test)

**4.** [Kolmogorov-Smirnov Two-Sample Test](#4-kolmogorov-smirnov-two-sample-test)

---

<br>

## **1\. General Kolmogorov-Smirnov Test**

‚ë¥ Define the sample (i.e., empirical) distribution function as follows: Step function form

<br>

<img width="204" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 04 03" src="https://github.com/user-attachments/assets/127eccab-122d-485d-a2ca-1d28e88f2564" />

<br>

‚ëµ Reject the null hypothesis when the following value is large for the two-sided Kolmogorov-Smirnov test

<br>

<img width="205" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 04 24" src="https://github.com/user-attachments/assets/3107d9b5-1eb3-4c28-bdb9-2d31a271eea9" />

<br>

<img width="358" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-28 ·Ñã·Ö©·Ñå·Ö•·Ü´ 12 44 02" src="https://github.com/user-attachments/assets/e7d2820c-be03-4cfb-ae2c-86c007c2148d" />

**Figure 1.** Kolmogorov-Smirnov test statistic

<br>

‚ë∂ The null distribution of D does not depend on F<sub>0</sub> (assumed to be continuous), and this is summarized in a table for various sample sizes n

‚ë∑ **Theory**: Under the null hypothesis, ‚àön D asymptotically (n ‚Üí ‚àû) follows the distribution of the maximum absolute value of a Brownian bridge

‚ë∏ **Simulation**: The p-value can be computed through Monte Carlo simulation

> ‚ë† In practice, since the distribution of D under the null distribution does not depend on F<sub>0</sub>, this only needs to be performed once for each sample size

> ‚ë° For example, F<sub>0</sub> can be set to Unif(0, 1)

<br>

<br>

## **2\. Parametric Kolmogorov-Smirnov Test**

‚ë¥ The test statistic is defined as follows

<br>

<img width="304" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 05 13" src="https://github.com/user-attachments/assets/647fbe73-3712-4c08-a60c-8151f540ba34" />

<br>

‚ëµ The p-value is usually estimated through parametric bootstrap: Here, F hat and Œ∏ hat are recalculated for each bootstrap sample

‚ë∂ When ùí¢ is a family of normal distributions: That is, when testing whether a given distribution follows a normal distribution (**Normality Test**)

<br>

<img width="263" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 05 36" src="https://github.com/user-attachments/assets/84fe675e-e9f3-4611-b2b3-b22208ace593" />

<br>

> ‚ë† This test is often called the **Lilliefors normality test**

> ‚ë° The above test statistic can be adjusted for all distributions within the family, and this is performed through Monte Carlo simulation

> ‚ë¢ Therefore, the null distribution of this test statistic is summarized in a table

> ‚ë£ R code: `ks.test(dat, "pnorm", mean=mu, sd=sigma)`

‚ë∑ The same logic applies to distributions of other **location-scale families**

<br>

<img width="302" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 06 15" src="https://github.com/user-attachments/assets/83863e89-e164-42ff-9136-43a74ca5157f" />

<br>

> ‚ë† Here, G<sub>0</sub> is a given distribution defined on the real set ‚Ñù

<br>

<br>

## 3. Cram√©r‚Äìvon Mises Test

‚ë¥ A variation of the Kolmogorov-Smirnov test  

‚ëµ The Cram√©r‚Äìvon Mises test rejects the null hypothesis when the following value is large:  

<br>

<img width="304" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 22 15" src="https://github.com/user-attachments/assets/69588826-35bd-4c9f-99a1-464f249662b0" />

<br>

> ‚ë† f<sub>0</sub>(x) = dF<sub>0</sub>(x)/dx is the probability density function (PDF) under the null hypothesis.

‚ë∂ This has a simple closed-form expression that does not require integration:  

<br>

<img width="342" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-23 ·Ñã·Ö©·Ñí·ÖÆ 7 23 03" src="https://github.com/user-attachments/assets/12bce11b-33a7-46f1-946b-2692a13aa8e6" />

<br>

> ‚ë† Here, X<sub>(1)</sub> ‚â§ ‚ãØ ‚â§ X<sub>(n)</sub> is the ordered sample, known as order statistics.

> ‚ë° The null distribution of D does not depend on F<sub>0</sub> and has been tabulated.

> ‚ë¢ The asymptotic null distribution is also known but is complicated.

> ‚ë£ Therefore, Monte Carlo simulations can be used to compute the p-value.

<br>

<br>

## 4. Kolmogorov-Smirnov Two-Sample Test

‚ë¥ The (one-sided) Kolmogorov-Smirnov test rejects for large values of 

<br>

<img width="242" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-27 ·Ñã·Ö©·Ñå·Ö•·Ü´ 12 30 27" src="https://github.com/user-attachments/assets/657533c6-3a31-44ea-b1d8-41d919b9c623" />

<br>

‚ëµ **Theory**

> ‚ë† The distribution of D<sub>m,n</sub><sup>+</sup> can be computed exactly and efficiently using some recursion formulas.

> ‚ë° In the large-sample limit 

<br>

<img width="503" alt="·Ñâ·Ö≥·Ñè·Ö≥·ÑÖ·Öµ·Ü´·Ñâ·Ö£·Ü∫ 2025-03-27 ·Ñã·Ö©·Ñå·Ö•·Ü´ 12 31 50" src="https://github.com/user-attachments/assets/74832fa7-94da-452d-a3d0-b17371756fb8" />

<br>

> ‚ë¢ This happens to be the same limiting distribution as in the one-sample case with sample size ‚é£ mn / (m+n) ‚é¶.

<br>

---

_Input: 2025.03.23 18:32_
