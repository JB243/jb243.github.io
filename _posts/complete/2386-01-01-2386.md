## **Gromov-Wasserstein distance** 

(Monge-Kantorovichâ€“Rubinstein metric, Earth Mover's Distance, EMD)

Recommended Post: ã€Statisticsã€‘ Chapter 5-2. [Distance Functions and Similarity](https://jb243.github.io/pages/879)

---

**1.** [Overview](#1-overview)

**2.** [Kontorovich's problem](#2-kontorovich-s-problem)

**3.** [optimal transport plan](#3-optimal-transport-plan)

**4.** [Wasserstein distance](#4-wasserstein-distance)

**5.** [Applications](#5-applications)

---

<br>

## **1. Overview**

 â‘´ [Joint Probability Distribution](https://jb243.github.io/pages/1624) (Joint Probability Mass Function, Joint Probability Distribution; Coupling)

> â‘  Discrete Random Variables: For X =ï½›x<sub>1</sub>, Â·Â·Â·, x<sub>m</sub>ï½, Y =ï½›y<sub>1</sub>, Â·Â·Â·, y<sub>n</sub>ï½, the function Ï€(x<sub>i</sub>, y<sub>j</sub>) = Ï€(X = x<sub>i</sub>, Y = y<sub>j</sub>)

> â‘¡ Continuous Random Variables: For âˆ‚<sup>2</sup>F(x, y) / âˆ‚x âˆ‚y = Ï€(x, y), the function Ï€(x, y)

> â‘¢ **Property 1.** Ï€(x, y) â‰¥ 0

> â‘£ **Property 2.** âˆ‘âˆ‘ Ï€(x, y) = 1

â‘µ [Marginal Probability Distribution](https://jb243.github.io/pages/1624)

> â‘  Definition: Transforming the joint probability distribution into a distribution of either random variable X or Y

> â‘¡ Marginal Probability Distribution for Discrete Random Variables

<br>

![image](https://github.com/user-attachments/assets/91142b7d-6e3c-4a7b-82ec-0dbde5e497a3)

<br>

> â‘¢ Marginal Probability Distribution for Continuous Random Variables

<br>

![image](https://github.com/user-attachments/assets/0e0e280e-37e8-46f0-8883-81c0411f291e)

<br>

<br>

## 2. **Kontorovich's problem**

â‘´ **Definition**: Given the probability distribution of X (i.e., Ï€X), the probability distribution of Y (i.e., Ï€Y), and the cost function (i.e., c(x, y)), the problem is to find the joint probability distribution Ï€ that minimizes the expected cost.

> â‘  X is called the source, Y the target.

<br>

<img width="453" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-04-03 á„‹á…©á„Œá…¥á†« 8 52 17" src="https://github.com/user-attachments/assets/4a637ff9-491f-48b7-8627-cf71bb987e34" />

**Figure 1.** Kontorovich's problem

<br>

â‘µ **Assumption**: There must exist a functional relationship between X and Y ( **âˆµ** for Ï€(x, y) to have practical significance)

â‘¶ Instead of Ï€X, conditions like {x1, x2, Â·Â·Â·, xn} may be given (but Ï€X=x1 = Ï€X=x2 = Â·Â·Â· = Ï€X=xn)

â‘· Example: Problem of pairing {x1, x2, Â·Â·Â·, xn} and {y1, y2, Â·Â·Â·, yn} in a close manner.

<br>

![image](https://github.com/user-attachments/assets/c6171700-0f0b-4bbe-a023-075ebb7a99c3)

**Figure 2.** Example of Kontorovich's problem

<br>

â‘¸ Kantorovich-Rubinstein duality (KD) problem is merely a modification of the above definition.

<br>

<br>

## 3. Optimal Transport Plan

â‘´ Definition: The solution to Kontorovich's problem, forming a convex set

<br>

![image](https://github.com/user-attachments/assets/d63cbfd5-cb48-4873-a4d0-0ec3a02c5499)

<br>

â‘µ Existence of Solution: Always exists under **mild conditions** like lower semicontinuous

â‘¶ Methods to find the solution

> â‘  North West Corner Method

> â‘¡ Vogel's Approximation Method

> â‘¢ Least-Cost Method

> â‘£ Various Numerical Analysis Techniques

â‘· **Example 1.** Deciding how to distribute resources when demand and supply are fixed

<br>

![image](https://github.com/user-attachments/assets/d43bae9a-7d03-434c-ae89-d7ff896ce405)

**Figure 3.** Optimal Transport Plan in Economics

<br>

â‘¸ **Example 2.** Differences in Optimal Transport Plans for Continuous and Discrete Variables

<br>

![image](https://github.com/user-attachments/assets/68ae69b4-4873-4c5a-9bd9-ecde13076c5b)

**Figure 4.** Differences in Optimal Transport Plans for Continuous and Discrete Variables

<br>

<br>

## **4. Wasserstein Distance**

â‘´ The expected value of the cost function in a special Kontorovich's problem scenario where the cost function c(x, y) is the Euclidean distance d(x, y)

> â‘  Resulting in the expected value of a distance with the same unit as the distance

<br>

![image](https://github.com/user-attachments/assets/5ee7d53c-a4de-4dc3-be71-a8b80550d7fc)

<br>

> â‘¡ Measuring how much the shape of a pile of sand changes when moved from one place to another, which is exactly the Wasserstein distance

<br>

![image](https://github.com/user-attachments/assets/dc9c8483-729c-4744-b17a-a563721e0f6b)

**Figure 5.** Process of Moving a Pile of Sand

<br>

â‘µ Can also measure the distance between two sample groups in different metric spaces

> â‘  Example: When X is a set of 2D data points, and Y is a set of 3D data points

â‘¶ Example: WGAN (Wasserstein Generative Adversarial Neural Network)

<br>

<br>

## **5. Applications**

â‘´ **Application 1.** p-th order Wasserstein distance: Using the p-th moment (p-th moment, p â‰¥ 1) and then raising it to the power of 1/p to produce the expected value of a distance with the same unit as Euclidean distance.

<br>

![image](https://github.com/user-attachments/assets/b54bed92-d42e-4572-a155-4aa3af9914b9)

<br>

â‘µ **Application 2.** Partial Wasserstein Distance: Calculating the Wasserstein distance using only part of X and Y

> â‘  **Example 1.** Generate X = {x<sub>1</sub>, x<sub>2</sub>, Â·Â·Â·, x<sub>n</sub>}, Y = {y<sub>1</sub>, y<sub>2</sub>, Â·Â·Â·, y<sub>n</sub>} as an example, and calculate the 2D-partial Wasserstein distance ([ref](https://pythonot.github.io/auto_examples/unbalanced-partial/plot_partial_wass_and_gromov.html))

>> â—‹ [File Link](https://blog.kakaocdn.net/dn/A6obn/btszHH0vCwr/WZCSjelxISRvLuqjwV5hOK/plot_partial_wass_and_gromov.ipynb?attach=1&knm=tfile.ipynb)

â‘¶ **Application 3.** Entropic Wasserstein Distance: Incorporating product measure (i.e., X âŠ— Y), [Relative Entropy](https://jb243.github.io/pages/2145)(Kullback-Leibler divergence)

<br>

![image](https://github.com/user-attachments/assets/1420dceb-b52b-4cc3-a443-d0bb81ec164c)

<br>

> â‘  Entropic Wasserstein distance is also known as Sinkhorn divergence

> â‘¡ **Advantage 1.** Makes Kontorovich's problem differentiable, allowing the use of gradient-based optimization methods

> â‘¢ **Advantage 2.** Introduces ğ to provide flexibility in adjusting the optimal transport plan

â‘· **Application 4.** [Robust Wasserstein Distance](https://arxiv.org/pdf/2301.06297.pdf): Using cÎ»(x, y) = min { c(x, y), 2Î» } instead of c(x, y)

â‘¸ **Application 5.** Sinkhorn-Knopp Algorithm: By normalizing the cost function, it enables ultra-fast optimization in optimal transport.

â‘¹ **Application 6.** collective OT (COT): A technique that simultaneously optimizes optimal transport across multiple pairs. (e.g., [COMMOT](https://www.nature.com/articles/s41592-022-01728-4)) 

<br>

<img width="558" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-04-03 á„‹á…©á„Œá…¥á†« 11 29 03" src="https://github.com/user-attachments/assets/9e525ea3-dc75-4aca-aee8-89e98318c470" />

**Figure 6.** Diagram of COMMOT

<br>

<img width="493" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-04-03 á„‹á…©á„Œá…¥á†« 11 29 18" src="https://github.com/user-attachments/assets/38705c34-df08-4534-8cb7-761f7040873c" />

<br>

â‘º Papers related to optimal transport theorem

> â‘  WaddingOT

> â‘¡ CellOT 

> â‘¢ SCOT (Demetci et al. 2022)

> â‘£ SCOOTR (Demetci et al. 2022)

> â‘¤ [Perturb-OT](https://arxiv.org/abs/2405.00838) 

> â‘¥ [COMMOT](https://www.nature.com/articles/s41592-022-01728-4) 

> â‘¦ [SCOTIA](https://github.com/Caochris/SCOTIA) 

<br>

---

_Input: Nov 4, 2023, 02:09_
