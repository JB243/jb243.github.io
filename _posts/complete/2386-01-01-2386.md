## **Gromov-Wasserstein distance** (Kantorovichâ€“Rubinstein metric, Earth Mover's Distance, EMD)

Recommended Post **:** ã€Statisticsã€‘ Chapter 5-2. [Distance Functions and Similarity](https://jb243.github.io/pages/879)

---

**1.** [Overview](#1-overview)

**2.** [Code](#2-code)

---

<br>

## **1. Overview**

 â‘´ [Joint Probability Distribution](https://jb243.github.io/pages/1624#footnote_link_67_54) (Joint Probability Mass Function, Joint Probability Distribution; Coupling)

> â‘  Discrete Random Variables **:** For X =ï½›x<sub>1</sub>, Â·Â·Â·, x<sub>m</sub>ï½, Y =ï½›y<sub>1</sub>, Â·Â·Â·, y<sub>n</sub>ï½, the function Ï€(x<sub>i</sub>, y<sub>j</sub>) = Ï€(X = x<sub>i</sub>, Y = y<sub>j</sub>)

> â‘¡ Continuous Random Variables **:** For âˆ‚<sup>2</sup>F(x, y) / âˆ‚x âˆ‚y = Ï€(x, y), the function Ï€(x, y)

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/1f9f20fa-5a69-4690-bbd1-876641917e52)

<br>

> â‘¢ **Property 1.** Ï€(x, y) â‰¥ 0

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/a592d8a3-dea8-484b-9f11-87090edcebca)

<br>

> â‘£ **Property 2.** âˆ‘âˆ‘ Ï€(x, y) = 1

 â‘µ [Marginal Probability Distribution](https://jb243.github.io/pages/1624#footnote_link_67_54)

> â‘  Definition **:** Transforming the joint probability distribution into a distribution of either random variable X or Y

> â‘¡ Marginal Probability Distribution for Discrete Random Variables

> â‘¢ Marginal Probability Distribution for Continuous Random Variables

 â‘¶ **Kontorovich's problem**

> â‘  **Definition** **:** Given the probability distribution of X (i.e., Ï€X), the probability distribution of Y (i.e., Ï€Y), and the cost function (i.e., c(x, y)), the problem is to find the joint probability distribution Ï€ that minimizes the expected cost.

>> â—‹ X is called the source, Y the target.

> â‘¡ **Assumption** **:** There must exist a functional relationship between X and Y ( **âˆµ** for Ï€(x, y) to have practical significance)

> â‘¢ Instead of Ï€X, conditions like {x1, x2, Â·Â·Â·, xn} may be given (but Ï€X=x1 = Ï€X=x2 = Â·Â·Â· = Ï€X=xn)

> â‘£ Example **:** Problem of pairing {x1, x2, Â·Â·Â·, xn} and {y1, y2, Â·Â·Â·, yn} in a close manner.

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/df482dfb-1329-4e42-9c08-ac995394bf2d)

 **Figure. 1.** Example of Kontorovich's problem

<br>

> â‘¤ Kantorovich-Rubinstein duality (KD) problem is merely a modification of the above definition.

 â‘· Optimal Transport Plan

> â‘  Definition **:** The solution to Kontorovich's problem, forming a convex set

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/cd98c83f-2aae-4852-80f6-0f67c5af6ec3)

<br>

> â‘¡ Existence of Solution **:** Always exists under **mild conditions** like lower semicontinuous

> â‘¢ Methods to find the solution

>> â—‹ North West Corner Method

>> â—‹ Vogel's Approximation Method

>> â—‹ Least-Cost Method

>> â—‹ Various Numerical Analysis Techniques

> â‘£ **Example 1.** Deciding how to distribute resources when demand and supply are fixed

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/93eb9a92-e298-4b6c-afae-91ea3b74d7d2)

 **Figure. 2.** Optimal Transport Plan in Economics

<br>

> â‘¤ **Example 2.** Differences in Optimal Transport Plans for Continuous and Discrete Variables

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/4ad35d19-5802-46b5-a9ec-21e301a75676)

 **Figure. 3.** Differences in Optimal Transport Plans for Continuous and Discrete Variables

<br>

 â‘¸ Wasserstein Distance

> â‘  The expected value of the cost function in a special Kontorovich's problem scenario where the cost function c(x, y) is the Euclidean distance d(x, y)

>> â—‹ Resulting in the expected value of a distance with the same unit as the distance

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/f486beff-ab41-46c3-956e-276551a8858a)

<br>

>> â—‹ Measuring how much the shape of a pile of sand changes when moved from one place to another, which is exactly the Wasserstein distance

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/aa318aca-896d-43e9-85a4-3ec59f443068)

 **Figure. 4.** Process of Moving a Pile of Sand

<br>

> â‘¡ Can also measure the distance between two sample groups in different metric spaces

>> â—‹ Example **:** When X is a set of 2D data points, and Y is a set of 3D data points

> â‘¢ Example **:** WGAN (Wasserstein Generative Adversarial Neural Network)

 â‘¹ Applications

> â‘  **Application 1.** p-th order Wasserstein distance **:** Using the p-th moment (p-th moment, p â‰¥ 1) and then raising it to the power of 1/p to produce the expected value of a distance with the same unit as Euclidean distance.

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/c2c0978b-7297-440d-a995-4056d23c2e31)

<br>

> â‘¡ **Application 2.** Partial Wasserstein Distance

 **:** Calculating the Wasserstein distance using only part of X and Y

> â‘¢ **Application 3.** Entropic Wasserstein Distance **:** Incorporating product measure (i.e., X âŠ— Y), [Relative Entropy](https://jb243.github.io/pages/2145)(Kullback-Leibler divergence)

<br>

![image](https://github.com/JB243/jb243.github.io/assets/55747737/8ccc892b-376c-46fc-bf98-dbb3443eb8f5)

<br>

>> â—‹ Entropic Wasserstein distance is also known as Sinkhorn divergence

>> **â—‹ Advantage 1.** Makes Kontorovich's problem differentiable, allowing the use of gradient-based optimization methods

>> â—‹ **Advantage 2.** Introduces ğ to provide flexibility in adjusting the optimal transport plan

> â‘£ **Application 4.** [Robust Wasserstein Distance](https://arxiv.org/pdf/2301.06297.pdf) **:** Using cÎ»(x, y) = min { c(x, y), 2Î» } instead of c(x, y)

<br>

<br>

## **2. Code**

 â‘´ **Example 1.** Generate X = {x1, x2, Â·Â·Â·, xn}, Y = {y1, y2, Â·Â·Â·, yn} as an example, and calculate the 2D-partial Wasserstein distance
([ref](https://pythonot.github.io/auto_examples/unbalanced-partial/plot_partial_wass_and_gromov.html))

> [File Link](https://blog.kakaocdn.net/dn/A6obn/btszHH0vCwr/WZCSjelxISRvLuqjwV5hOK/plot_partial_wass_and_gromov.ipynb?attach=1&knm=tfile.ipynb)

<br>

---

_Input **:** Nov 4, 2023, 02:09_
