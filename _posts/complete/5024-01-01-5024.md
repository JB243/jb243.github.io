## **如何远程连接到 Windows 服务器**

推荐文章**：** 【操作系统】【操作系统目录】(https://jb243.github.io/pages/1771)

---

**1\.** [**步骤1.**（准备）打开端口](#1-step-1-preparation-opening-ports)

**2\.** [**步骤2.**（准备）关闭端口方法](#2-step-2-preparation-close-port-method)

**3\.** [**步骤 3.**（中间过程）VPN 配置](#3-step-3-intermediate-process-vpn-configuration)

**4\.** [**步骤 4.**（必需的应用程序安装）RDP（远程桌面协议）](#4-step-4-required-application-installation-rdc-remote-desktop-protocol)

**5\.** [**步骤 5.**（必需的应用程序安装）SSH（安全外壳）](#5-step-5-required-application-installation-ssh-secure-shell)

**6\.** [**步骤 6.**（其他应用程序安装）WOL（LAN 唤醒）](#6-step-6-other-application-installation-wol-wake-on-lan)

**7\.** [**步骤 7.** 服务器计算机管理](#7-step-7-server-computer-management)

---

<br>

## **1\.步骤1.**（准备）打开端口

⑴ 港口

> ① 下级节点发送请求的通道

> ② [入站流量](https://fishpoint.tistory.com/6595#:~:text=and%20outbound%20traffic-) **:** 进入服务器的流量

>> ○ 示例：在客户端将文件上传到服务器的情况下，从服务器的角度来看存在入站流量

>> ○ 入站流量大部分被路由器阻止，因此需要打开端口

>> ○ 打开端口时，源是客户端，目的地是服务器（路由器），最终在服务器端打开

> ③ [出站流量](https://fishpoint.tistory.com/6595#:~:text=%EA%B7%B8%EB%A6%BC%20%EB%8F%99%EC%98%81%EC%83%81%20%EC%97%85%EB%A1%9C%EB%93%9C)- **:** 从服务器出站的流量

>> ○ 示例：在服务器向客户端发送文件的情况下，从服务器的角度来看存在出站流量

>> ○ 出站流量几乎始终在路由器上打开

>> ○ 例如，当客户端从服务器下载文件时，这是一个典型的出站流量场景

> ④ 服务器和路由器都有端口号

⑵ 端口开放方式

> ① 当从一个节点向另一个节点发送流量时，接收节点需要打开其端口，因为它成为入站流量

⑶ **步骤1.** 端口转发

> ① 更改每台服务器的路由器端口号 **:** 有时称为端口开放

>> ○ 示例：如果用户在端口 1234 上连接，而 Linux 计算机只允许在端口 22（默认端口）上连接，则可以更改端口号以允许连接

>> ○ 有些路由器允许设置所有 IP 地址，有些则不允许

⑷ **步骤2.** 打开机房端口

> ① 出于安全考虑，机房内关闭了某些预定义端口（例如RDP端口、3389）

> ② 这种情况请咨询机房开放所需端口

> ③ 如果打开了不同的端口，[使用regedit更改服务器计算机的远程访问端口号](https://apophis0.tistory.com/49)

> ④ 如果改为打开不同的端口，则需要在**步骤1**中打开该端口

<br>

<br>

## **2\.步骤2.**（准备）关闭端口方法

⑴ 闭口法

> ① 中间设置中继服务器后，只接收用户的出站流量，不需要开放端口

⑵ **示例1.** TeamViewer

> ① 基于登录的远程访问程序

> ② 工作原理与VPN类似，但不使用VPN

> ③ 可能使用与 RDP 不同的协议

> ④ 但TeamViewer采用6位密码，安全性较差，可以通过暴力破解的方式进行破解

⑶ **示例 2.** Google Chrome 远程桌面

⑷ **示例3.** 缩放

⑸ **示例 4.** Google Meet

⑹ **示例 5.** 二重奏⑺ **示例 6.** AnyDesk

<br>

<br>

## **3\.步骤 3.**（中间过程）VPN 配置

⑴ VPN（虚拟专用网络）

> ① 建立安全的专用网络，允许特定授权用户进入网络

> ② VPN可能需要开关，网速可能会略有下降

> ③ 即使有VPN，一般也需要开放端口

> ④ 使用 VPN 可以绕过服务器对封锁 IP 地址的连接封锁

> ⑤ 示例：Mareel VPN

⑵ **示例1.** WireGuard

⑶ **示例 2.** Tailscale **:** WireGuard 协议之上的 UI 覆盖

> ① 概述

>> ○ **优点1.** 免费账户最多可注册20台设备

>> ○ **优点2.** 安全隐患低

> ② **步骤1.** 在服务器上安装Tailscale并登录

> ③ **步骤2.** 在个人电脑上安装Tailscale并使用同一帐户登录

> ④ **步骤3.** 进入Tailscale网站并登录查看各设备的VPN内网IP

> ⑤ **步骤4.** 将我的电脑连接到服务器

>> ○ **案例1.** 服务器RDP连接

>> ○ **案例 2.** 来自我的计算机的 SSH 连接

⑷ **示例 3.** [wg-easy](https://github.com/WeeJeWel/wg-easy) **:** 包含 UI 的开源项目

⑸ **示例4.** 通过Windows提供的VPN实现

> ① 可以使用IPTIME来完成

> ② 服务器计算机应有Windows密码锁

<br>

<br>

## **4。步骤 4.**（所需的应用程序安装）RDP（远程桌面协议）

⑴ 概述

> ① 支持GUI远程连接

> ② 并发连接数限制

> ③ RDP 在 Windows 家庭版上不工作

⑵ **步骤 1.** 安装 RDP（Linux 专用，必需）

> ① RDP服务器和客户端均为Windows内置功能，无需单独安装，配置简单

> ② 由于RDP是微软协议，因此需要在Linux上分别安装服务器和客户端

⑶ **步骤2.** 连接客户端和Windows Server（必填）

> ① 由于 RDP 基于 Windows，因此原生支持 Windows 到 Windows 服务器连接

> ② Mac 到 Windows 服务器的连接是通过 Microsoft 远程桌面完成的

> ③ RDP默认端口号为3389

<br>

<br>

## **5\.步骤 5.**（所需的应用程序安装）SSH（安全外壳）

⑴ 概述

> ① 基于终端的远程连接

⑵ **步骤1.**安装[Windows SSH服务器](https://techexpert.tips/ko/windows-ko/windows-ssh-서버-설치/) **:** 对比步骤2和步骤3进行选择

> ① 许多 Linux 操作系统（例如 Ubuntu）都预装和配置了 SSH 服务器和客户端

> ② 与Ubuntu不同，在Windows上安装SSH很困难

> ③ SSH服务器和SSH客户端需要分开考虑

⑶ **步骤2.** 安装WSL (Windows Subsystem for Linux) **:** 对比步骤1和步骤3进行选择

> ① WSL 就像 Windows 中的虚拟化，与双操作系统设置不同

> ② WSL有利于Python开发中管理环境变量和路径

> ③ [安装教程](https://kimsungjin.tistory.com/590)

⑷ **步骤3.** 双操作系统安装**：** 对比步骤1和步骤2进行选择

⑸ **步骤4.** 检查远程服务器上的SSH是否打开

⑹ **步骤5.** 在个人电脑（客户端）上安装VScode Remote-SSH
([链接1](https://blog.naver.com/PostView.naver?blogId=ys_blog&logNo=222504541128&parentCategoryNo=&categoryNo=38&viewDate=&isShowPopularPosts=true&from=search),
[链接 2](https://technote.kr/320#subject2)) **:** 必填

> ① Remote-SSH是微软官方软件，性能有保证

> ② 输入服务器地址并连接，即可在服务器资源和开发环境完好的情况下在个人电脑上进行远程开发⑺ **步骤 6.** 禁用密码登录并仅设置 RSA 密钥登录 **：** 可选以增强安全性

> ① 加强安全保障

⑻ **步骤 7.** 通过 Mobaxterm（免费）、PuTTY 等软件可以使 SSH 更易于使用。

<br>

<br>

## **6\.步骤 6.**（其他应用程序安装）局域网唤醒 (WOL)

⑴ 软件远程开关机 **：** 提供局域网内的电源功能，使之成为可能

⑵ 许多路由器支持WOL，因此在正确配置后可以使用智能手机应用程序轻松开启

⑶ 无物理连接的VPN服务器无法使用WOL开关

⑷ 一般情况下，如果不存在过热问题，服务器的使用寿命为数年，因此可能不需要 WOL

<br>

<br>

## **7\.步骤 7.** 服务器计算机管理

⑴ 建议关闭显示器以避免烧屏

⑵ Windows 桌面协议允许并发连接，但由于它共享一个 GUI，因此实际上一次只能由一个人使用它。

<br>

---

_输入**：** 2022.08.05 00:28_