## **第 17 章非线性回归分析** 

更高类别**：** 【统计】【统计概述】(https://jb243.github.io/pages/1641)

---

**1.** [二次回归模型](#1-二次回归模型)

**2.** [多项式回归模型](#2-多项式回归模型)

**3.** [对数回归模型](#3-logarithm-regression-model)

**4.** [概率模型](#4-概率模型-因变量是二元变量的情况)

**5.** [互动](#5-互动)

---

**a.** [R中的回归分析](https://jb243.github.io/pages/1754)

---

<br>

## **1.二次回归模型** 

⑴ 公式 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bwg7vV/btruBbqC3Rt/eIwvk2GCPy4OuGQcabqbg1/img.png" alt="绘图" />

<br>

⑵系数的确定 

> ① 使用[多元线性回归模型](https://jb243.github.io/pages/1632#3-multiple-linear-regression-model) **:** 将 X<sub>i</sub> 和 X<sub>i</sub><sup>2</sup> 视为不同的变量并解释它们 

> ②有可能，因为Xi和Xi2不具有完美的多重共线性

⑶ 线性测试 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/dA2F5C/btruxjXetVJ/dLALbce9aNOWKuVDBL9CPk/img.png" alt="绘图" />

<br>

⑷ 变化量的置信区间 

> ①效果：X单位变化对Y的影响如下 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/wQ1tl/btruxjv8pRL/LMlpCVABkMdWs2ock9WoQk/img.png" alt="绘图" />

<br>

> ②边际效应

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cFGEPu/btruBcQBG6C/Uk9cFRRgJMH3KBVTkRwbw0/img.png" alt="绘图" />

<br>

> ③变化量的标准差

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/9gZzX/btrup7XbuUJ/GG5aUByafLZdTqgjqg1vRK/img.png" alt="绘图" />

<br>

> ④ 变化量的置信区间

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cu0g0W/btrurw3xiyC/i8u7fr3nDWRB2KVXFTjOq0/img.png" alt="绘图" />

<br>

<br>

## **2.多项式回归模型** 

⑴ 一般方程

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bjRNiH/btruBa6kDKW/Mfmg5cEcBreqZsRoBl1f50/img.png" alt="绘图" />

<br>

⑵系数的确定**：**使用【多元线性回归模型】(https://jb243.github.io/pages/1632#3-multiple-linear-regression-model)

⑶ 线性测试 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/lqxOp/btruujjajc3/nXgohWGubSKzkO5nfILl4k/img.png" alt="绘图" />

<br>

⑷ **多项式1的次数（阶）的决定**自上而下的方法 

> ①最常用的方法

> ② 第一<sup>第一</sup>。设置r的最大值

> ③ 第二<sup>第二</sup>。测试 H0 **:** βr = 0 

> ④ 第三<sup>第</sup>。如果H0被拒绝，r是回归线的次数 

> ⑤ 第 4<sup></sup>。如果H0没有被拒绝，则消除Xir并对βr-1重复第二步，… 

⑸ **多项式的次数（阶）决定** **2**。自下而上的方法 

> ① 一种查看当添加高一级项时对解释给定样本是否有显着影响的方法

> ② 程序

>> ○ 第一<sup>第一</sup>。假设所有项的系数均以自下而上的方式显着达到 (r-1) 阶多项式  

>> ○ 第二<sup>第二</sup>。添加 r 阶项 

>> ○ 第三<sup>第</sup>。通过r阶回归线计算平方和（自由度**：** r）>> ○ 第 4<sup></sup>。从第 3 步获得的值减去 (r-1) 阶回归线（自由度**:** r-1）的平方和 

>> ○ 第五<sup>th</sup>。通过r阶回归线的残差计算平方和（自由度：n-1-r）

>> ○ 第六<sup>th</sup>。将第 5 步获得的值除以 (n-1-r) 计算均方

>> ○ 7<sup>th</sup>。将第4步得到的平方和差除以第6步得到的均方：平方和差的自由度为1

>> ○ 第八<sup>th</sup>。通过用 F(1, n-1-r) 替换第 7 步中获得的 F 统计量来计算 p 值

> ③示例 

>> ○ 问题情况

<br>

|型号|平方和| df |均方 |
| --- | --- | --- | --- |
|线性| 3971.46 | 3971.46 1 | 3971.46 | 3971.46
|错误 | 372515.09 | 372515.09 18 | 18 20695.28 |
|二次 | 367833.58 | 367833.58 2 | 183916.79 |
|错误 | 8652.97 | 8652.97 17 | 17 509.10 | 509.10
|立方| 369211.71 | 369211.71 3 | 123070.57 |
|错误 | 7274.84 | 7274.84 16 | 16 454.68 | 454.68

<b>表1.</b>问题情况

<br>

>> ○ 结果表 

<br>

|型号|平方和差| df |残差平方和 | df |残差平方和的平均值 | F 比 |
| --- | --- | --- | --- | --- | --- | --- |
|二次 | 367833.58 | 367833.58 2 | 8652.97 | 8652.97 17 | 17 509.10 | 509.10 F1,17 = 714.72 |
|线性| 3971.46 | 3971.46 1 |   |   |   | p < 0.001 |
|差异| 363862.12 | 1 |   |   |   |   |
|立方| 369211.71 | 369211.71 3 | 7274.84 | 7274.84 16 | 16 454.68 | 454.68 F1,16 = 3.03 |
|二次 | 367833.58 | 367833.58 2 |   |   |   | NS |
|差异| 1378.13 | 1378.13 1 |   |   |   |   |

<b>表 2.</b> 结果表

<br>

> ④缺点**：**顺序Ⅰ型错误累积是有问题的 

>> ○ 统计学的研究就是用同时发生的现象来分析它们

>> ○ 通过应用已经以不同概率出现的另一种现象来分析某一概率的现象是非常困难的

>> ○ 困难意味着统计量可能不遵循F分布

>> ○ 自下而上的程度确定方法是在特定概率的现象中分析不同概率的现象

>> ○ 某一特定概率的现象是指(r-1)阶回归方程

>> ○ 概率不同的现象是指r阶回归方程 

>> ○（注）无法清楚地表明平方和的差异遵循F分布 

<br>

<br>

## **3。对数回归模型** 

⑴（注）对数近似

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/8OwV1/btruAr1wYep/hDLK1Md2qdkG3QjO3bsW3K/img.png" alt="绘图" />

<br>

⑵ **类** **1.** 线性对数模型

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/EuBhh/btruvuLuo1s/MToq4U02zMFhIVyoHwou11/img.png" alt="绘图" />

<br>

> ② X<sub>i</sub>增加1%，Y<sub>i</sub>增加0.01β<sub>1</sub> 

⑶ **2.** 对数线性模型

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/THmcs/btruArHe8NI/UAlqRksXIhAnsXufLvQdjK/img.png" alt="绘图" />

<br>

> ② 如果X<sub>i</sub>增加1，Y<sub>i</sub>增加100β1% 

⑷ **类** ****3**.** 对数模型

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/dLL6uB/btruqFN0Zin/tt4j8kCEDsMmlEzNS5KvQK/img.png" alt="绘图" />

<br>

> ② 如果X<sub>i</sub>增加1%，Y<sub>i</sub>增加β<sub>1</sub>% 

⑸ 通过比较对数线性模型和对数对数模型调整后的R<sup>2</sup>，可以选择更合适的模型⑹ 将线性对数模型与其他两个模型进行比较是没有意义的，因为线性对数模型的因变量不同

<br>

<br>

## **4。概率模型****：**因变量为二元变量的情况

⑴线性概率模型（LPM）

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/tSsuj/btrusOcDTTB/KOTEkz1utgRPijKnizzuz0/img.jpg" alt="绘图" />

<b>图 1.</b> 线性概率模型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/niLmi/btruqGlXHSK/B8gnWZQeVqifJ9OCjzvPxk/img.png" alt="绘图" />

<br>

> ② 问题 **:** 因变量并不总是显示 0 到 1 之间的值

⑵ **概率回归模型** 

> ①概述**：**最常用的概率模型

> ② 公式

>> ○ 简易模型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/dczZAk/btrulS0BnDV/iSZr5INjDkOL32hYBsM7KK/img.jpg" alt="绘图" />

<b>图2.</b>概率回归模型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bSkOzb/btrurUqAKa8/RVo9LGlZWBFkNk7OuiHy91/img.png" alt="绘图" />

<br>

>> ○ 多种型号

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/das6JF/btrusODLCxD/hOX9SaZnZWXJEaG8uLCzf0/img.png" alt="绘图" />

<br>

> ③效果 

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/0LXRR/btrurTL1UGz/bR34QeJ8mt6hyWWlMds7G0/img.png" alt="绘图" />

<br>

>> ○ 边际效应

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/byG0vm/btruuhFGHZu/13al2y18DMeUICQW9OxHDk/img.png" alt="绘图" />

<br>

> ④统计估计

>> ○ 每个系数的估计量没有精确的函数形式**：**通过数值分析找到最大似然估计量

>> ○ 一旦获得，最大似然估计满足一致性和正态性

⑶ **逻辑回归模型**

> ①公式

>> ○ 物流功能

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/y85sN/btrurURGNtI/yjlHS7FnSIFNsZzK9hjvv1/img.png" alt="绘图" />

<br>

>> ○ 建模**：** 将 βx + β<sub>0</sub> 的线性回归形式代入逻辑函数，逻辑函数是一种链接函数

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/9aDE1/btruvuxYAnx/bBNhofpQfxcqB2uvv3xJ60/img.png" alt="绘图" />

<br>

>> ○ log-odd（优势比的对数） **:** 也称为 logit。比值比的对数转换。具有从负无穷到正无穷的值。

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/coXLOw/btruuhljsEK/xzy9HdO24SEyUkKuJ2koak/img.png" alt="绘图" />

<b>图 3.</b> logit 函数

<br>
   
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cu1MkG/btruxkhx2NU/RyHatKYy2Wx9790ZK9IWT1/img.png" alt="绘图" />

<br>

>> ○ Logistic 函数是 Logit 函数的反函数。

>> ○ Logistic 函数将取值从负无穷大到正无穷大的输入变量转换为范围从 0 到 1 的输出变量。

> ②【最大似然估计】(https://jb243.github.io/pages/1630) >> ○ 假设自变量不是 x<sub>i</sub> 的多维变量，而是 x<sub>i</sub> 的多维变量，并使用[伯努利函数](https://jb243.github.io/pages/1626#2-bernoulli-distribution) 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/0KYZO/btruvtFQ4G4/TIVPmOz6qsKwKeNWNxgOXK/img.png" alt="绘图" />

<br>

>> ○ L(θ) 似然函数和 ℓ(θ) 对数似然函数的定义 **:** 这里，L(θ) 被定义为[交叉熵](https://jb243.github.io/pages/2145) 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/YUpS2/btruxkolAg9/hxHKOBg80BlrSDRhTk2VJ1/img.png" alt="绘图" />

<br>

>> ○ **引理：** L(θ) 和 ℓ (θ) 是凸函数。 最小解不是局部解而是全局解。证明很复杂

>> ○ **步骤1.** 渐变的定义 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bf2V0Y/btruqEn17YE/HVEHIRrcBYKKOTtP8EoKwk/img.png" alt="绘图" />

<br>

>> ○ **步骤 2.** [Hessian 矩阵] 的定义(https://jb243.github.io/pages/1813) 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/SsWD2/btrurTk1HiW/EEvEEoGhckzzu77Ne5O6oK/img.png" alt="绘图" />

<br>

>> ○ **步骤 3.** 获取二次近似方程 θ<sub>k</sub> 的泰勒级数，并获得近似方程的最大解 θ<sub>k+1</sub> = θ<sub>k</sub> + d<sub>k</sub> 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/0IYW8/btruBcQB0lX/A100XlVnwpxsuMBtnB2Ruk/img.png" alt="绘图" />

<b>图4.</b>最大似然估计与泰勒级数之间的关系

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bd7dXg/btruqFUK024/kjVbaNwtZV4RcMJC9FgHa0/img.png" alt="绘图" />

<br>

>> ○ **步骤4.** 通过[Newton-Raphson方法](https://jb243.github.io/pages/1773)更新θ<sub>k</sub>达到全局最大值 

>>> ○ 这是通过数值分析获得的，但没有每个系数的估计量的精确函数形式。

> ③一致性证明的思路（假设符号可能与上面不同）

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cDUMKi/btruBciL2NE/b6Gph9kkeAEUomfiQ7eKpk/img.png" alt="绘图" />

<br>

> ④ 渐近正态性证明的思路（假设符号可能与上面不同） 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/HFVKL/btruxjv8E10/NUtkkpfqKOpidR7oWe0SFk/img.png" alt="绘图" />

<br>

> ⑤ 应用**：**多类分类 

>> ○ 归纳**：** 由于逻辑回归是二元分类，因此不能直接应用于多类分类 

>> ○ **方法1.** 首先执行1 vs {2, 3}，然后执行2 vs 3 

>> ○ **方法2.softmax函数**

>>> ○ 定义

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/W2j7E/btruBcQB1ic/BIgDTZ3JDBrH1xEqHNAPo0/img.png" alt="绘图" />

<br>

>>> ○ 多类分类中的softmax函数

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bqdjKK/btruvvwSrgO/qqRmyBisvwK0Xip2TbsUD0/img.png" alt="绘图" />

<br>

>>> ○证明**：**逻辑回归是softmax函数的一个特殊例子

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/DMEJ3/btruxkaM5vt/Rs1mVN9Z9LfjAXW6pkW841/img.png" alt="绘图" />

<br>

⑷ LPM、Probit、Logistic函数的比较 

> ① 由于模型不同，无法比较LPM、Probit、Logistic之间的系数

>> ○ **示例1.** Probit回归模型与Logistic回归模型的比较

>>> ○ 显示非常相似的图

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bQMajB/btruBbc6aoF/5Xku7WPKwrJxVO7iB233N1/img.png" alt="绘图" />

<b>图5.</b> Probit回归模型与Logistic回归模型的比较

<br>

>>> ○ 系数差异非常显着**：** 这种差异没有数学意义

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bikDuu/btruqE2EFzy/23nIMqoyy4JY1gf39XFVx1/img.png" alt="绘图" />

<br>

⑸ Dirichlet回归模型：

> ① 概述 **：** 用于回归分析，同时考虑数据的拓扑（单纯形）。

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcoOMjC%2FbtrUurQV3R4%2FdJB6GulWXRRUvoOfU6HuG1%2Fimg.png" alt="绘图"/>

<b>图6.</b>狄利克雷回归模型的应用场景

<br>

> ②样本空间：表示每一项的比例或概率的多维向量

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcIfmrC%2FbtrUuxi9haq%2FlJajvp8honqvFRY3YZuI20%2Fimg.png" alt="绘图"/>

</br>

>> ○ 非负数据

>> ○ 单位和

>> ○ D：元件数量，即尺寸大小

>> ○ d = D - 1

> ③ 狄利克雷分布：因其可以分析单纯形而受到关注。

<br>

<img width="254" alt="스크린샷 2025-06-08 11 20 49" src="https://github.com/user-attachments/assets/fa1e94f0-4819-45e6-afa8-bb25fa42ae0d" />

<br>

> ④ Dirichlet回归估计：

>> ○ Aitchison (2003) 首先引入了对数比变换。
   
>> ○ 对数似然函数：给定 n 个数据点，

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FdguFz6%2FbtrUujSOwtU%2FirK1CmMk7i5dWzN7P5qukK%2Fimg.png" alt="绘图"/>

</br>

>> ○ 零数据可能是对数似然函数中的一个问题。
   
>>> ○ 解决方案 1：用非常小的非零值替换零数据，如 Palarea-Albaladejo、Martín-Fernández 等人提出的。

>>> ○ 解决方案 2：使用单独处理零数据的双模型，如 Zadora、Scealy、Welsh、Stewart、Field、Bear、Billheimer 等人提出的。

>>> ○ 解决方案 3：使用 Tsagris、Stewart 等人提出的稳健适用于零数据的改进回归模型。

<br>

## 5.交互

⑴造型

> ①引入交互回归量或交互项 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/crZefT/btruyMLFz6Z/s3xhcd6ixX2tTBRYksBHkK/img.png" alt="绘图" />

<br>

> ② 无法将系数与没有交互项的模型进行比较

> ③ 还可以定义3个及以上多重交互

⑵ 效果**：** Xi单位变化对Yi的变化如下

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/Mmp48/btrurT6nh7P/zwfuvswPjizZ8tBVb39he0/img.png" alt="绘图" />

<br>

⑶弹性 

> ①直观上来说就是斜率绝对值大的程度

> ②在微观经济学中，弹性是指斜率乘以(-1)⑷ 应用**：**二元变量的交互作用

> ①造型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/DSYea/btruuhyUHzY/yIPkRX5EolgPZkv6BBurd0/img.png" alt="绘图" />

<br>

> ② 效果 **:** X 的 unic 变化对 Y 的影响如下

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/d8dhff/btruxjprbq5/xRUaw8mcM2K70vaFxbxQO1/img.png" alt="绘图" />

<br>

> ③ H<sub>0</sub> **:** Y不受D影响的命题可以通过β<sub>2</sub> = β<sub>3</sub> = 0的F统计量来检验。行列式检验 

> ④ H<sub>0</sub> **:** X单位变化对Y的影响不受D影响的命题可以通过β<sub>3</sub> = 0的t统计量来检验 

> ⑤ 利用D=0的回归线和D=1的回归线可以得到整个回归线

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/blm3Dj/btruxj31cDF/aNEaYusfLl2IDwy4BTx40k/img.png" alt="绘图" />

<br>

⑸ 应用**：**两个二元变量（虚拟变量）的交互作用

> ①造型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bRpvXC/btrusNLB4FS/ykOfv4aHFuVun7vi7nIGP0/img.png" alt="绘图" />

<br>

> ② 知道2×2表中的D<sub>1</sub>、D<sub>2</sub>即可得出回归线方程

<br>

---

*输入：2019.06.21 12:10*