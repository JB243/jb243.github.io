## **第 18 章。高级回归分析** 

更高类别**：** 【统计】【统计概览】(https://jb243.github.io/pages/1641)

---

**1.** [有效性](#1-有效性)

**2.** [面板数据](#2-面板数据)

**3.** [工具变量](#3-工具变量)

**4.** [随机对照实验](#4-随机对照实验)

**5.** [准实验](#5-准实验)

**6.** [异质群体](#6-异质群体)

---

<br>

## **1.** **有效性** 

⑴ 内部效度

> ①定义**：**定性评价回归分析结果得到的各系数计算是否合理

> ② **威胁1.**省略变量偏差 

>> ○ 定义**：** 如果存在满足以下两个条件的变量，则残差的期望值不为零

>>> ○ **条件1.** 省略的变量与一个或多个现有变量相关  

>>> ○ **条件2.** 省略的变量必须是Y的决定因素

>>> ○ 残差期望值示例

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/BIc8c/btrulROfMAN/p5IknsljHuAR3hwB1eOmtK/img.png" alt="绘图" />

<br>

>> ○ 解决方案 

>>> ○ 在回归分析中包括遗漏变量

>>> ○ 如果没有与遗漏变量相关的数据，则有以下三种方法：

>>> ○ **方法1.**面板数据**：**删除不随时间变化的属性

>>> ○ **方法2.**工具变量回归**：**通过工具变量只能提取本质信息  

>>> ○ **方法3.** 在随机对照实验下收集新信息

> ③ **威胁2.**错误的函数形式偏差 

>> ○ 定义**：** 非线性关系中线性回归分析产生的偏差

>> ○ 一种遗漏变量偏差 

> ④ **威胁 3.** 回归变量中的变量偏差或测量误差 

>> ○ 定义 **：** 具有测量误差的自变量 X̃<sub>i</sub>，可以与误差 v<sub>i</sub> 相关 

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/zgnnM/btruAkupIzA/TzCSSWZkEQ5sNdwqWKF7Ik/img.png" alt="绘图" />

<br>

>> ○ **问题1.**计量经济学铁律**：**斜率的OLS估计量往往低于真实值

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/GgF2g/btrukgtSoFG/enQxkkhJMhfqmP9rx8Gg9k/img.png" alt="绘图" />

<br>

>> ○ **问题 2.** OLS 估计器不具有一致性 

>> ○ **问题 3.** 统计估计不准确

>> ○ 解决方案 

>>> ○ **方法1.** 提高测量仪器的精度

>>> ○ **方法2.**工具变量回归**：** 通过工具变量只能提取本质信息

>>> ○ **方法 3.** 纠错**：** 如果存在错误模式，则可以进行纠正

>> ○（注）如果因变量存在测量误差

>>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bjXMMd/btruoMlv2w7/Ucph8cSzvn9Yxy8UNIvtek/img.png" alt="绘图" />

<br>

>>> ○ 斜率的估计量不变

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/pk8yj/btruyNw4LqD/wMgArKCIkK7ggNz3DHcjSK/img.png" alt="绘图" />

<br>

>>> ○ 满足简单线性回归模型的**三个**主要假设**

>>> ○ **假设 1.** X<sub>i</sub> 未提供有关 v<sub>i</sub> 的任何信息 

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cjSlBV/btruhu7ktiX/51pARSyLYpKUfOLE7enx7k/img.png" alt="绘图" />

<br>

>>> ○ **假设 2.** X<sub>i</sub> 和 Ỹ<sub>i</sub> 是 i.i.d. 

>>>> ○ 因为 Y<sub>i</sub> 和 wi 是 i.i.d.并且相互独立，Ỹ<sub>i</sub> 是 i.i.d。 

>>>> ○ 由于 X<sub>i</sub> 与 Y<sub>j</sub> 或 w<sub>j</sub> 独立，且 i ≠ j，因此 X<sub>i</sub> 和 Ỹ<sub>i</sub> 是独立的 

>>>> ○ 因此，满足**假设2** 

>>> ○ **假设 3.** 存在四阶矩 

>>>> ○ 因为 u<sub>i</sub> 和 w<sub>i</sub> 具有有限的四阶矩且相互独立，所以 v<sub>i</sub> = u<sub>i</sub> + w<sub>i</sub> 具有有限的四阶矩 

>>>> ○ 因此，(X<sub>i</sub>, v<sub>i</sub>) 具有非零有限四阶矩 

>>> ○ 变量误差偏差之间存在**三个差异**

>>> ○ **差异 1.** OLS 估计器具有一致性 

>>> ○ **差异2.** 统计估计准确 

>>> ○ **差异 3.** 增加了回归误差的方差 → 增加了 OLS 估计器的方差

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/v2TUi/btruoKBfGkq/nUmFPvgt5kBykgF405h53K/img.png" alt="绘图" />

<br>

>> ⑤ **威胁4.**样本选择偏差

>>> ○ 当数据选择过程中出现偏差时

>>> ○ 换句话说，偏差是通过从一部分推导出整个群体的特征而产生的 

>>> ○ **示例 1.** 因素 A 和因素 B 的招募率

>>>> ○ 假设招募率随着 A 和 B 的增加而增加

>>>> ○ A因素低的人不想申请

>>>> ○ A系数低者，B系数高者适用

>>>> ○ 因此，A因素的就业率回归曲线衡量A因素的影响低于实际影响

> ⑥ **威胁 5.** 同时因果关系偏差 

>> ○ 从自变量到因变量之间存在偶然联系是很自然的

>> ○ 如果因变量与自变量存在因果关系，则自变量的系数会出现偏差

>> ○ 就好像**反馈电路**用复杂的公式来表达

>>> ○正反馈电路**：**增加系数的绝对值

>>> ○ 负反馈电路 **:** 减小系数的绝对值

>>> ○ 例子 **：** 出生率和死亡率之间存在相互因果关系。类似于正反馈电路

>> ○ 解决方案 

>>> ○ **方法1.**工具变量回归**：**仅提取已从因果联系中剔除的本质信息

>>> ○ **方法2.**随机对照实验**：**通过随机进行处理来消除因变量的因果关系

⑵ 外部效度 

> ①定义**：**对回归分析得到的各自变量的系数是否适用于其他人群的定性评价

> ② **威胁1.**非代表性样本**：**人群本身的差异

> ③ **威胁2.**非代表性的计划或政策**：**制度差异 

>> ○ 即使总体相同，不同的系统也可能违反外部效度

>> ○示例**：**教育环境差异、法律制度差异、物质环境差异等

> ④ **威胁3.**一般均衡效应 

>> ○ 定义**：** 治疗改变整体环境，可以放大或抑制治疗的有效性

>> ○ 类似于同时因果偏差>> ○ [示例](https://economics.stackexchange.com/questions/26892/what-are-general-equilibrium-effects) **:** 油田的存在对收入的影响

>>> ○ 油田的存在 → 工人收入增加

>>> ○ 工人收入增加 → 新工人流入增加

>>> ○ 购房增加 → 因住房短缺导致房价上涨 → 收入减少

>>> ○ 汽车拥堵加剧 → 收入减少的因素

>>> ○ 由于收入增加，对餐厅质量的要求增加 → 外出就餐成本增加 → 收入减少的因素

> ⑤ 解决方案

>>> ○ 根据人口和环境调整回归关系结论的方法

>>> ○ 荟萃分析**：** 比较相似但不相同人群的结论

<br>

<br>

## **2.面板数据**

⑴概述 

> ①参考以下数据

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bdQtLa/btrurT6qoYx/xigKO4CtGfTgk2Oz0MpoOK/img.png" alt="绘图" />

<br>

> ② 平衡面板数据 **:** 所有实体在所有时间间隔内均配备

> ③不平衡面板数据**：**如果不是平衡面板数据

> ④（比较）重复截面数据 

>> ○ 面板数据是针对每个人跟踪的数据

>> ○ 重复截面数据是随时间推移获得的数据 

>> ○ 即使是重复的横截面数据，前后数据中也可以包含同一个人，并且成本低廉

⑵ 回归模型前后

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/wbpED/btrurURJL3N/wHEtkWX4SORpRKZS6jRO00/img.png" alt="绘图" />

<br>

>> ○ 该模型可以随着时间的推移删除不变的元素 

>> ○ Z 与截距不同，因为它根据 i 具有不同的值

> ② 一种固定效应回归模型 

⑶固定效应回归模型

>> ①主要假设

>>> ○ **假设 1.** <span>E(u<sub>it</sub> | X<sub>i1</sub>, ···, X<sub>iT</sub>, α<sub>i</sub>)</span> \= 0**:** E(u<sub>it</sub> | X<sub>it</sub>, α<sub>i</sub>) = 0 是不够的 (**∵** 所有的信息时间用于y和u的平均值）

>>> ○ **假设 2.** (X<sub>i1</sub>, ···, X<sub>iT</sub>, u<sub>i1</sub>, ···, u<sub>iT</sub>) 是 i.i.d.在联合分布下 **:** 换句话说，这并不意味着 cov(u<sub>it</sub>, u<sub>is</sub>) = 0 （假设 t ≠ s） 

>>> ○ **假设 3.** 存在四阶矩 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/kFMy0/btrupI5pifA/rboPlIHF1lRa97ULOpFAHK/img.png" alt="绘图" />

<br>

>>> ○ **假设 4.** 不存在完美的多重共线性 **:** X<sub>it</sub> 必须依赖于 t

>>> ○ 在majore假设下，固定效应估计量满足一致性和渐近正态性

>>> ○ 即使n增加到无穷大，Y在时间上的平均值也不满足一致性和正态性（**∵** n和T无关）

> ② 公式 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/dq3ZCa/btrupHMbzoQ/aqBEr5VAdpkJxJGnkBafKk/img.png" alt="绘图" />

<br>

>> ○ 数据应理解为在 i 和 t 轴上表示的表格

>> ○ 在T = 2的情况下，与回归模型前后的情况相同

>> ○ 斜率标准差 = 聚类标准误差 = 异方差 & 自相关一致标准误差 (HAC)

>> ○ 直到 t = 1、··· 和 T 为止，总共不存在 T 条回归线。它只是一条回归线

>> ○ 不是 β<sub>1, t</sub> 而是 β<sub>1</sub> > ③【算法示例】(http://www.pearsonglobaleditions.com/) 

<br>

<!-- 使用 hilite.me 生成的 HTML --><div style="background: #ffffff; Overflow:auto;width:auto;border:solid grey;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">数据 <span style="color: #333333"><-</span> 读取<span style="color: #333333">.</span>csv(<span style="background-color: #fff0f0">"C:/Users/sun/Desktop/Guns.csv"</span>，标题 <span style="color: #333333">=</span> T)
附加（数据）

y <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">2</span>]
y <span style="color: #333333"><-</span> log(y)
x1 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">13</span>]
x2 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: bold">5</span>]
x3 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">11</span>]
x4 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">10</span>]
x5 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">9</span>]
x6 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">6</span>]
x7 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">7</span>]
x8 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">8</span>]

state_y <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)<span style="color: #008800; font-weight: bold">for</span>(i <span style="color: #000000; font-weight: bold">在</span> <span style="color: #0000DD; font-weight: bold">1</span>:<span style="color: #0000DD; font-weight: bold">56</span>){
    <span style=“color：#008800; font-weight：bold”>if</span>（i <span style=“color：#333333”>！=</span> <span style=“color：#0000DD; font-weight：bold”>3</span> <span style=“color：#333333”>&&</span> i <span style=“color：#333333”>！=</span> <span style="color: #0000DD; font-weight: bold">7</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">14</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">43</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">52</span>){
        data_sub <span style="color: #333333"><-</span> data[stateid <span style="color: #333333">==</span> i, ]
        state_y[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">2</span>])
        state_x1[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">13</span>])
        state_x2[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">5</span>])
        state_x3[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">11</span>])
        state_x4[i] <span style="color: #333333"><-</span> 意思(data_sub[, <span style="color: #0000DD; font-weight: bold">10</span>])
        state_x5[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">9</span>])
        state_x6[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">6</span>])
        state_x7[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">7</span>])
        state_x8[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">8</span>])
    }
}

Y <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)<span style =“color：#008800; font-weight：bold”> for </span>（i <span style =“color：#000000; font-weight：bold”>在</span> <span style =“color：#0000DD; font-weight：bold”>1</span>：暗淡（数据）[<span style =“color：#0000DD; font-weight：bold”>1</span>]）{
    j <span style="color: #333333"><-</span> data[i, <span style="color: #0000DD; font-weight: bold">12</span>]
    Y[i] <span style="color: #333333"><-</span> y[i] <span style="color: #333333">-</span> state_y[j]
    X1[i] <span style="color: #333333"><-</span> x1[i] <span style="color: #333333">-</span> state_x1[j]
    X2[i] <span style="color: #333333"><-</span> x2[i] <span style="color: #333333">-</span> state_x2[j]
    X3[i] <span style="color: #333333"><-</span> x3[i] <span style="color: #333333">-</span> state_x3[j]
    X4[i] <span style="color: #333333"><-</span> x4[i] <span style="color: #333333">-</span> state_x4[j]
    X5[i] <span style="color: #333333"><-</span> x5[i] <span style="color: #333333">-</span> state_x5[j]
    X6[i] <span style="color: #333333"><-</span> x6[i] <span style="color: #333333">-</span> state_x6[j]
    X7[i] <span style="color: #333333"><-</span> x7[i] <span style="color: #333333">-</span> state_x7[j]
    X8[i] <span style="color: #333333"><-</span> x8[i] <span style="color: #333333">-</span> state_x8[j]
}



关系 <span style="color: #333333"><-</span> lm(Y <span style="color: #333333">~</span> X1 <span style="color: #333333">+</span> X2 <span style="color: #333333">+</span> X3 <span style="color: #333333">+</span> X4 <span style="color: #333333">+</span> X5 <span style="color: #333333">+</span> X6 <span style="color: #333333">+</span> X7 <span style="color: #333333">+</span> X8)

摘要（关系）
</前></div>

<br>

> ④ 当应用固定效应回归模型得出的结论与原始结果有显着差异时

>> ○ 强烈暗示原始模型中存在遗漏变量偏差

> ⑤ 即使满足主要假设，也可能存在自相关

>> ○ 自相关**：** uit 和 uit\* (t ≠ t\*) 也具有序列相关性。与 HAC 相关

>> ○ 无自相关的情况 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F996F474B5DDC77CC29" alt="绘图"/>

<b>图 1.</b> 没有自相关的情况

<br>

>> ○ 有自相关的情况 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bbQqm5/btrupHSWz3Z/8GPC2NJmZDocQVkLZgmgY1/img.jpg" alt="绘图" />

<b>图 2.</b> 具有自相关的情况 

<br>

>> ○ 无自相关情况下 cov(v<sub>it</sub>, v<sub>is</sub>) = 0 (假设 k ≠ s) 的证明 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bAqz2l/btruBbEd3nR/kqmfkKCTAu6PqikvUDJop0/img.png" alt="绘图" />

<br>

⑷ 固定效应回归模型的矩阵表示法 

> ①造型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/erBfrj/btruvvqaTQJ/ue6VVsKtofojRD3xEO7ZV0/img.png" alt="绘图" />

<br>

> ②假设

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ox2A1/btrukf2QYYL/QKhiAnR1zBEncSeNKVG7K0/img.png" alt="绘图" />

<br>

> ③固定效应估计器

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/zkUuq/btruBbRKvTM/JeQWWUl9CzEpsoH1MRYmpk/img.png" alt="绘图" />

<br>

> ④一致性

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cALSZ6/btruvudKkX2/4lutkvFoQYrb2BeTpYYll0/img.png" alt="绘图" />

<br>

> ⑤渐近正态性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/JBvYn/btruuiR9ANJ/Ek7qNGyIMMkLK6GSXfpwQ1/img.png" alt="绘图" />

<br>

⑸ 最小二乘虚拟变量模型（LSDV）

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/l0WTh/btruqEImP2L/RPwMU5uGVwDQQbCc07aAok/img.png" alt="绘图" />

<br>

> ② 不包含D1<sub>i</sub>的原因**：**避免完美多重共线性

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bs4Swg/btrutkIwu8U/kTgwupX0RfCreyiEWE6101/img.png" alt="绘图" />

<br>

>> ○ 如果系数存在，则不能指定γ<sub>1</sub>

>> ○ 虚拟变量引起的完全多重共线性也称为虚拟变量陷阱

> ③ 如果i（即n）的范围太大，则无法进行回归分析**：**因为回归变量太多 

⑹时间效应 

> ①时间效应项**：**标记为λ<sub>t</sub>  

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/btzgFg/btrutkhts4k/9u5gYDoVA3VpuCJtJIe1C1/img.png" alt="绘图" />

<br>

> ②造型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/be8sxr/btrukfBNReC/N7Clm2vlnx80XLri4sDlh0/img.png" alt="绘图" />

<br>

> ③【算法示例】(http://www.pearsonglobaleditions.com/)

<br>

<!-- 使用 hilite.me 生成的 HTML --><div style="background: #ffffff; Overflow:auto;width:auto;border:solid grey;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">数据 <span style="color: #333333"><-</span> 读取<span style="color: #333333">.</span>csv(<span style="background-color: #fff0f0">"C:/Users/sun/Desktop/Guns.csv"</span>，标题 <span style="color: #333333">=</span> T)
附加（数据）

<span style="color: #888888"># 定义</span>
y <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">2</span>]
y <span style="color: #333333"><-</span> log(y)
x1 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">13</span>]
x2 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: bold">5</span>]
x3 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">11</span>]
x4 <span style="color: #333333"><-</span> 数据[, <span style="color: #0000DD; font-weight: 粗体">10</span>]
x5 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">9</span>]
x6 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">6</span>]
x7 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">7</span>]
x8 <span style="color: #333333"><-</span> data[, <span style="color: #0000DD; font-weight: bold">8</span>]<span style="color: #888888">#消除固定状态效果</span>
state_y <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)
state_x8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">56</span>)<span style="color: #008800; font-weight: bold">for</span>(i <span style="color: #000000; font-weight: bold">在</span> <span style="color: #0000DD; font-weight: bold">1</span>:<span style="color: #0000DD; font-weight: bold">56</span>){
    <span style=“color：#008800; font-weight：bold”>if</span>（i <span style=“color：#333333”>！=</span> <span style=“color：#0000DD; font-weight：bold”>3</span> <span style=“color：#333333”>&&</span> i <span style=“color：#333333”>！=</span> <span style="color: #0000DD; font-weight: bold">7</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">14</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">43</span> <span style="color: #333333">&&</span> i <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">52</span>){
        data_sub <span style="color: #333333"><-</span> data[stateid <span style="color: #333333">==</span> i, ]
        state_y[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">2</span>])
        state_x1[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">13</span>])
        state_x2[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">5</span>])
        state_x3[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">11</span>])
        state_x4[i] <span style="color: #333333"><-</span> 意思(data_sub[, <span style="color: #0000DD; font-weight: bold">10</span>])
        state_x5[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">9</span>])
        state_x6[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">6</span>])
        state_x7[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">7</span>])
        state_x8[i] <span style="color: #333333"><-</span>mean(data_sub[, <span style="color: #0000DD; font-weight:bold">8</span>])
    }
}

Y <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
X8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)<span style =“color：#008800; font-weight：bold”> for </span>（i <span style =“color：#000000; font-weight：bold”>在</span> <span style =“color：#0000DD; font-weight：bold”>1</span>：暗淡（数据）[<span style =“color：#0000DD; font-weight：bold”>1</span>]）{
    j <span style="color: #333333"><-</span> data[i, <span style="color: #0000DD; font-weight: bold">12</span>]
    Y[i] <span style="color: #333333"><-</span> y[i] <span style="color: #333333">-</span> state_y[j]
    X1[i] <span style="color: #333333"><-</span> x1[i] <span style="color: #333333">-</span> state_x1[j]
    X2[i] <span style="color: #333333"><-</span> x2[i] <span style="color: #333333">-</span> state_x2[j]
    X3[i] <span style="color: #333333"><-</span> x3[i] <span style="color: #333333">-</span> state_x3[j]
    X4[i] <span style="color: #333333"><-</span> x4[i] <span style="color: #333333">-</span> state_x4[j]
    X5[i] <span style="color: #333333"><-</span> x5[i] <span style="color: #333333">-</span> state_x5[j]
    X6[i] <span style="color: #333333"><-</span> x6[i] <span style="color: #333333">-</span> state_x6[j]
    X7[i] <span style="color: #333333"><-</span> x7[i] <span style="color: #333333">-</span> state_x7[j]
    X8[i] <span style="color: #333333"><-</span> x8[i] <span style="color: #333333">-</span> state_x8[j]
}

<span style="color: #888888">#消除固定时间效果</span>
time_Y <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)
time_X8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">23</span>)<span style="color: #008800; font-weight: bold">for</span>(t <span style="color: #000000; font-weight: bold">中</span> <span style="color: #0000DD; font-weight: bold">77</span>:<span style="color: #0000DD; font-weight: bold">99</span>){
    data_sub2 <span style="color: #333333"><-</span> 数据[年份 <span style="color: #333333">==</span> t, ]
    time_Y[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">2</span>]) <span style="color: #333333">-</span> 意思(state_y, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X1[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">13</span>]) <span style="color: #333333">-</span> 平均值(state_x1, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X2[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">5</span>]) <span style="color: #333333">-</span> 平均值(state_x2, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X3[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">11</span>]) <span style="color: #333333">-</span> 平均值(state_x3, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X4[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">10</span>]) <span style="color: #333333">-</span> 平均值(state_x4, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X5[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">9</span>]) <span style="color: #333333">-</span> 平均值(state_x5, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X6[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">6</span>]) <span style="color: #333333">-</span> 平均值(state_x6, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X7[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">7</span>]) <span style="color: #333333">-</span> 平均值(state_x7, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
    time_X8[t <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>] <span style="color: #333333"><-</span>mean(data_sub2[, <span style="color: #0000DD; font-weight:bold">8</span>]) <span style="color: #333333">-</span> 平均值(state_x8, na<span style="color: #333333">.</span>rm <span style="color: #333333">=</span> TRUE)
}YY <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX1 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX2 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX3 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX4 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX5 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX6 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX7 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)
XX8 <span style="color: #333333"><-</span> 数组(dim <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1173</span>)

<span style =“color：#008800; font-weight：bold”> for </span>（i <span style =“color：#000000; font-weight：bold”>在</span> <span style =“color：#0000DD; font-weight：bold”>1</span>：暗淡（数据）[<span style =“color：#0000DD; font-weight：bold”>1</span>]）{
    j <span style="color: #333333"><-</span> data[i, <span style="color: #0000DD; font-weight: bold">1</span>]
    YY[i] <span style="color: #333333"><-</span> Y[i] <span style="color: #333333">-</span> time_Y[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>]
    XX1[i] <span style="color: #333333"><-</span> X1[i] <span style="color: #333333">-</span> time_X1[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight:bold">76</span>]
    XX2[i] <span style="color: #333333"><-</span> X2[i] <span style="color: #333333">-</span> time_X2[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight:bold">76</span>]
    XX3[i] <span style="color: #333333"><-</span> X3[i] <span style="color: #333333">-</span> time_X3[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>]
    XX4[i] <span style="color: #333333"><-</span> X4[i] <span style="color: #333333">-</span> time_X4[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight:bold">76</span>]
    XX5[i] <span style="color: #333333"><-</span> X5[i] <span style="color: #333333">-</span> time_X5[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight:bold">76</span>]
    XX6[i] <span style="color: #333333"><-</span> X6[i] <span style="color: #333333">-</span> time_X6[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>]
    XX7[i] <span style="color: #333333"><-</span> X7[i] <span style="color: #333333">-</span> time_X7[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>]
    XX8[i] <span style="color: #333333"><-</span> X8[i] <span style="color: #333333">-</span> time_X8[j <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">76</span>]
}关系 <span style="color: #333333"><-</span> lm(YY <span style="color: #333333">~</span> XX1 <span style="color: #333333">+</span> XX2 <span style="color: #333333">+</span> XX3 <span style="color: #333333">+</span> XX4 <span style="color: #333333">+</span> XX5 <span style="color: #333333">+</span> XX6 <span style="color: #333333">+</span> XX7 <span style="color: #333333">+</span> XX8)

摘要（关系）
</前></div>

<br>

⑺ 使用虚拟变量的时间效应回归

> ①公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bbUx5e/btruoL7WIOs/TQ2lXuj6WzWhDOapGXU3Qk/img.png" alt="绘图" />

<br>

> ② 不包含B1<sub>t</sub>的原因**：**避免完美多重共线性

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/b4KumB/btruqEVWfL1/kW2QhdRqYva2QVlx9b5lR1/img.png" alt="绘图" />

<br>

>> ○ 如果系数存在，则不能指定δ<sub>1</sub>

>> ○ 虚拟变量引起的完全多重共线性也称为虚拟变量陷阱

<br>

<br>

## **3。工具变量** 

⑴定义**：**使用第三个变量仅分离回归变量的本质信息的方法

⑵ 简单表达

> ①造型

>> ○ 如果有一个回归变量

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/BRB4H/btruvu5Q4T2/GNwao9wZJekoEIzYEsMBOk/img.png" alt="绘图" />

<br>

>> ○ 如果有多个回归变量 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bDE2WC/btruyNDQKFQ/kvYEjMXhdK3uPiHDvPq83k/img.png" alt="绘图" />

<br>

>> ○ 内生变量 **:** 与 u<sub>i</sub> 相关的变量  

>> ○ 外生变量 **：** 与 u<sub>i</sub> 不相关的变量

>> ○ 准确识别 **:** m = k

>> ○ 过度识别 **:** m ＞ k

>> ○ 识别不足 **:** m ＜ k 

>> ○ 无法在未识别的情况下进行建模 **：** 这意味着应该有很多工具变量

>> ○ 包含 W 的原因 **：** 当很难找到满足条件的 Z 时很有用

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/crHsEP/btrurTrRS1v/FjkTAChIlpswwxeVl8nKMk/img.png" alt="绘图" />

<br>

> ② 使用工具变量的假设 

>> ○ **假设 1.** <span>E(u<sub>i</sub> | W<sub>1i</sub>, ···, W<sub>ri</sub>) = 0 </span>

>> ○ **假设 2.** (X<sub>1i</sub>, ···, X<sub>ki</sub>, W<sub>1i</sub>, ···, W<sub>ri</sub>, Z<sub>1i</sub>, ···, Z<sub>mi</sub>, Y<sub>i</sub>) 是独立同分布的。 

>> ○ **假设 3.** 所有变量都有有限的四阶矩

>> ○ **假设** **4.** 工具变量有效性

>>> ○ **4-1.** 仪器相关性

>>> ○ **4-2.** 仪器外生性

>>> ○ **4-3.** 无完全共线性

>> ○ 如果满足假设，则 TSLS 估计量满足一致性和渐近正态性 

> ③ 程序

>> ○ 如果有一个回归变量

>>> ○ 第一<sup>第一</sup>。使用工具变量 Z<sub>i</sub> 对 X<sub>i</sub> 进行回归分析 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/becxa1/btrusOw2Uhz/MK4ph3N2ShAM7tFVrlUz8K/img.png" alt="绘图" />

<br>

>>> ○ 第二<sup>第二</sup>。计算 X<sub>i</sub> 的估计量  

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/tGaEd/btrupIdbyV5/Bi6QXsmcrKrBTGV0Mp4OH0/img.png" alt="绘图" />

<br>>>> ○ 第三<sup>第</sup>。使用 X<sub>i</sub> 的估计器对 Y<sub>i</sub> 进行回归分析  

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bhzr4a/btruyMStLCw/4Kbg6GAKZKU1SEhXn1V6ik/img.png" alt="绘图" />

<br>

>> ○ 如果有多个回归变量 

>>> ○ 第一<sup>第一</sup>。使用工具变量 **Z<sub>i</sub>** **:** 对 ℓ = 1, ···, k, 对 **X<sub>i</sub>** 进行回归分析， 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/CZ3Tj/btruvvjpBn5/pAldpvhDKagErdUjVWQ0ck/img.png" alt="绘图" />

<br>

>>> ○ 第二<sup>第二</sup>。计算 **X<sub>i</sub>** **:** 对于 ℓ = 1, ···, k,

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bOuUQ8/btruAs0vnUq/Np1nKoYQvoVm7xIaxhnBsk/img.png" alt="绘图" />

<br>

>>> ○ 第三<sup>第</sup>。使用 **X<sub>i</sub>** **:** for ℓ = 1, ···, k 的估计器对 Y<sub>i</sub> 进行回归分析， 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bRcwUv/btruyNw45RE/LFMMwCnNUjOTSLahmkPHV1/img.png" alt="绘图" />

<br>

>> ○ 进行两次 OLS 回归可能会错误计算标准误差

> ④ 两步最小二乘法（TSLS）估计器 

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/qrqTz/btrurUjUkuN/iYyVeYFKhVBw1rQA6jf2jK/img.png" alt="绘图" />

<br>

>> ○ 证明

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cZ7f36/btruyObHsBO/A0PATXbgAXgX6TbqbrjTOk/img.png" alt="绘图" />

<br>

>> ○（注）如果 Z<sub>i</sub> **:**\= X<sub>i</sub>，则 β<sub>1</sub> 的 TSLS 估计器与 β<sub>1</sub> 的 OLS 估计器相同 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/TS253/btrurS0FWFY/8TSoKbKZAf9YE2ZeNQSkjK/img.png" alt="绘图" />

<br>

> ⑤ 一致性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/32slN/btruqFghteo/px73DL1O9BU3YPPAdnssFK/img.png" alt="绘图" />

<br>

> ⑥ 渐近正态性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bMoZ2j/btruqF8oJpa/P8NcpfCk62kwmU8PsXsek0/img.png" alt="绘图" />

<br>

⑶工具变量有效性的补充 

> ① 仪器相关性

>> ○ 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bNdlfa/btruBcC7Wp6/fbobV1GVzt8FwvDjiuvzC1/img.png" alt="绘图" />

<br>

>> ○ 弱工具变量**：** 工具变量与回归变量相关性不充分的情况。估计值显示出非常奇怪的值 

>> ○ 仪器变强度测试 

>>> ○ 计算第一阶段F统计量时，如果F大于10，则工具变量较强

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cRsQhb/btruvtMGj9y/Po8IW8D5GWNZ0qMhUD8Y0k/img.png" alt="绘图" />

<br>

>>> ○ 仅适用于**同方差**

>>> ○ W<sub>1i</sub>, ···, W<sub>ri</sub> 与工具变量的强度无关

> ②仪器外生性 

>> ○ 公式 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ENsGL/btruBdaZmoX/cOZrxc7K9pn54FaBwYtwjk/img.png" alt="绘图" />

<br>

>> ○ 必须指定 u 才能了解工具外生性

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/v7XwC/btruvurfJXX/0vKhz8dJ60W7AUImYHECwK/img.png" alt="绘图" />

<br>

>> ○ 过度识别限制测试 

>>> ○ 当计算以下统计量时，J 服从自由度为 m-k 的卡方分布

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/OeEUn/btruwIoNGYW/tnKhZFBsvpX9BPax8g1qzK/img.png" alt="绘图" />

<br>

>>> ○ J, H<sub>0</sub> **:** 工具变量是外生的命题

>>> ○ 逻辑与仪器相关性类似 **:** 如果F统计量很小，则说明不存在相关性（所有系数均为0）

>>> ○ 仅适用于**同方差** **：** 许多统计程序还提供异方差稳健 J 检验

>>> ○ 拒绝零假设时无法确定哪个工具变量是内生的

>> ○ J统计量中自由度的含义

>>> ○ k 个工具变量用于制作残差：它们对应于 k 个内生变量

>>> ○ 剩余的m-k个工具变量用于检验与残差的相关性

>>> ○ 在准确识别的情况下无法应用 J 检验，因为没有工具变量可用于相关关系分析：这种情况下 J 统计量始终为零

> ③不存在完美共线性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bZxPbu/btrurUxq1XD/VOb2XRW9Wydkadskqvsc70/img.png" alt="绘图" />

<br>

⑷ 矩阵表示法

> ①造型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bTMPyc/btruoKHYYyg/PAoZp2lEw1BfVTs7EzYel1/img.png" alt="绘图" />

<br>

>> ○ X<sub>i</sub> 和 Z<sub>i</sub> 可能重叠

> ②假设 

>> ○ Y<sub>i</sub> \= **X<sub>i</sub>**<sup>t</sup>β + u<sub>i</sub>

>> ○ (Y<sub>i</sub>, **X****<sub>i</sub>**, **Z****<sub>i</sub>**), i = 1, ···, N 是 i.i.d.

>> ○ E(u<sub>i</sub> <span>|</span> **Z****<sub>i</sub>**) = 0

>> ○ E(**Z****<sub>i</sub>****X<sub>i</sub>**<sup>t</sup>), E(**Z****<sub>i</sub>****Z<sub>i</sub>**<sup>t</sup>) 有逆矩阵  

>> ○ **Z****<sub>i</sub>**,,**X<sub>i</sub>**, 和 ui 具有有限的四阶矩 

> ③ 程序 

>> ○ 第一<sup>第一</sup>。使用工具变量 **Z****<sub>i</sub>** 对 **X****<sub>i</sub>** 进行回归分析 

>> ○ 第二<sup>第二</sup>。计算 **X****<sub>i</sub>** 的估计量 

>> ○ 第三<sup>第</sup>。使用 **X****i** 的估计器对 Y<sub>i</sub> 进行回归分析 

> ④ 估计器

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cjJvk6/btruhv6eWaq/MZCTfGR7zuPWx0YzXrO2ak/img.png" alt="绘图" />

<br>

> ⑤ 一致性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cRqkaj/btrutkIwAhy/FGGvRaznzx6reCtg5jOHK0/img.png" alt="绘图" />

<br>

> ⑥ 渐近正态性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/O3yf0/btruvu5RdWU/hMaY0FqlO6xkBWF736wB71/img.png" alt="绘图" />

<br>

> ⑦ 正态分布方差的估计量  

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/72Ogn/btrutk2O1sM/v7awSfbLa5MKBkXRvZburK/img.png" alt="绘图" />

<br>

⑸ 工具变量的探索**：**探索是在艺术领域  

> ① 约书亚·安格里斯特（麻省理工学院）

> ②史蒂文·莱维特（芝加哥）**：**发表《魔鬼经济学》> ③ Daron Acemoglu（麻省理工学院）**：**发表《国家为何失败》

<br>

<br>

## **4\.随机对照实验** 

⑴概述 

> ①定义**：**从人群中随机抽取受试者，然后再次随机分组，进行不同的治疗

> ②随机对照实验在计量经济学中很少见

> ③随机对照实验可以消除遗漏变量偏差**：**不保证100%有效性

> ④ 提供了判断因果关系的标准

⑵ 公式 

> ①简单模型

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/OERpP/btruxjC1vov/BtTtRDj08UbZsJkyV0k8W0/img.png" alt="绘图" />

<br>

> ② 模型包括附加回归变量

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/b6BFCF/btruArAwvSb/k5F7As1kxbuUoP2rBmGHW0/img.png" alt="绘图" />

<br>

> ③增加额外回归变量的原因

>> ○ **原因 1.** 随机化检查 

>>> ○ 无论是否存在附加回归变量，β<sub>1</sub> 都是一致的

>>> ○ 如果 β<sub>1</sub> 根据是否存在其他回归变量而发生显着变化，则不是随机的 

>> ○ **原因2.**效率**：**如果有额外的回归变量，方差会更小

>> ○ **原因 3.** 条件随机化

>>> ○ 根据人的个体特征，即使看起来是随机提取的，也可能不是随机的

>>> ○ 固定附加回归变量的随机抽样可以最大限度地减少此类担忧

>>> ○ 要使 β<sub>1</sub> 估计量保持一致，必须满足以下条件独立性：比独立性更弱的条件 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ccM7uV/btruvtMGpf1/EeryGktLxsLXkHUQbepiSk/img.png" alt="绘图" />

<br>

>> ○ 相互作用**：** 治疗效果取决于W

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cs6n6C/btruuiR9ZPo/y0Q6kLjJxUuZa5QlnLHkq1/img.png" alt="绘图" />

<br>

⑶ 对内部效度的威胁 

> ① 未能随机化

>> ○ 不仅出现处理效果，还出现非随机分配效果

>> ○假设检验**：**使用X<sub>i</sub>对W<sub>1i</sub>、···、W<sub>ri</sub>的治疗前特征进行回归分析时，若系数均为零，则该实验可视为随机实验 

>> ○ 示例**：** 如果按姓名进行随机处理，则可能会优先将特定种族分配到处理组 

> ② 未能遵循治疗方案（部分依从）

>> ○ 定义**：** 即使随机处理效果很好，受试者也可能无法很好地遵守协议

>> ○ 因此，X<sub>i</sub> 可以与 ui 关联  

>> ○ 随机鼓励设计 **：** 如果以随机治疗为工具变量，并在工具变量回归下分析真实治疗，则可以确定部分依从性 

> ③自然损耗

>> ○ 定义**：** 随机抽样后因与治疗相关的原因排除受试者 

> ④ 霍桑效应 

>> ○ 定义 **：** 受试者对他或她正在进行的实验的了解会影响实验结果

>> ○ 在新药研究中，可以采用双盲试验来避免这个问题 

>> ○ 计量经济学难以进行双盲测试

> ⑤ 小样本

>> ○ 由于与人类相关的研究费用昂贵，样本量较小

>> ○ 许多统计估计都是基于渐近正态性>> ○ 如果样本量较小，则不应采用正态分布来估计样本

⑷ 外部有效性的威胁 

> ①非代表性样本

>> ○ 一般计量经济学实验针对本科生志愿者

>> ○ 志愿者更有动力，在测量效果方面可能被高估

> ②非代表性计划或政策

>> ○ 试点方案或政策应与实际相近

>> ○ 示例**：** 实验程序执行时间很短。现实生活中感兴趣的领域可能需要更长的时间

> ③一般均衡效应 

>> ○ 定义**：** 治疗改变整体环境，可以放大或抑制治疗的有效性

>> ○ 小实验不能反映环境的变化，因此必须单独考虑外部效度

<br>

<br>

## **5.** **准实验**

⑴定义

> ① 自变量不受研究者控制且在自然情况下进行的实验

> ②又称自然实验

> ③目标**：**方案评估

⑵ **方法 1.** 双重差分 (DID) 估计器 

> ①最简单模型（假设面板数据）

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ceKukp/btruqFHlNWR/5VNDoHEb8jksD6U7GWKGs0/img.jpg" alt="绘图" />

<b>图 3.</b> DID 估计器的图形表示

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/baZfWL/btruxkWbR0O/BLj2ugPKYbY8jGJzdbMZh0/img.png" alt="绘图" />

<br>

> ② 具有附加回归变量的模型（假设面板数据）**：**因为数据前后条件可能会发生变化

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/2XEcm/btruBbc9aUg/AsxZYGzN3Y77LL6LFyvpHk/img.png" alt="绘图" />

<br>

> ③重复截面数据的判据 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/IDEnr/btrusPvUEGd/tr3w2CxMG19uReoAITMbwk/img.png" alt="绘图" />

<br>

⑶ **方法2.** 工具变量回归 

> ① 第一<sup>第一</sup>。将 Z<sub>i</sub> 定义为随机对照实验中的回归变量

> ② 第二<sup>第二</sup>。 Zi 对于 Xi** 来说是一个很好的工具变量：** 满足工具相关性 

> ③ 第三<sup>第</sup>。意是兴趣的结果。

> ④ 第 4<sup></sup>。以 Z<sub>i</sub> 作为工具变量评估 X<sub>i</sub> 对 Y<sub>i</sub> 的影响 

⑷ **方法3.** 断点回归设计（RDD） 

> ①概述

>> ○ 如果设置阈值（截止）ω<sub>0</sub>，阈值附近的数据可能会相似

>> ○ 当阈值附近的数据进行不同处理时，以下差异完全可以看作是处理效果

>> ○ 这是一种非常流行的实验技术

>> ○ 缺点 **：** 很难将回归不连续性设计应用于异常值

> ② 锐回归间断设计

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ToNTQ/btruyOJxkHg/KvoklyZ5qM974jmT2QwK51/img.jpg" alt="绘图" />

<b>图 4.</b> 急剧回归不连续性设计

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bHupON/btrusOqgcmw/1dcSVdNj4BqGIlWwhQ3y8k/img.png" alt="绘图" />

<br>

> ③ 模糊回归间断点设计 

>> ○ 实验可能不会像锐回归不连续性设计中定义的 Xi 那样顺利进行测试

>> ○ 下面的工具变量 Zi 可以作为实际 Xi 上的一个很好的工具变量  

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/GnlXc/btruyMEXjQv/kBIBhc9PcT93qDFj9PeNI1/img.png" alt="绘图" />

<br>

⑸ 对内部有效性的威胁

> ① 未能随机化

>> ○ 不仅出现处理效果，还出现非随机分配效果

>> ○ 假设检验 **：** 使用 X<sub>i</sub> 对 W<sub>1i</sub>、···、W<sub>ri</sub> 的治疗前特征进行回归分析时，如果系数均为零，则该实验可视为随机实验 

>> ○ 示例 **:** 如果按姓名进行随机处理，则可能会优先将特定种族分配到处理组 

> ② 未能遵循治疗方案（部分依从）

>> ○ 定义 **：** 即使随机处理效果很好，受试者也可能无法很好地遵守协议

>> ○ 因此，X<sub>i</sub> 可以与 ui 关联

>> ○ 随机鼓励设计**：**如果以随机治疗为工具变量，并在工具变量回归下分析真实治疗，则可以识别部分依从性 

> ③自然损耗 

>> ○ 定义**：** 随机抽样后因与治疗相关的原因排除受试者

> ④ 无霍桑效应 

>> ○ 没有理由对准实验中的霍桑效应持谨慎态度**：**因为这是一个自然实验

> ⑤ 工具方差有效性 

>> ○ 可以通过数据评估仪器相关性 

>> ○ 即使工具变量看似随机分配，工具外生性也可能无法成立

>> ○ 示例**：** 即使研究人员希望根据抽签数查看收入，Xi 和 ui 也可能存在相关性，同时诱导少数人采取行动避免征兵 

⑹ 外部效度的威胁  

> ①非代表性样本 

> ②非代表性计划或政策 

> ③一般均衡效应 

⑺批评

> ①尝试在准实验中寻找好的变量

> ② 真正好的准实验并不多

<br>

<br>

## **6\.异质人群** 

⑴定义**：**回归线β<sub>0i</sub>、β<sub>1i</sub>的系数不是常数而是根据样本而变化的情况

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/dpUwtm/btruyN4VO9Z/9n8usQvSYqkt1ntrXbtUO0/img.png" alt="绘图" />

<br>

> ① β<sub>1i</sub> **:** X<sub>i</sub> 的异质效应

> ② 感兴趣的参数是 E(β<sub>1i</sub>) 

> ③ 如果 β<sub>1i</sub> 可观测，则可以使用使用交互作用的模型 

> ④ 若β<sub>1i</sub>不可观测，则分析如下

⑵ 最小最小二乘法 

> ① 假设 **:** X<sub>i</sub> 应该是随机的 → X<sub>i</sub> 和 (u<sub>i</sub>, β<sub>0i</sub>, β<sub>1i</sub>) 应该是独立的

>> ○ 实际中难以满足的条件

> ② 公式

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/0iPB8/btrupJwuw8Y/oH5ymVvZvu8V1pOeVMQaS1/img.png" alt="绘图" />

<br>

⑶ 工具变量估计（IV） 

> ① 假设 **:** Z<sub>i</sub> 应该是随机的 → Z<sub>i</sub> 和 (u<sub>i</sub>, v<sub>i</sub>, β<sub>0i</sub>, β<sub>1i</sub>, π<sub>0i</sub>, π<sub>1i</sub>) 应该是独立的

> ② 公式 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/ehj7gV/btruxjbV1q3/GfPLZmKOx7xB4Q3ACWfmEk/img.png" alt="绘图" />

<br>

>> ○ E(β<sub>1i</sub>π<sub>1i</sub>) / E(π<sub>1i</sub>) 称为局部平均治疗效果（LATE）

> ③均衡LATE和ATE的条件>> ○ **情况 1.** β<sub>1i</sub> = β<sub>1</sub> = 常数**：** 不需要异方差 

>> ○ **情况 2.** π<sub>1i</sub> = π<sub>1</sub> **:** 工具变量无异方差

>> ○ **情况 3.** β<sub>1i</sub> 和 π<sub>1i</sub> 是独立的 

> ④内涵

>> ○ 仪器外生性难以评估

>> ○ J-test 只能说明 LATE 之间的差异

<br>

---

*输入：2019.11.26 10:29*