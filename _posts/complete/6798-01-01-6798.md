## **第 20 章回归分析的方差分析**

高级类别：【统计】【统计概述】(https://jb243.github.io/pages/1641)

---

**1.** [简单线性回归分析的方差分析](#1-anova-of-simple-线性回归分析)

**2.** [ANCOVA](#2-ancova)

---

<br>

## **1.简单线性回归分析的方差分析** 

⑴ 问题情况

<br>

| **年龄（岁）** | **螨虫数量** |
| --- | --- |
| 3 | 5 |
| 6 | 13 |
| 9 | 16 | 16
| 12 | 12 14 | 14
| 15 | 15 18 | 18
| 18 | 18 23 | 23
| 21 | 21 20 |
| 24 | 32 | 32
| 27 | 27 29 | 29
| 30| 28 | 28

<b>表1.</b>简单线性回归分析的方差分析

<br>

⑵【t统计量】表(https://jb243.github.io/pages/1629#4-students-t-distribution) 

<br>

|因素|系数 |标准错误| t |意义 |
| --- | --- | --- | --- | --- |
|拦截| 5.733 | 5.733 2.265 | 2.265 2.531 | 2.531 0.035 | 0.035
|年龄 | 0.853 | 0.853 0.122 | 0.122 7.006 | 7.006 0.001 | 0.001

<b>表2.</b>t统计量表

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/qaY8u/btruArOaTEy/0ZCpvvtfB1kKkcUz4XPNoK/img.png" alt="绘图" />

<br>

⑶ F统计量表

<br>

|因素|平方和| df |均方 | F |意义 |
| --- | --- | --- | --- | --- | --- |
|回归| 539.648 | 1 | 539.648 | 49.086 | 49.086 < 0.001 |
|剩余 | 87.952 | 87.952 8 | 10.994 | 10.994   |   |
|总计 | 627.600 | 627.600 9 |   |   |   |

<b>表3.</b>F统计量表

<br>

> ①原假设H0 **：**回归线的斜率等于0 

> ②思路**：**如果回归的MS＞残差的MS，则回归线的斜率不为零 

> ③计算

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/bubOFP/btruuiksqjN/yYu1Xx53KMHZU8icUK9W20/img.png" alt="绘图" />

<br>

> ④回归线的自由度之所以为1**：**因为回归变量只有一个

⑷ F统计量比t统计量显示功效更大的原因**：** F统计量的p值较小 

> ① F统计量比t统计量使用更多的信息

> ② 由于样本量较大的影响，F 统计量显示出更大的功效

<br>

<br>

## **2\.协方差分析**

⑴概述

> ① 简单线性回归分析与单向方差分析融合的概念

> ②必要性**：**在实际问题情况下，由于一个因素的混杂效应，第二个因素发生变化，会影响因变量

> ③ 与双向方差分析的区别**：** ANCOVA 技术不与某些 ANOVA 技术竞争。 ANOVA 和 ANCOVA 可以同时进行

⑵ 问题情况

> ①自变量**：**是否为污染矿区

> ② 因变量**：** 大鼠器官中的铅浓度  

> ③混杂效应**：**年龄

⑶ 不考虑年龄的结果表

<br>

|因素|平方和|自由度|均方 | F 比 |
| --- | --- | --- | --- | --- |
|治疗 | SS治疗| k-1 | MS 处理 = SS 处理 / (k-1) | F = MS 治疗/MS 错误 |
|错误| SS 错误 | N-k | MS 误差 = SS 误差 / (N-k) |   |
|总和 | SS 总计 | N-1 |   |   |

<b>表 4.</b> 简单单向方差分析结果表 

<br>

> ①如果不控制年龄效应，残差变大

> ② 随着残差增大，MS Error增大，F比减小

> ③随着F比的降低，功效也降低**：**换句话说，很难证明治疗的意义

⑷ 假设

> ①同方差性

> ② 独立性

> ③常态

> ④ 协变量和因变量之间的关系应该是线性的

> ⑤ 并行度>> ○ 例如，计算每个污染矿区和非污染区的回归线时，斜率相同

>> ○ 满足并行性与没有交互是一样的 

>> ○ 如果不满足并行性，则比较一个选定值（例如年龄的总体平均值）的差异不能代表整个协变量范围

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/brB4tK/btruuhTn8KQ/3eyEJxEXfVL4vNJMKtATo0/img.png" alt="绘图" />

<b>图 1.</b> ANCOVA 中缺乏并行性的示例

<br>

>> ○ 在ANCOVA之前，应评估年龄和地区的相互作用以确认平行性

⑸ 程序

> ① 第一<sup>第一</sup>。确认年龄和铅浓度之间的相关性

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/uai28/btruxkhJECI/zfm8Z6V8UiD0kPSq2zS2hK/img.png" alt="绘图" />

<b>图 2.</b> 年龄与铅浓度之间的相关性

<br>

> ② 第二<sup>第二</sup>。证实年龄和地区的交互作用不具有统计显着性 

<br>

|因素|平方和|自由度|均方 | F 比 | p值|
| --- | --- | --- | --- | --- | --- |
|年龄 |   |   |   |   |   |
|网站 |   |   |   |   |   |
|年龄 × 地点 |   |   |   |   | NS |
|错误|   |   |   |   |   |
|总计 |   |   |   |   |   |

<b>表 5.</b> 结果表，包括交互项

<br>

> ③ 第三<sup>第</sup>。根据年龄计算铅浓度回归线 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/lwEbT/btrurUK6LS7/yEJt0CBDu6pVDUyYlKtSgk/img.png" alt="绘图" />

<b>图3.</b>铅浓度随年龄的回归线

<br>

> ④ 第 4<sup></sup>。根据第 3<sup>rd</sup> 步获得的回归线计算满足以下条件的两条回归线 

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/qGBlA/btruoL1fI1o/ja2KJAGjmYkZu7sbKceJ70/img.png" alt="绘图" />

<b>图 4.</b> 两条回归线的计算

<br>

>> ○ 对于从第 3<sup>rd</sup> 步骤获得的回归线，仅更改 y 截距，同时保持回归线的斜率 

>> ○ 最小化每个自变量水平的平方和  

> ⑤ 第 5<sup></sup>。计算第 4 步获得的每条回归线的残差

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/NIG8U/btruyNcVky5/igCFTYqZOaH2fKwJcklRWK/img.png" alt="绘图" />

<b>图5.</b>残差计算

<br>

> ⑥ 第六<sup>th</sup>。计算出整个组的平均年龄后，将该值的每条回归线的函数值指定为标准值

>> ○ 整个群体的平均年龄只是一个例子，它的值是多少并不重要。

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/cEWTR0/btrusODXKHy/vod2G1OQaYwPVXCmStmYq0/img.png" alt="绘图" />

<b>图6.</b>标准值的计算

<br>

> ⑦7<sup>th</sup>。将第 5 步向上和向下获得的残差标记为每个治疗组的标准值

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/9Ma6a/btruuhZ8heL/b8K1rYjeqJGo3fsx9XZ7k0/img.png" alt="绘图" />

<b>图 7.</b> 最终结果

<br>

> ⑧ 第 8<sup></sup>。最后，可以看到SS Error更小了**：** p值更小了

<br><img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/A7Ltz/btruxkhJ54F/wWYORXKekbWqnRz8qd4rc0/img.png" alt="绘图" />

<b>图。 8.结果对比

<br>

⑹ 结果

> ①修正结果

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/b0onRg/btruujcAD0s/WAoQZe3wsb4rPhqMl7dnak/img.png" alt="绘图" />

<b>图9.</b>污染矿区的铅浓度

<br>

<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https://blog.kakaocdn.net/dn/brVbM3/btrukfIAplr/CEPhfzsqzpvFkrmVj39tUk/img.png" alt="绘图" />

<b>图10.</b>非污染矿区铅浓度

<br>

> ② 修正前结果表

<br>

|因素|平方和|自由度|均方 | F 比 | p值|
| --- | --- | --- | --- | --- | --- |
|网站 | 320 | 320 1 | 320 | 320 2.74 | 2.74 0.115 | 0.115
|错误| 2100.8 | 2100.8 18 | 18 116.71 |   |   |
|总计 | 2420.800 | 19 | 19   |   |   |

<b>表6.</b>校正前结果表

<br>

> ③校正后结果表**：**可以从回归线计算年龄的平方和

<br>

|因素|平方和|自由度|均方 | F 比 | p值|
| --- | --- | --- | --- | --- | --- |
|年龄 | 1776.290 | 1776.290 1 | 1776.290 | 1776.290 93.054 | 93.054 < 0.001 |
|网站 | 1094.335 | 1 | 1094.335 | 57.329 | 57.329 < 0.001 |
|错误| 324.510 | 17 | 17 19.089 | 19.089   |   |
|总计 | 2420.800 | 19 | 19   |   |   |

<b>表7.</b>校正后结果表

<br>

> ④ 报告示例 **:** “平行性的初步分析表明，铅浓度线的斜率与年龄的关系没有显着差异（年龄 × 地点**:** F<sub>1,16</sub> = 0.00, NS）。随后的 ANCOVA 显示地点的显着影响（F<sub>1,17</sub> = 57.329，P < 0.001）以及协变量（年龄）的显着影响(F<sub>1,17</sub> = 93.054, P < 0.001) 矿区大鼠的铅含量高于对照组。

⑺ 未将污染矿区回归线y轴截距与其他区域回归线y轴截距进行比较的原因

> ①情况**：**如果满足并行性，比较y截距就容易多了 

> ② 比较 y 截距类似于比较样本组**只有一个样本**

> ③ 因为 ANCOVA 采用总误差项，ANCOVA 类似于比较具有**给定样本组大小两倍的元素**的样本组 

> ④ 因此，执行 ANCOVA 比简单比较 y 截距具有更高的功效

⑻ **应用1.** 2因素ANCOVA 

> ① 在分析2-way ANOVA时应用ANCOVA技术

> ② 示例**：**当自变量为性别和药物治疗，因变量为血压，混杂因素为年龄时  

⑼ **应用2.** 如果存在多个混杂因素  

> ①采用多元线性回归分析 

> ② 也可以使用【高级回归分析】(https://jb243.github.io/pages/1792)

<br>

--- 

*输入：2019.12.07 23:04*