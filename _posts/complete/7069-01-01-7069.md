## 设置 TensorFlow 环境并在 Python 中使用 Jupyter

推荐文章：【Python】【Python目录】(https://jb243.github.io/pages/786)

---

**1.** [概述](#1-概述)

**2.** [安装 Anaconda](#2-安装-anaconda)

**3.** [Anaconda 提示符 (anaconda3)](#3-anaconda-prompt-anaconda3)

**4.** [安装Jupyter](#4-installing-jupyter)

**5.** [共享 Anaconda 环境](#5-sharing-anaconda-environment)

---

<br>

## **1.概述**

⑴ TensorFlow、Keras 等是为了用 Python 实现人工神经网络而创建的。

⑵ 2017年起推出与R兼容的版本。

⑶ MacBook 自带终端，所以自然会安装这些。

⑷ 自 2020 年 9 月起，Anaconda 一直向员工超过 200 人的企业或政府组织的用户提供收费服务。

<br>

<br>

## **2.安装 Anaconda**

 ⑴ **Windows**

> ① **步骤1：** 安装网址：[www.anaconda.com/products/individual](https://www.anaconda.com/products/individual)

> ② **步骤2：** 下载及安装指南：[www.guru99.com/download-install-r-rstudio.html](https://www.guru99.com/download-install-r-rstudio.html)

> ③ **第3步：** 最后安装以下内容：

>> ○ Jupyter 笔记本（anaconda3）

>> ○ Anaconda 导航器 (anaconda3)

>> ○ Spyder (anaconda3)

>> ○ Anaconda PowerShell 提示符 (anaconda3)

>> ○ Anaconda 提示符（anaconda3）

 ⑵ **对于Linux**

⑵ **Linux**

> ① **步骤 1.** [Miniconda](https://docs.conda.io/en/latest/miniconda.html) **:**
从这里安装[Miniconda3 Linux 64位](https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh)

> ② **步骤1** - **方法1**

>> ○ **步骤 1.** 从[链接](https://docs.conda.io/en/latest/miniconda.html)下载文件 

>> ○ **步骤 2.** 将 `.sh` 文件移动到 Linux 中所需的目录：您可以使用 `cp`、`rsync`、`scp` 等命令

>> ○ `cp [OPTION] [SOURCE] [DESTINATION]`：复制并粘贴文件

>>> ○ `-r`：复制整个子目录和文件

>>> ○ `-p`：复制保留所有者、组、权限和时间戳信息

>> ○ `scp`：文件损坏的可能性很小

>>> ○ `scp -P **${port}** **${srcFile}** **${id}** @ **${destIP}** : **${destPath}**`

>>>> ○ `**${port}**`：目标端口号

>>>> ○ `**${srcFile}**`：要从源移动的文件的路径。示例：“~/Downloads/file.txt”

>>>> ○ `**${id}**`：目的地用户的ID

>>>> ○ `**${destIP}**`：目标 IP 地址。示例：#.#.#.# (IPv4)

>>>> ○ `**${destPath}**`：目标存储文件的目录地址。示例：~/DATA1/1.txt

>>> ○ [代码生成器](https://jb243.github.io/pages/2368#footnote_link_67_50)

>> ○ `rsync`（远程同步）：速度更快

>>> ○ `rsync --rsh=’ssh -p **${port}** ’ -avzhP **${srcFile}** **${id}**@**${destIP}** : **${destPath}**`

>>>> ○ `**${port}**`：目标端口号

>>>> ○ `**${srcFile}**`：要从源移动的文件的路径。示例：“~/Downloads/file.txt”

>>>> ○ `**${id}*`*：目的地用户的ID

>>>> ○ `**${destIP}**`：目的地的 IP 地址。示例：#.#.#.# (IPv4)

>>>> ○ `**${destPath}**`：目标位置存储文件的目录地址。示例：~/DATA1/1.txt

>>> ○ [代码生成器](https://jb243.github.io/pages/2368)

> ③ **步骤1** - **方法2**

>> ○ **步骤 1.** 从上面的链接复制 Miniconda3 Linux 64 位的下载链接

>> ○ **步骤 2.** 使用 `curl -o` 命令

>>> `curl -o my.sh "https://repo.anaconda.com/miniconda/Miniconda3-py38_23.3.1-0-Linux-x86_64.sh"`

> ④ **步骤2.** 执行`.sh`文件，处理`.sh`文件

>> ○ **文件执行**：要执行 `.sh` 文件，您可以执行 `./[My_File].sh`、`sh [My_File].sh` 或 `bash [My_File].sh`。

>> ○ **文件修改**：shell有两种，`zsh`和`bash`。

>>> ○ `$ vi script.sh`

>>> ○ `$ nano backup`>>> ○ `$ sudo apt-get install zsh`

>> ○ **授予权限**

>>> ○ 示例：$ `chmod +x run-md5sum.sh`

> ⑤ **步骤 3.** 运行 Miniconda .sh 文件并阅读条款和条件以继续安装。按 Enter 键继续。

> ⑥ **步骤4.** 响应许可协议：

>> ○ 在第一次提示时必须回答“是”。

> ⑦ **步骤 5.** 回答第二个“是”。

>> ○ 回答是否执行install init。

>> ○ 默认值为“否”，但选择“否”将阻止 `/bin/bash` 正常运行。

>> ○ 建议明确输入“是”。

> ⑧ **步骤 6.** 重新启动 Linux 系统或运行 `/bin/bash`。

>> ○ 如果 `/bin/bash` 无法正常运行或 `conda` 命令无法识别：

>> ○ **步骤1.** 检查conda 路径是否包含在您的PATH 中。

>>> ○ `echo $PATH | grep miniconda`

>>> ○ `export PATH="/root/miniconda3/bin:$PATH"`

>> ○ **步骤 2.** 重新加载 `~/.bashrc` 设置或启动新的 bash 会话。

>>> ○ `source ~/.bashrc`

>>> ○ `exec bash`

<br>

<br>

## **3。 Anaconda 提示 (anaconda3)**

 ⑴ **对于 Windows**

> ① 运行anaconda3：建议以管理员权限运行。

> ② 安装软件包并设置虚拟环境：虚拟环境是软件包的捆绑包，用于管理软件包版本。

<br>

__受保护_0__

<br>

 ⑵ **对于Linux**

> ① 在Linux中，一旦安装了conda，您可以很容易地看到它是否安装了名称前面的(base)。

> ② Base 是默认环境的名称，当安装新环境时，它会更改为不同的环境名称（见下文）。

> ③ 注意，环境存储在./miniconda3/envs/中。

 ⑶ 故障排除

> ① 避免在用户名或文件路径中使用韩文字符。

> ②（**可能**）**方法1：**使用英文用户名和文件路径创建一个新的用户帐户：设置→家庭和其他用户→将其他人添加到此电脑。

> ③（**不推荐**）**方法二：**更改用户名：[www.tabmode.com/windows10/win10-user-name-change.html#gsc.tab=0](https://www.tabmode.com/windows10/win10-user-name-change.html#gsc.tab=0)

>> ○ 使用此方法可能会导致“无法登录您的 Windows 帐户”问题。

> ④（**可能**）**方法3：** [AccountProfilerFixer.exe](https://www.carifred.com/apf/#overview): [m.blog.naver.com/dupen/222081638329](https://m.blog.naver.com/dupen/222081638329)

<br>

<br>

## **4。安装 Jupyter**

 ⑴ **步骤1.** 运行anaconda3并输入以下代码（参考链接：[wikidocs.net/25280](https://wikidocs.net/25280)）

<br>

__受保护_1__

<br>

 ⑵ **步骤2.** jupyter lab（可选）

<br>

__受保护_2__

<br>

> ① jupyter lab 目录管理方便。

> ② jupyter lab可以轻松上传、删除、重命名文件。

 ⑶ **步骤3.** 安装软件包（例如tensorflow）

<br>

__受保护_3__

<br>

> ① 笔者更喜欢按照上面的方式安装。

> ② 不过，安装tensorflow.keras而不是keras可能有利于版本管理。

⑷ **步骤4.** 安装jupyter ipykernel

<br>

__受保护_4__

<br>

> ① 将 JEONGBIN_ENV 替换为您的环境名称。

> ② 您可以通过此轻松更改已启动的 Jupyter Notebook 的环境。

> ③ Jupyter Notebook 中更改内核的按钮。

<br>

![图片](https://github.com/user-attachments/assets/c73b6ef8-d711-4d3c-afcf-9b1445d38b1c)

**图 1.** Jupyter Notebook 中用于更改内核的按钮。

<br>

⑸ **步骤 5.** 运行 Jupyter Notebook

> ① **步骤5-1.** 点击浏览器右上角的新建 → Python 3。

>> ○ 如果 Jupyter 中安装了 R，则**步骤 1** 中的 Python 3 下也会显示 R。

> ② **步骤5-2.** 输入代码→运行。

> ③ Jupyter Notebook 快捷键

>> ○ a：在当前单元格上方添加一个新单元格>> ○ b：在当前单元格下方添加新单元格

>> ○ z：撤消操作 

>> ○ Shift + 向上/向下箭头：选择多个连续单元格

>> ○ Command (⌘) + Enter：执行当前单元格

>> ○ Command (⌘) + f：查找字符串

>> ○ Command (⌘) + s：保存

<br>

<br>

## **5。共享 Anaconda 环境**

⑴ 环境文件（`.yml`）：最简单的方法

> ① **步骤1.** 提取环境文件：从名为JEONGBIN_ENV 的环境中提取`.yml` 文件。

<br>

__受保护_5__

<br>

> ② **步骤2.** 使用环境文件创建环境

<br>

__受保护_6__

<br>

> ③ **故障排除1.** 解决环境：失败。 ResolvedPackageNotFound：（[参考]（https://stackoverflow.com/questions/55554431/conda-fails-to-create-environment-from-yml））

>> ○ 看来在 Windows 中使用上述 conda 命令本质上会导致错误。

>> ○ **方法1.** 删除构建信息后执行。

>> ○ **方法2.** 删除平台特定版本标签后执行。

⑵ Docker：最推荐的方法

⑶ 粘合剂

⑷ `requirements.txt`：您可以使用 `pip list` 和 `pip freeze` 等命令列出软件包。这些包可以保存到 `requirements.txt` 文件中，以便稍后使用以下命令批量下载包。

> `pip install -r requirements.txt`

⑸ 设置.py

> ① `pip install .` 命令执行位于当前目录（.）中的 `setup.py` 文件来构建包。

> ② 构建好的包安装在Python的site-packages目录下。

> ③ 安装时，引用`setup.py`中的`install_requires`字段，自动安装依赖。

>> ○ `install_requires`：定义基本依赖项。

>> ○ `requirements.txt`：定义开发和测试的附加依赖项。

> ④ **示例 1.**

<br>

__受保护_7__

<br>

> ⑤ **示例 2.** `pip install PATH/TO/FILE/allendigger-1.0.tar.gz`

⑹ 通过 GitHub 存储库共享环境。

<br>

__受保护_8__

<br>

⑺ `README.md`：仅以纯文本形式表示规格。

⑻ 要运行 `.sh` 文件，可以使用 `./[My_File].sh`、`sh [My_File].sh` 或 `bash [My_File].sh` 来执行。

> __受保护_74__

⑼ `renv`：R 的依赖管理系统

⑽ `uv package` ：Uvicorn的依赖管理工具 

<br>

__受保护_9__

<br>

⑾`basilisk`：R包。支持 R-python 互操作性（[参考](https://bioconductor.org/books/release/OSTA/pages/bkg-python-interoperability.html#basilisk)）

⑿__受保护_78__

> ① 用C++编写，以取代日益笨重的conda。

> ② Anaconda 的经理。可以使用bioconda通道。适用于 Python、R。

> ③ **步骤1.** 创建conda环境，命名为MyENV 

>> `mamba create --yes --name MyENV --channel bioconda python=3.11`

> ④ **步骤2.** 将新环境添加到JupyterLab内核中

>> `~/.conda/envs/MyENV/bin/python -m ipykernel install --user —name=MyENV`

⒀ `SnakeMake`：基于Python的管道开发和工作流管理系统。

⒁ `Singularity`：像 Docker 这样的容器。

> ① 最初称为 Singularity 的容器运行时已更名为 Apptainer。

> ② `.sif` 文件指的是 Singularity 容器镜像文件。

> ③ **命令1.** 创建容器

>> ○ `singularity create container.img`

>> ○ Singularity Recipe 示例：它指定并包含安装软件、环境变量、文件和容器元数据。

<br>

__受保护_10__

<br>

> ④ **命令2.** 添加内容 

>> ○ `singularity import container.img docker://ubuntu`

>> ○ `sudo singularity bootstrap container.img Singularity`

> ⑤ **命令3.** 交互修改 

>> ○ `sudo singularity shell --writable container.img`

> ⑥ **命令4.** 执行容器 

>> ○ `singularity run container.img`

>> ○ `singularity shell container.img`

>> ○ `singularity exec container.img`⒂ 其他容器平台（[ref1](https://www.cloudzero.com/blog/docker-alternatives/)、[ref2](https://www.saashub.com/singularity-container-alternatives)、[ref3](https://octopus.com/blog/top-8-container-registries)、 [参考4](https://bluelight.co/blog/how-to-choose-a-container-registry)) 

> ① 豆荚人

> ② 卡尼科

> ③ RunC 构建套件

> ④ RKT

> ⑤ 重新注册

> ⑥ Vagrant ZeroVM

> ⑦ 容器化

> ⑧ DockerSlim

> ⑨ 红帽 OpenShift – Kubernetes、红帽 Quay 

> ⑩ 用户指导

> ⑪ HyScale

> ⑫ 詹金斯 

> ⑬ 构建

> ⑭ LXD

> ⑮ 鞭炮

> ⑯ Microsoft Azure 容器注册表

> ⑰ 匕首

> ⑱ 韦尔夫

> ⑲ SUSE 的 Rancher 桌面

> ⑳ Apache Mesos

> ㉑ VirtualBox

> ㉒ 亚马逊 ECR

> ㉓ 港口 

> ㉔ GitHub 容器注册表 

> ㉕ Google 容器注册表 

> ㉖ JFrog 容器注册中心 

> ㉗ Sonatype Nexus 存储库 OSS

> ㉘ GitLab 容器注册表

<br>

---

_输入**：** 2021.02.28 17:36_

_修改**：** 2023.05.22 15:04_