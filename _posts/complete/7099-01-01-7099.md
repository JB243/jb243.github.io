## **第 14-8 章。 Wilcoxon 等级检验**

推荐文章：【统计】第14章【统计测试】(https://jb243.github.io/pages/1631)

---

**1.** [概述](#1-概述)

**2.** [Wilcoxon 秩和检验](#2-wilcoxon-rank-sum-test)

**3.** [Wilcoxon 签名秩检验](#3-wilcoxon-signed-rank-test)

---

<br>

## **1.概述**

 ⑴ 单样本

> ① 参数检验：单样本T检验

> ② 非参数检验：符号检验、[Wilcoxon Signed Rank Test](https://jb243.github.io/pages/2099)

 ⑵ 两个样品（Paired Samples）：与单个样品基本相同

> ① 参数检验：配对样本T检验

> ② 非参数检验：符号检验、[Wilcoxon Signed Rank Test](https://jb243.github.io/pages/2099)

 ⑶ 两个样本（独立样本）

> ① 参数检验：独立样本T检验

> ② 非参数检验：【Wilcoxon Rank Sum Test】(https://jb243.github.io/pages/2099)

 ⑷ 方差分析

> ① 参数测试：[方差分析](https://jb243.github.io/pages/1635)

> ② 非参数检验：【Kruskal-Wallis 检验】(https://jb243.github.io/pages/1688)

 ⑸ 随机性

> ① 非参数测试：运行测试

 ⑹ 相关性分析

> ① 皮尔逊相关系数

> ②斯皮尔曼等级相关系数

<br>

<br>

## **2. Wilcoxon 秩和检验**

⑴ 概述

> ① 检验两个样本中位数的代表性非参数检验方法

> ② 使用两个样本的组合样本中的秩和进行检验的方法

> ③ **假设1.** 数据分布是连续且独立的

> ④ **假设2.** 关于数据分布的对称性假设

 ⑵ 第一<sup>第一</sup>。原假设和备择假设

> ①原假设H<sub>0</sub>：Δ=0。即两个总体的中位数相同

> ②备择假设 H<sub>1</sub>：Δ ＞ 0 或 Δ ＜ 0 或 Δ ≠ 0

 ⑶ 第二<sup>第二</sup>。设置显着性水平

 ⑷ 第三<sup>rd</sup>。检验统计量的计算

> ① **3-1.** 合并两个样本的数据并分配等级

> ② **3-2.** 将样本量较小的组的排名相加

>> ○ 如果样本量相等，可以选择其中一个

>> ○ 如果数据具有相同的值，则将这些数据集中分配一个代表等级

> ③ **3-3.** 计算如下

<br>

<img width="537" alt="스크린샷 2025-04-27 오후 10 37 41" src="https://github.com/user-attachments/assets/9a17c455-11e8-4528-a787-ea81a259ce15" />

<br>

>> ○ n<sub>1</sub>：较小组的样本量。应该是10个或更多

>> ○ n<sub>2</sub>：较大组的样本量。应该是10个或更多

>> ○ R：较小组的排名之和

> ④ 也称为 Mann-Whitney U 统计或 Mann-Whitney-Wilcoxon 秩和检验

<br>

<img width="445" alt="스크린샷 2025-03-28 12 03 45" src="https://github.com/user-attachments/assets/4e0a3545-096c-4dd7-8014-481957dc411d" />

<img width="483" alt="스크린샷 2025-04-27 오후 10 35 25" src="https://github.com/user-attachments/assets/0e055615-522e-492b-9789-6f6278a10827" />

<br>

 ⑸ 第四<sup>th</sup>。统计测试

⑹R代码

<br>

__受保护_0__

<br>

<br>

## **3。 Wilcoxon 签名等级测试**

 ⑴ 概述

> ① 用于检验单个样本的中位数或两个配对样本中位数的差异

> ② 不仅考虑差异的符号还考虑其相对大小的测试方法

> ③ **假设1.** 数据分布是连续且独立的

> ④ **假设2.** 关于数据分布的对称性假设

 ⑵ 第一<sup>第一</sup>。假设

> ① N：样本量

> ② 由于两组各有N条数据，所以总共有2N条数据

> ③ 配对比较假设：x<sub>1,i</sub> 和 x<sub>2,i</sub> 组成一对

> ④ H<sub>0</sub>: μ<sub>1</sub> - μ<sub>2</sub> = 0> ⑤ H1：μ<sub>1</sub> - μ<sub>2</sub> ≠ 0，μ<sub>1</sub> - μ<sub>2</sub> ＞ 0，或 μ<sub>1</sub> - μ<sub>2</sub> ＜ 0

 ⑶ 第二<sup>第二</sup>。计算<span>| x<sub>1,i</sub> - x<sub>2,i</sub> |</span> 和 sgn(x<sub>1,i</sub> - x<sub>2,i</sub>)

 ⑷第三.删除 <span>| 处的对x<sub>1,i</sub> - x<sub>2,i</sub> |</span> = 0 并将新样本大小定义为 N*

 ⑸ 第四<sup>th</sup>。按升序重新排列绝对差异并分配等级

> ① 对于具有相同值的数据，将这些数据集中分配一个代表等级

 ⑹第五<sup>th</sup>。检验统计量的计算

> ① **方法1.**

<br>

<img width="594" alt="스크린샷 2025-04-27 오후 10 38 08" src="https://github.com/user-attachments/assets/cbb85d74-e198-4c0f-89f5-f83cbc927b83" />

<br>

> ② **方法2.**

>> ○ w<sup>+</sup>：差异为正的数据的秩和

>> ○ w<sup>-</sup>：差值为负数的数据的秩和

>> ○ w<sub>s</sub> = min(w<sup>+</sup>, w<sup>-</sup>)

>> ○ 统计量的计算

<br>

<img width="190" alt="스크린샷 2025-04-27 오후 10 38 58" src="https://github.com/user-attachments/assets/f8c995fc-f21b-4c49-84d5-bd73a5907b2f" />

<br>

> ③ N*应为10或以上

⑺第六<sup>th</sup>。统计测试

⑻R代码

<br>

__受保护_1__

<br>

---

_输入时间：2021.05.10 09:13_