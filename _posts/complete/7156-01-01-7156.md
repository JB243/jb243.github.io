## R 中有用的主要函数的集合

高级类别：【RStudio】【R Studio索引】(https://jb243.github.io/pages/1761)、【生物信息学】【生物信息分析索引】(https://jb243.github.io/pages/836)

---

**1.** [概述](#1-概述)

**2.** [基础知识](#2-基础知识)

**3.** [文件I/O](#3-文件-i-o)

**4.** [向量和矩阵](#4-向量和矩阵)

**5.** [gsub](#5-gsub)

**6.** [统计分析](#6-统计分析)

**7.** [生物信息学](#7-生物信息学)

**8.** [绘图生成](#8-绘图生成)

---

**a.** [GitHub](https://github.com/JB243/nate9389/blob/main/RStudio/A_Collection_of_Useful_Functions_in_RStudio.R)（可执行.R文件）

**b.** [Python 中的有用函数](https://jb243.github.io/pages/1892)

---

<br>

## **1.概述**

⑴ 下面定义的函数可以如下调用。

<br>

__受保护_0__

<br>

> ① 但是，上述代码可能会出现以下问题。

> ② **问题1.** sum 错误 (dim(scRNaseqData): 缺少参数“b”，没有默认值

> ③ **问题2.** "do.call" r 参数"b"丢失，没有默认值

⑵ .R文件的使用方法如下： 

<br>

__受保护_1__

<br>

⑶ 下面定义的函数可以如下使用：

<br>

__受保护_2__

<br>

<br>

## **2.基础知识**

⑴ 检查数据类型

<br>

__受保护_3__

<br>

⑵ 一个函数，它在一个自然数前面填充几个零，得到总共五位数字。

<br>

__受保护_4__

<br>

⑶ 等待回车的函数。 （[参考]（https://stackoverflow.com/questions/15272916/how-to-wait-for-a-keypress-in-r））

<br>

__受保护_5__

<br>

⑷ 多重处理

<br>

__受保护_6__

<br>

⑸ %in% 运算符

<br>

__受保护_7__

<br>

<br>

## **3。文件输入/输出**

⑴ 检查目标文件夹是否存在

<br>

__受保护_8__

<br>

⑵ 检查目标文件夹是否有写权限

<br>

__受保护_9__

<br>

⑶ 在“destination.folder”下创建“Filtered_bams”文件夹

<br>

__受保护_10__

<br>

⑷ 读取`.gz`文件并解压缩的代码

<br>

__受保护_11__

<br>

<br>

## **4。向量和矩阵**

⑴ 将给定向量按a、b、c的顺序排序。

<br>

__受保护_12__

<br>

⑵ 给定字符串（given_str）是否包含特定字符串（partial_str）：grepl([参考](https://stackoverflow.com/questions/10128617/test-if-characters-are-in-a-string))

<br>

__受保护_13__

<br>

⑶ 包含来自给定字符串向量的特定字符串“str”的索引输出。

<br>

__受保护_14__

<br>

⑷ 三个向量的交集

<br>

__受保护_15__

<br>

⑸ 将给定向量的 NA 部分转换为零的函数

<br>

__受保护_16__

<br>

⑹ 排除给定向量的 NA 部分的函数

<br>

__受保护_17__

<br>

⑺ 用给定向量中的另一个元素替换特定元素的函数

<br>

__受保护_18__

<br>

⑻ 返回矩阵或数据框左上角的函数

<br>

__受保护_19__

<br>

⑼ 给定任意两个矩阵时输出 cbind 的函数

<br>

__受保护_20__

<br>

⑽ 给定任意两个矩阵时输出 rbind 的函数

<br>

__受保护_21__

<br>

⑾ 输出给定矩阵或数据框中的 A 行和 B 行的函数

<br>

__受保护_22__

<br>

⑿ 在给定矩阵或数据框中切换 A 列和 B 列的函数

<br>

__受保护_23__

<br>

<br>

## **5。 gsub**

⑴ 从给定字符串中删除连字符（-）的函数

<br>

__受保护_24__

<br>

⑵ 从给定字符串中删除“(”)等特殊符号的函数（[参考](https://stackoverflow.com/questions/49681952/removing-replacing-brackets-from-r-string-using-gsub)）

<br>

__受保护_25__

<br>⑶ 从给定字符串中删除 x 和 x 之后的所有字符的函数（[参考](https://www.tutorialspoint.com/how-to-remove-dot-and-number-at-the-end-of-the-string-in-an-r-vector)）

<br>

__受保护_26__

<br>

⑷ 删除 后面所有数字的函数。和 。来自给定字符串，对于“ABCD.123”

<br>

__受保护_27__

<br>

⑸ 从给定字符串中删除 x 和 x 之前的所有字符的函数

<br>

__受保护_28__

<br>

⑹ 给定字符串类型变量（'given_str'）中从头到尾用“x”填充字符并返回的函数

<br>

__受保护_29__

<br>

⑺ 用于收集给定字符串（'given_str'）内遵循特定模式的数字的代码

<br>

__受保护_30__

<br>

<br>

## **6。统计分析**

⑴ 10%到90%的百分位数代码

<br>

__受保护_31__

<br>

⑵ n!取log10得到的值！

<br>

__受保护_32__

<br>

⑶ 获取[二项式系数]的函数(https://nate9389.tistory.com/1221#footnote_link_67_52) <sub>n</sub>C<sub>k</sub>，即从n中选择k的情况数：改进代码，因为简单地使用阶乘就可以创建inf

<br>

__受保护_33__

<br>

⑷ 两组间t检验

<br>

__受保护_34__

<br>

⑸ 两组间ANOVA检验

<br>

__受保护_35__

<br>

⑹ 三组间ANOVA检验

<br>

__受保护_36__

<br>

⑺ 四组间ANOVA检验

<br>

__受保护_37__

<br>

⑻ 五组间方差分析检验

<br>

__受保护_38__

<br>

⑼ 六组间的ANOVA检验

<br>

__受保护_39__

<br>

⑽ 研究两个向量的FC、p值

<br>

__受保护_40__

<br>

⑾ 如何使用费舍尔效应检验检验两组的统计等价性（第 1 版）

<br>

__受保护_41__

<br>

⑿ 如何使用费舍尔效应检验检验两组的统计等价性（版本 2）

<br>

__受保护_42__

<br>

⒀ MIA 测定（富集）

<br>

__受保护_43__

<br>

⒁ MIA 测定（耗尽）

<br>

__受保护_44__

<br>

<br>

## **7.生物信息学**

⑴ 探索以特定关键词开头的基因

<br>

__受保护_45__

<br>

⑵ enembl_gene_id 与gene_symbol 之间的转换

> ①从ensembl.gene转换为gene.symbol

<br>

__受保护_46__

<br>

> ② 从 enembl.gene 转换为gene.symbol（使用表格）

>> ○ [ human_genes_36601.tsv ](https://blog.kakaocdn.net/dn/29YTj/btrS5iG9QOH/Di6RQKxHOPDii7EjkdHN30/ human_genes_36601.tsv?attach=1&knm=tfile.tsv)

>> ○ [mouse_genes_32285.tsv](https://blog.kakaocdn.net/dn/wkjwJ/btrS1QSgrpD/VS8ELANCQyeZAA3vL8JQP0/mouse_genes_32285.tsv?attach=1&knm=tfile.tsv)

<br>

__受保护_47__

<br>

> ③ 将gene.symbol转换为ensembl.gene

<br>

__受保护_48__

<br>

> ④ 从 gen.symbol 转换为 enembl.gen（使用表格）

<br>

__受保护_49__

<br>

> ⑤ 人类整体转录物到基因名称（[参考](https://support.bioconductor.org/p/106253/#106256)）

<br>

__受保护_50__

<br>

> ⑥ 小鼠基因转MGI符号（使用表格）

<br>

__受保护_51__

<br>

> ⑦ MGI符号转小鼠基因（使用表格）

<br>

__受保护_52__

<br>

> ⑧人类基因转HGNC符号（使用表格）

<br>

__受保护_53__

<br>

> ⑨ 人类基因的HGNC符号（使用表格）

<br>

__受保护_54__

<br>

> ⑩【人和小鼠以外的动物转化表】(https://nate9389.tistory.com/837)

⑶ Affymetrix 探针 ID、enembl_gen_id、gain_name

> ① 将Affymetrix探针ID转换为ensembl_gene_id、gene_name

<br>

__受保护_55__

<br>

⑷ 人和小鼠基因同源性

> ① 概述

>> ○ 人类基因有36601

>> ○ 小鼠体内有32285个基因。

>> ○ 人类和小鼠的基因几乎相同，但也有很多差异。

>>> ○ 因此，有必要知道如何将人类基因转化为小鼠基因，或者反之亦然。>>> ○ 很多情况下，小鼠基因并不是简单地将小鼠基因大写的人类基因。

> ② **方法1.** BiomaRt

<br>

__受保护_56__

<br>

>> ○ **属性1.** 确定MGI符号和HGNC符号的对应关系。

>> ○ **属性2.** 确定ENSMUSG码与ENSG码的对应关系。

>> ○ **属性3.** 确定NCBI增益ID与NCBI增益ID之间的对应关系。

>> ○ 对于每个属性，左边是鼠标的信息，右边是人物的信息。

>> ○ 目前不起作用：目前，已发现以下错误信息，且不起作用。

<br>

__受保护_57__

<br>

> ③ **方法2.** 使用[MGI网站](http://www.informatics.jax.org/homology.shtml)提供的[人鼠转换表](http://www.informatics.jax.org/downloads/reports/#:~:text=HOM_MouseHumanSequen)

>> ○ [HOM_MouseHumanSequence.csv](https://blog.kakaocdn.net/dn/cVeqsA/btrS1JMnxyX/HtVhPmqtxdgt7LQlGkeql0/HOM_MouseHumanSequence.csv?attach=1&knm=tfile.csv)

<br>

__受保护_58__

<br>

⑸ 染色体位置到hgnc_symbol

<br>

__受保护_59__

<br>

⑹ 基因名称到染色体位置：使用转换表([human](https://blog.kakaocdn.net/dn/lTbKq/btrWjlmGho8/eWwWHbfLOlVGKAVeuDMKt1/ human%20gene%20annotation.csv?attach=1&knm=tfile.csv), [鼠标](https://blog.kakaocdn.net/dn/clSwT7/btrWcrWmS41/mNLCUuBlQxfJFhG1U2JQNk/mouse%20gene%20annotation.csv?attach=1&knm=tfile.csv))

<br>

__受保护_60__

<br>

⑺ 基因名称描述

<br>

__受保护_61__

<br>

⑻ 基因名称转bioType

<br>

__受保护_62__

<br>

⑼ 更改[Seurat](https://jb243.github.io/pages/1788)对象对象基因的名称：需要创建一个新对象([参考](https://github.com/satijalab/seurat/issues/2617))

<br>

__受保护_63__

<br>

⑽ 更改集群信息 

<br>

__受保护_64__

<br>

⑾ `Idents` 允许您为所需的元数据编写 `FindAllMarkers` （[参考1](https://github.com/satijalab/seurat/issues/252)，[参考2](https://github.com/satijalab/seurat/issues/1314))

<br>

__受保护_65__

<br>

⑿ 重新排序 [Seurat](https://jb243.github.io/pages/1788) 对象的 `orig.ident` 图中的位置

<br>

__受保护_66__

<br>

⒀ 将 [Seurat](https://jb243.github.io/pages/1788) 对象 pbmc3k 保存为 h5ad ([参考](https://mojaveazure.github.io/seurat-disk/articles/convert-anndata.html))

<br>

__受保护_67__

<br>

> ① 生成的.h5ad文件可以在Python中使用以下代码打开

<br>

__受保护_68__

<br>

⒁ 将 [Seurat](https://jb243.github.io/pages/1788) 对象另存为 h5ad (ver.2)

> ① 自Seurat版本更新到5.0后，上述方法不再适用。

<br>

__受保护_69__

<br>

⒂ 当tissue_dir目录下有matrix.mtx、barcodes.tsv、features.tsv文件和spatial文件夹时，提供在R中读取Visium数据的代码。

<br>

__受保护_70__

<br>

⒃ 提供在R中读取.h5ad格式保存的Visium数据的代码。

<br>

__受保护_71__

<br>

⒄ 获取高变异基因的代码

<br>

__受保护_72__

<br>

⒅ [PCA](https://jb243.github.io/pages/2158#2-type-1-principal-component-analysis-pca)

<br>

__受保护_73__

<br>

⒆ [Kaplan-Meier 生存分析](https://jb243.github.io/pages/2087) 

<br>

__受保护_74__

<br>

<br>

## 8. 情节生成

⑴ 将图片存储为png的示例

<br>

__受保护_75__

<br>

⑵ 绘制散点图与给定 x 和 y 的斜率之间的置信区间的函数

<br>

__受保护_76__

<br>

⑶ 当给定 x、y 和颜色时绘制空间特征图的函数

<br>

__受保护_77__

<br>

⑷ 空间特征图

<br>

__受保护_78__

<br>⑸ 给定gene.list、log FC值向量和调整后的p value向量的增强火山图

<br>

__受保护_79__

<br>

⑹ 如何从基因列表中找到基因本体（GO）

<br>

__受保护_80__

<br>

⑺ 如何从基因列表中绘制基因本体论 (GO) 图 (<span style="background-color: #ef5369; color: #ffffff; font-family: Times New Roman;">▶</span> [如何解读 GO 图](https://www.youtube.com/watch?v=hS3tBs2T3Zk))

<br>

__受保护_81__

<br>

⑻ 如何从基因列表中绘制cnetplot

<br>

__受保护_82__

<br>

⑼ 小提琴图与统计分析

<br>

__受保护_83__

<br>

---

*输入：2022.05.03 00:13*