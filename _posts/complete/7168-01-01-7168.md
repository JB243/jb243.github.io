## **xFuse 的理解和执行**

推荐帖子**：** 【生物信息学】【生物信息学分析目录】(https://jb243.github.io/pages/836)

---

**1.** [概述](#1-概述)

**2\.** [**步骤 1.** 前向方案](#2-step-1-前向方案)

**3\.** [**步骤2.** 推断](#3-步骤2-推断)

**4\.** [**第 3 步.** 预测](#4-step-3-prediction)

**5.** [程序执行](#5-程序执行)

---

<br>

## **1\.概述**

⑴ 目的**：** 将低分辨率ST库转换为高分辨率ST库

> ① 根据 Visium 协议，斑点总数最多限制为 4992 **：** 可被视为分辨率明显较低

⑵ 背景理论

> ①【离散概率论】(https://jb243.github.io/pages/1626)

> ②【连续概率论】(https://jb243.github.io/pages/1627)

> ③ [CNN](https://jb243.github.io/pages/2152)（卷积神经网络）

⑶ 假设

> ① I **:** 假设服从高斯分布

> ② X **:** 假设服从负二项分布

<br>

<br>

## **2** **。步骤 1.** **转发方案**

⑴ **变量1.** 输入图像数据

> ① n **:** 代表每个点的变量

> ② **:**中各切片n的组织学图像数据

> ③ (x,y) **:** 像素坐标

> ④ c **:** 图像通道

⑵ **变量2.** 输入ST数据

> ① n **:** 代表每个点的变量

> ② Xn **:** 每个剖面n的空间表达数据

> ③ 米 **:** 元基因

⑶ **变量 3.** 输出

> ① sn **:** 像素级缩放因子

> ② **:** 元基因活性

> ③ μn **:** 图像分布平均值

> ④ σn **:** 标准差

> ⑤ X **:** 对观察到的表达 X̃ 的超分辨表达

⑷ **变量 4.** 型号

> ① G **:** 卷积生成网络，设计类似U-net

> ② Z **:** 潜伏组织状态

> ③ θ **:** 可学习参数

> ④ rngxy **:** 每个 n、g、x 和 y 停止前的失败次数

> ⑤ png **:** 每个n和g的成功概率

> ⑥ L **:** 权重矩阵

> ⑦ tg, ug **:** 基因特异性基线

> ⑧ E、F **：** 固定效果以控制条件批量效果

> ⑨ βn **:** 连接指示变量的行向量

⑸ 配方

> ① 方程 9 连接超分辨表达式 X 和观察到的表达式 X̃

<br>

<br>

## **3** **。步骤 2. **推论**

⑴定义**：**用观测表达式X̃和图像I确定Zn、L、E、F的过程

⑵ 变量定义

> ① φ **:** 变分参数

> ② R **：** 卷积识别网络，设计类似U-net

> ③ hφ **:** 适当的平移和尺度变换

⑶ 配方

> ① φ 是通过最小化后验的 Kullback-Leibler 散度从变分分布 qφ 获得的

> ② L **:** 目标函数

>> ○ 通过蒙特卡罗抽样计算

>> ○ 这个L也称为ELBO（证据下界）

> ③更新参数时使用Adam优化器

<br>

<br>

## **4。步骤 3. **预测**

⑴ 定义**：**使用训练好的模型预测具体统计量的过程

⑵ 变量定义

> ① χ **:** 数量不同

> ②｛A1,···,AK｝ **:**任意定义的区域

> ③ νk **：** 特定定义区域 Ak 中的空间基因表达，与其在给定概率分布中的平均值相关

> ④ Xk **:** 特定定义区域 Ak 中的读取计数，与其在给定概率分布中的观测值相关

> ⑤ ηg **:** A1、A2 获得的基因的差异基因表达

>> ○ 考虑标准化和对数转换

⑶ 配方

<br>

<br>

## **5** **。程序执行**（基于RTX3090）

<br>

<br>

---

_输入**：** 2022.01.11 09:28_