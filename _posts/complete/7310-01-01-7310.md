## **第 14-7 章。柯尔莫哥洛夫-斯米尔诺夫检验**

推荐帖子：【统计】第14章【统计测试】(https://jb243.github.io/pages/1631)

---

**1.** [一般柯尔莫哥洛夫-斯米尔诺夫检验](#1-general-kolmogorov-smirnov-test)

**2.** [参数柯尔莫哥洛夫-斯米尔诺夫检验](#2-参数-柯尔莫哥洛夫-斯米尔诺夫-检验)

**3.** [Cramér–von Mises 测试](#3-cramér–von-mises-test)

**4.** [柯尔莫哥洛夫-斯米尔诺夫二样本检验](#4-柯尔莫哥洛夫-斯米尔诺夫-二样本检验)

**5.** [柯尔莫哥洛夫-斯米尔诺夫独立性测试](#5-柯尔莫哥洛夫-斯米尔诺夫独立性测试)

---

<br>

## **1\.一般柯尔莫哥洛夫-斯米尔诺夫检验**

⑴ 定义样本（即经验）分布函数如下： 阶跃函数形式

<br>

<img width="204" alt="스크린샷 2025-03-23 오후 7 04 03" src="https://github.com/user-attachments/assets/127eccab-122d-485d-a2ca-1d28e88f2564" />

<br>

⑵ 双边 Kolmogorov-Smirnov 检验当跟随值较大时拒绝原假设

<br>

<img width="205" alt="스크린샷 2025-03-23 오후 7 04 24" src="https://github.com/user-attachments/assets/3107d9b5-1eb3-4c28-bdb9-2d31a271eea9" />

<br>

<img width="358" alt="스크린샷 2025-03-28 오전 12 44 02" src="https://github.com/user-attachments/assets/e7d2820c-be03-4cfb-ae2c-86c007c2148d" />

**图 1.** Kolmogorov-Smirnov 检验统计量

<br>

⑶原假设

> ① D 的零分布不依赖于 F<sub>0</sub>（假设是连续的），这针对各种样本大小 n 总结在表格中

> ② 换句话说，零假设是两个概率分布 F̂ 和 F<sub>0</sub> 相同。

⑷ **理论**：在原假设下，√n D 渐近（n→∞）服从布朗桥最大绝对值分布

⑸ **模拟**：可以通过蒙特卡罗模拟计算p值

> ① 实际中，由于零分布下D的分布不依赖于F<sub>0</sub>，因此每个样本量只需要执行一次

> ② 例如F<sub>0</sub>可以设置为Unif(0, 1)

<br>

<br>

## **2\.参数柯尔莫哥洛夫-斯米尔诺夫检验**

⑴ 检验统计量定义如下

<br>

<img width="304" alt="스크린샷 2025-03-23 오후 7 05 13" src="https://github.com/user-attachments/assets/647fbe73-3712-4c08-a60c-8151f540ba34" />

<br>

⑵ p值通常通过参数引导程序来估计：这里，F̂和θ̂是针对每个引导程序样本重新计算的

⑶ 当𝒢是正态分布族时：即测试给定的分布是否服从正态分布时（**正态性检验**）

<br>

<img width="263" alt="스크린샷 2025-03-23 오후 7 05 36" src="https://github.com/user-attachments/assets/84fe675e-e9f3-4611-b2b3-b22208ace593" />

<br>

> ① 此检验通常称为 **Lilliefors 正态性检验**

> ② 上述检验统计量可以针对族内的所有分布进行调整，这是通过蒙特卡洛模拟进行的

> ③ 因此，这个检验统计量的零分布总结在一个表格中

> ④ R 代码：`ks.test(dat, "pnorm", mean=mu, sd=sigma)`

⑷ 同样的逻辑适用于其他**位置规模族**的分布

<br>

<img width="302" alt="스크린샷 2025-03-23 오후 7 06 15" src="https://github.com/user-attachments/assets/83863e89-e164-42ff-9136-43a74ca5157f" />

<br>

> ① 这里，G<sub>0</sub> 是在实数集 ℝ 上定义的给定分布

> ② 位置：平均值、中位数、分位数/百分位数等

> ③ 量表：标准差、中位绝对差等 

<br>

<br>

## 3. 克拉梅尔-冯·米塞斯测试

⑴ 柯尔莫哥洛夫-斯米尔诺夫检验的一种变体  

⑵ 当以下值较大时，Cramér-von Mises 检验拒绝原假设：  

<br><img width="304" alt="스크린샷 2025-03-23 오후 7 22 15" src="https://github.com/user-attachments/assets/69588826-35bd-4c9f-99a1-464f249662b0" />

<br>

> ① f<sub>0</sub>(x) = dF<sub>0</sub>(x)/dx 是原假设下的概率密度函数（PDF）。

> ② 与MSE（均方误差）类似地制定方程。

⑶ 这有一个简单的封闭式表达式，不需要积分：  

<br>

<img width="342" alt="스크린샷 2025-03-23 오후 7 23 03" src="https://github.com/user-attachments/assets/12bce11b-33a7-46f1-946b-2692a13aa8e6" />

<br>

> ① 这里，X<sub>(1)</sub> ≤ ⋯ ≤ X<sub>(n)</sub> 是有序样本，称为有序统计量。

> ② D 的零分布不依赖于 F<sub>0</sub>，已制成表格。

> ③ 渐近零分布也是已知的，但比较复杂。

> ④ 因此，可以使用蒙特卡罗模拟来计算 p 值。

<br>

<br>

## 4. Kolmogorov-Smirnov 二样本检验

⑴ (单方面的) Kolmogorov-Smirnov 检验拒绝较大的值 

<br>

<img width="242" alt="스크린샷 2025-03-27 12 30 27" src="https://github.com/user-attachments/assets/657533c6-3a31-44ea-b1d8-41d919b9c623" />

<br>

⑵ **理论**

> ① 利用一些递推公式可以准确有效地计算出 D<sub>m,n</sub><sup>+</sup> 的分布。

> ② 在大样本限制下 

<br>

<img width="503" alt="스크린샷 2025-03-27 12 31 50" src="https://github.com/user-attachments/assets/74832fa7-94da-452d-a3d0-b17371756fb8" />

<br>

> ③ 这恰好是与样本量 ⎣ mn / (m+n) ⎦ 的单样本情况相同的极限分布。

<br>

<br>

## **5。柯尔莫哥洛夫-斯米尔诺夫独立性测试**

⑴ 概述

> ① 本着柯尔莫哥洛夫-斯米尔诺夫检验的精神，Hoeffding (1948) 以及后来的其他人提出了基于经验 CDF 的独立性检验。 

> ② **特征 1.** 如果 X 和 Y 连续，则检验是无分布的。渐近分布也以封闭形式已知。

> ③ **特征 2.** 该测试与独立性的任何替代方案普遍一致。 

⑵ 统计 

<br>

<img width="304" alt="스크린샷 2025-04-14 오후 11 57 09" src="https://github.com/user-attachments/assets/facb6eaa-9f9a-444e-be6e-a61270d06ac0" />

<br>

> ①原假设H<sub>0</sub>：两个随机变量是独立的。

> ② 对于较大的 H 值，测试会被拒绝。

> ③ F<sub>n</sub><sup>X</sup> 是 X<sub>1</sub>、…、X<sub>n</sub> 的经验 CDF。

> ④ F<sub>n</sub><sup>Y</sup> 是 Y<sub>1</sub>、…、Y<sub>n</sub> 的经验 CDF。

> ⑤ F<sub>n</sub><sup>XY</sup> 是 (X<sub>1</sub>, Y<sub>1</sub>), ···, (X<sub>n</sub>, Y<sub>n</sub>) 的联合经验 CDF。

<br>

<img width="306" alt="스크린샷 2025-04-15 12 01 33" src="https://github.com/user-attachments/assets/588fbcf5-af83-4194-8d76-b40119980e26" />

<br>

---

_输入：2025.03.23 18:32_