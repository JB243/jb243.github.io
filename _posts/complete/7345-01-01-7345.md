## **R 大调故障排除 [21-40]**

推荐文章：【R STUDIO】【R Studio目录】(https://jb243.github.io/pages/1761)

---

<br>

#### **21\。错误：找不到函数“% >%”**

 ⑴（**package**）解决方案（[ref](https://community.rstudio.com/t/r-studio-error-gather-function/71041)）

__受保护_0__

<br>

<br>

#### **22\. is.empty(.) 中的错误：找不到函数“is.empty”**

 ⑴（**封装**）解决方案

__受保护_1__

<br>

<br>

#### **23\. fill_palette(palette = "npg") 中的错误：找不到函数“fill_palette”**

 ⑴（**封装**）解决方案

__受保护_2__

<br>

<br>

#### **24\.错误：dyn.load（文件，DLLpath = DLLpath，...）中的“Seurat”包或命名空间加载失败：无法加载共享对象“/opt/conda/lib/R/library/igraph/libs/igraph.so”：libglpk.so.40：无法打开共享对象文件：没有这样的文件或目录**

 ⑴ (**package**) 原因：在Ubuntu等Linux服务器上设置RStudio服务器并尝试下载Seurat包时会出现此问题。

 ⑵（**封装**）解决方案

__受保护_3__

 ⑶ 详细说明

> ① `sudo apt update`：解决“E：无法找到软件包”问题（[ref](https://itsfoss.com/unable-to-locate-package-error-ubuntu/)）

> ② `sudo apt install libglpk40`**:** 安装 libglpk.so.40，因为它丢失了 ([ref](https://r.igraph.org/articles/installation-troubleshooting#libglpk-so-40-cannot-open-shared-object-file-no-such-file-or-directory))

> ③ `remove.packages('rlang'), install.packages('rlang'), install.packages('lifecycle')`：解决“错误：‘Seurat’的包或命名空间加载失败...”问题（[ref](https://community.rstudio.com/t/rlang-error-on-rstudio-2020-error-package-or-namespace-load-failed-for-in-loadnamespace/79768)）

<br>

<br>

#### **25\。之前的 R 会话由于意外崩溃而异常终止。由于这次崩溃，您可能丢失了工作区数据。作为预防措施，RStudio 可能没有恢复之前活动的项目。您可以使用“项目”菜单切换回它。**

 ⑴（**系统**）原因：资源不足

<br>

<br>

#### **26\。 if (all(cur_arg < 0)) { 中的错误：缺少 TRUE/FALSE 需要的值**

 ⑴（**语法**）问题场景：执行`SaveH5Seurat(object, filename = "myData.h5Seurat")`后，尝试使用`Convert("myData.h5Seurat", dest = "h5ad")`时，出现此错误信息。

 ⑵（**语法**） 原因：当尝试访问`object@assays$RNA@data` 和`object@assays$RNA@scale.data` 中行名为NM_001001130.3 的矩阵，并尝试为行名为NM-001001130.3 的Seurat 对象强制输入具有相同行名的矩阵时，会出现此错误。

 ⑶（**语法**）解决方案：使用`gsub("_", "-", str)`将NM_001001130.3替换为NM-001001130.3。

<br>

<br>

#### **27\.错误：dyn.load（文件，DLLpath = DLLpath，...）中的“hdf5r”包或命名空间加载失败：无法加载共享对象“/opt/conda/lib/R/library/hdf5r/libs/hdf5r.so”：libhdf5_serial_hl.so.100：无法打开共享对象文件：没有这样的文件或目录**

 ⑴（**封装**）解决方案

__受保护_4__

 ⑵ [参考](https://stackoverflow.com/questions/48965309/h5py-import-error-on-libhdf5-serial-so-100)

<br>

<br>

#### **28。 V(G) 中的错误：找不到函数“V”**

⑴（**封装**）解决方案

<br>

__受保护_5__

<br>

<br>

#### **29。 .subscript.2ary(x, i, j, drop = TRUE) 中的错误：下标超出范围**

⑴（**包**）情况：`br.sp_subset <- subset(br.sp, features = top_genes[valid_genes])`

⑵（**包**） **解决方案1.**：将Seurat从5降级到4。

> __受保护_19__

⑶ (**package**) **解决方案 2.** Seurat v5 中子集的语法更改

<br>

__受保护_6__

<br>

<br>#### **30。 (function (A, nv = 5, nu = nv, maxit = 1000, work = nv + 7, reorth = TRUE, 中的警告：您计算的总奇异值的百分比太大，请改用标准 svd。 irlba::irlba(Matrix::t(preproc_res), nv = min(num_dim, min(dim(FM)) - ): 函数中出现错误“Matrix”包未提供“as_cholmod_sparse”**

⑴（**包**）问题情况：`cds1 <- preprocess_cds(cds1, method='LSI')`

⑵（**package**）解决方案：重新定义preprocess_cds（[ref](https://github.com/cole-trapnell-lab/monocle3/blob/master/R/preprocess_cds.R)）。其他必要的函数在[ref1](https://rdrr.io/github/cole-trapnell-lab/monocle3/src/R/identity.R)、[ref2](https://rdrr.io/github/cole-trapnell-lab/monocle3/src/R/utils.R)中定义， [参考3](https://rdrr.io/github/cole-trapnell-lab/monocle3/src/R/zzz.R)，[参考4](https://rdrr.io/github/cole-trapnell-lab/monocle3/src/R/nearest_neighbors.R)。

<br>

__受保护_7__

<br>

> ① 您可以像这样简单地调用上述函数。

>> `source("https://github.com/JB243/nate9389/blob/main/RStudio/preprocess_cds_and_as_cholmod_sparse.R?raw=true")`

<br>

<br>

#### **31。警告：找不到与提供的搜索模式匹配的图层 FetchData.Assay5(object = object[[DefaultAssay(object = object)]], 中出现错误：在对象中找不到图层“data”**

⑴（**语法**）原因：对于Seurat版本5，需要单独规范化以防止`SpatialFeaturePlot`中出现错误。

⑵（**语法**）解题方法：

<br>

__受保护_8__

<br>

<br>

#### **32。 fill_alpha 错误（data$fill %||% "black", data$alpha)：找不到函数“fill_alpha”**

⑴ (**package**) 问题**：**进行`SpatialDimPlot(tnbc.merge, label = TRUE, label.size = 3)`时出现错误。

⑵（**包**）解决方案**：**将`ggplot2 3.4.4`更新为`ggplot2 3.5.0`。

⑶ [参考](https://stackoverflow.com/questions/78236833/show-error-message-fill-alpha-cant-find) 

<br>

<br>

#### **33。数据层未连接。请运行 JoinLayers**

⑴（**语法**）问题**：** `FindAllMarkers(tnbc.merge, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25)`

⑵（**语法**）解决办法**：**执行完`tnbc.merge =  JoinLayers(tnbc.merge)`后，运行上面的代码。 

⑶ [参考](https://satijalab.org/seurat/articles/seurat5_integration) 

<br>

<br>

#### 34. 使用环境变量 GITHUB_PAT 中的 github PAT。如果您想使用更安全的 git 凭证存储，请使用 `gitcreds::gitcreds_set()` 并在 .Renviron（或其他地方）中取消设置 GITHUB_PAT。错误：无法从 GitHub 安装“未知包”：HTTP 错误 401。凭据错误 剩余速率限制：59/60 速率限制重置时间：2024-05-30 17:44:43 UTC

⑴（**语法**）解决办法：如果执行`Sys.getenv("GITHUB_PAT")`时有指定的东西，则运行`Sys.unsetenv("GITHUB_PAT")`删除该环境设置。 （[参考]（https://stackoverflow.com/questions/70908295/failed-to-install-unknown-package-from-github））

<br>

<br>

#### 35. if (tools::file_ext(filename) == "parquet") { 中的错误：条件长度 > 1

⑴（**Package**）问题：使用Seurat::Load10X_Spatial时出现错误。

⑵（**软件包**）解决方案：将Seurat从版本`5.1.0`降级到版本`5.0.1`。

<br>

<br>

#### 36. 在 RStudio 服务器上设置 gpsFISH 时安装 rjson 和 RcppParallel 时出现问题

⑴（**封装**）解决方案 

<br>

__受保护_9__

<br>

<br>

#### 37. 找不到函数“str_detect”

⑴（**包**）解决方案：`library(stringr)`

<br>

<br>

#### 38. log_info(msg) 中的错误：找不到函数“log_info”

⑴（**包**）解决方案：`library(logger)`

<br>

<br>

#### 39. activate(.,nodes) 中的错误：找不到函数“activate”

⑴（**包**）解决方案：`library(tidygraph)`

<br>

<br>

#### 40。！找不到函数“logSumExp”

⑴（**包**）解决方案：`library(matrixStats)`

<br>

---

_输入：2023年6月9日15:38_

_修改时间：2023年12月16日 12:29_