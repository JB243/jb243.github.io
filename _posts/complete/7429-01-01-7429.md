## **了解 COMMOT**

推荐阅读：【生物信息学】【生物信息分析索引】(https://jb243.github.io/pages/836)

---

**1.** [概述](#1-概述)

**2.** [理论](#2-理论)

**3.** [结果](#3-结果)

**4.** [讨论](#4-讨论)

**5.** [实现](#5=实现)

---
 
苍，Z.等人。 （2023）。自然方法，20(2), 218-228。 （[参考]（https://www.nature.com/articles/s41592-022-01728-4））

---

<br>

<p><iframe src="https://www.youtube.com/embed/OSuYM5OGorc" width="852" height="480"frameborder="0"allowfullscreen=""></iframe></p>

<br>

## **1.概述**

⑴ **CCC**（细胞间通讯）

> ① 对于理解生物异质性的重要意义：细胞命运决定、细胞分化模式、病理机制

> ② 多种形式：配体-受体相互作用、细胞-细胞相互作用、器官水平相互作用（例如胰岛素）、生物体水平相互作用（例如信息素）

> ③临床生物标志物：ICI（免疫检查点抑制剂）、组织再生研究

>> ○ 示例：APAP 诱导的 AKI（急性肝损伤）组织中坏死性凋亡相关的肝细胞和巨噬细胞相互作用显着增加

<br>

<img width="504" alt="스크린샷 2025-04-05 9 16 13" src="https://github.com/user-attachments/assets/606bd303-8d73-4529-9f69-e951a1ab5a87" />

**图1.** 组织再生研究示例

<br>

⑵【现有CCC分析算法】(https://jb243.github.io/pages/841)

> ① **基于批量 RNA 测序**：BulkSignalR、squidpy、IPA、Omnipath

> ② **基于 scRNA-seq**：CellTalkDB、CellPhoneDB、CellChat、ICELLNET、NicheNet、SoptSC、CytoTalk、scTensor、CCCExplorer、Connectome、Ramilowski、FlowSig、scSeqComm

> ③ **基于空间转录组学 (ST)**：Giotto、spata2、CellPhoneDB v3、stLearn、SVCA、MISTy、NCEM、COMMOT、SCOTIA、STOPover、cytosignal、SpatialDM、SpaTalk、stMLnet、HoloNet、DeepLinc

<br>

<img width="665" alt="스크린샷 2025-04-05 9 16 49" src="https://github.com/user-attachments/assets/be05af04-9ce8-4fd6-93b6-2cd29a4b42ec" />

**图 2.** 使用 ST 的 CCC 分析算法示例

<br>

>> ○ **Giotto**：构建空间邻近图以识别通过膜结合配体-受体对的相互作用

>> ○ **CellPhoneDB v3**：限制与同一空间定义的微环境中细胞簇的交互

>> ○ **stLearn**：将配体和受体基因的共表达与细胞类型的空间多样性相关联

⑶ 通讯

> ①必要性：现有方法无法处理多物种相互作用

>> ○ 多种配体类型可以结合多种受体类型，导致竞争

>> ○ 72%的配体和60%的受体结合多种类型

<br>

<img width="608" alt="스크린샷 2025-04-05 9 17 27" src="https://github.com/user-attachments/assets/4adf272d-5527-417f-87aa-8cb638e4bba7" />

**图3.** 多物种相互作用的竞争模拟

<br>

> ② 需要【OT】(https://jb243.github.io/pages/2386)（最优传输）

>> ○ OT 被定义为从源头（供应）到目的地（需求）优化分配资源的方法

>> ○ 这个概念在经济学、物理学、天文学、计算机科学等领域都有研究。

>> ○ 多物种相互作用需要数值分析，而基因表达从配体到受体的分布过程类似，因此需要OT

<br>

<img width="419" alt="스크린샷 2025-04-05 9 17 46" src="https://github.com/user-attachments/assets/9a0c7fa9-af59-42e1-9de2-06ab9f61d325" />

**图 4.** OT 与移动沙堡的类比

<br>

<br>

## **2.理论**

⑴ OT的问题定义

<br>

<img width="616" alt="스크린샷 2025-04-05 9 18 09" src="https://github.com/user-attachments/assets/b38afa14-4068-4d54-82f4-167da32d830a" />**图 5.** OT 的问题定义

<br>

> ① 可用于一种配体与一种受体之间的相互作用

> ② 为了应用于多物种相互作用，问题需要重新表述为COT

⑵ COT（集体OT）的问题定义

<br>

<img width="406" alt="스크린샷 2025-04-05 9 18 27" src="https://github.com/user-attachments/assets/2cf2ebc0-d59d-4c02-83c4-55b11bf561b5" />

**图 6.** COT 的问题定义

<br>

> ① 运输方案 **P** ε ℝ<sub>+</sub><sup>n<sub>l</sub>×n<sub>r</sub>×n<sub>s</sub>×n<sub>s</sub></sup>

>> ○ n<sub>l</sub>: 配体数量

>> ○ n<sub>r</sub>: 受体数量

>> ○ n<sub>s</sub>：斑点或细胞的数量（如果是单细胞 ST）

> ② 理想情况下， Σ<sub>j</sub> Σ<sub>l</sub> P<sup>(i,j)</sup>(k,l) = α<sub>i</sub>(k), Σ<sub>i</sub> Σ<sub>k</sub> P<sup>(i,j)</sup>(k,l) = β<sub>j</sub>(l)

>> ○ 然而，在嘈杂的数据中，这个假设可能不成立

>> ○ 相反，定义无法解释的配体和受体数量 **μ**、**ν** 并通过惩罚它们来解决优化问题

 ⑶ COT问题解决总结

<br>

<img width="532" alt="스크린샷 2025-04-05 오후 9 21 11" src="https://github.com/user-attachments/assets/91a2d27f-6a3f-4b97-a75d-1f826099fb8b" />

<br>

⑷ **步骤 1.** 将空间截止应用于成本函数 C，仅将空间上邻近的相互作用视为有效

<br>

<img width="513" alt="스크린샷 2025-04-05 9 21 31" src="https://github.com/user-attachments/assets/0c0a7c72-60aa-42af-bf6a-dc6633b55396" />

 **图 7.** 使用空间信息的成本函数

<br>

 ⑸ **步骤2.** 将_F_(·)项表示为香农熵项和L2正则项

<br>

<img width="494" alt="스크린샷 2025-04-05 오후 9 21 52" src="https://github.com/user-attachments/assets/e4b44000-1e09-435d-803e-e6c77f6bbb61" />

<br>

 ⑹ **步骤3.** 应用[拉格朗日乘子法](https://jb243.github.io/pages/1813)

> ① 拉格朗日乘子原理

<br>

<img width="403" alt="스크린샷 2025-04-05 오후 9 22 09" src="https://github.com/user-attachments/assets/36fc384d-7ffb-4422-9988-24685529900a" />

 **图8.** 拉格朗日乘子原理

<br>

> ② 拉格朗日乘子示例

<br>

<img width="600" alt="스크린샷 2025-04-05 9 22 29" src="https://github.com/user-attachments/assets/0d2325be-8821-4961-a342-98ad1d6bf4e4" />

**图 9.** 拉格朗日乘子示例

<br>

> ③ **步骤3-1.** 在拉格朗日公式中引入额外的线性变量

<br>

<img width="553" alt="스크린샷 2025-04-05 오후 9 22 52" src="https://github.com/user-attachments/assets/b420e228-9064-4e59-a2fb-49fe5fd11e01" />

<br>

> ④ **步骤 3-2.** 拉格朗日方法的首次应用：首先应用于 9 个变量中的 5 个，因为很难一次应用全部

<br>

<img width="577" alt="스크린샷 2025-04-05 9 23 12" src="https://github.com/user-attachments/assets/a703e5fd-e22c-4c64-9618-668b9172e18d" />

<br>

> ⑤ **步骤3-3.** 拉格朗日方法的第二次应用：应用于其余4个变量

<br>

<img width="507" alt="스크린샷 2025-04-05 9 23 35" src="https://github.com/user-attachments/assets/6e0514af-8329-4fa0-8728-11096a107d27" />

<br>

> ⑥ **步骤3-4.** 将复方程表示为更新公式

<br>

<img width="671" alt="스크린샷 2025-04-05 9 23 49" src="https://github.com/user-attachments/assets/7a3cfaad-f325-4d63-aba9-04dbcebf80a4" />

<br>

> ⑦ **步骤3-5.** 最终结论

<br>

<img width="666" alt="스크린샷 2025-04-05 9 24 13" src="https://github.com/user-attachments/assets/9bf24b95-0f52-447e-96db-9580a1e8fd8e" />

<br>

> ⑧ 求解复杂方程的数值过程：不保证解的唯一性或收敛性

<br><img width="317" alt="스크린샷 2025-04-05 9 24 29" src="https://github.com/user-attachments/assets/2413099b-4c73-49e4-a161-b152bebe3520" />

**图10.** 复杂方程的数值求解

<br>

<br>

## **3。结果**

 ⑴ Visium 数据显示典型的皮肤结构

> ① 主要显示皮肤的下表皮和真皮部分，由表皮、真皮、平滑肌组成

> ② 真皮内层为基底细胞，符合预期

> ③ 从伪时间结果看，基底细胞分裂并产生其他细胞

<br>

<img width="496" alt="스크린샷 2025-04-05 오후 9 24 52" src="https://github.com/user-attachments/assets/cbfd0ea7-f062-4d95-9436-f3147980aa60" />

**图 11.** Visium 皮肤数据

<br>

 ⑵ **值得注意的互动**

> ① COMMOT 推断的 GAS6-TYRO3 相互作用

> ② 配体 i、受体 j 和斑点 l 的相互作用强度计算如下： 结果

<br>

<img width="262" alt="스크린샷 2025-04-05 오후 9 25 09" src="https://github.com/user-attachments/assets/37c93173-af82-404d-8aea-99fa85ade2f1" />

**图 12. **GAS6-TYRO3 相互作用强度的可视化

<br>

> ③簇间相互作用强度计算如下

<br>

<img width="306" alt="스크린샷 2025-04-05 9 25 27" src="https://github.com/user-attachments/assets/fb6ecf4f-6c8a-4031-8d92-941ea9f72404" />

 **图 13.** 簇级 GAS6-TYRO3 相互作用强度

<br>

> ④ GAS6-TYRO3 相互作用经过实验验证

<br>

<img width="451" alt="스크린샷 2025-04-05 9 25 42" src="https://github.com/user-attachments/assets/f6d9ec10-0d8f-4598-b7a8-78cb4c4de015" />

**图14.** GAS6-TYRO3的实验验证

<br>

> ⑤ GAS-TYRO3相互作用被称为先天性免疫抑制剂，可能与非常规T细胞（例如γδT细胞、MAIT细胞）在皮肤组织稳态和局部免疫反应中的作用有关

 ⑶ **值得注意的途径**

> ① 相互作用方向：定义为仅限于主要途径的配体-受体对的相关运输计划条目的向量和。由于基底细胞增殖中的拮抗作用，WNT 和 TGF-β 具有相似的方向

<br>

<img width="592" alt="스크린샷 2025-04-05 오후 9 26 03" src="https://github.com/user-attachments/assets/6ed489a2-d00f-41a3-91bf-0b7b61ba8361" />

**图 15.** 主要途径的相互作用方向

<br>

> ② 与基底细胞增殖相关的基底细胞标志物（KRT15、KRT5）和颗粒细胞标志物（LOR、FLG）在WNT、TGF-β等信号通路中突出

<br>

<img width="706" alt="스크린샷 2025-04-05 9 26 25" src="https://github.com/user-attachments/assets/83d441e3-5aa2-4c4c-9c79-1ec28be69278" />

**图16. **主要通路和基因关联分析的相互作用强度

<br>

 ⑷ **值得注意的可视化**

<br>

<img width="723" alt="스크린샷 2025-04-05 오후 9 26 41" src="https://github.com/user-attachments/assets/cad2889a-a182-47a1-a069-935e4e081d78" />

**图 17. **其他值得注意的可视化

<br>

<img width="518" alt="스크린샷 2025-04-05 오후 9 27 09" src="https://github.com/user-attachments/assets/f14f3516-04b8-4ca3-930b-638e41443038" />
 
**图 18.** 其他值得注意的可视化

（通过点嵌入进行点聚类）

<br>

<br>

## **4。讨论**

 ⑴ 优势

> ① 能够分析多物种相互作用

> ② 提供各种下游分析

> ③ 在五个 ST 平台和各种组织中进行验证

> ④ 运行在Python上，比较容易使用

 ⑵ 局限性

> ① 在成本函数中用作空间截止的 1000 μm 在生物学上是有问题的

> ② COT解的收敛性和唯一性没有得到充分验证> ③ 配体-受体相互作用不包括蛋白质丰度和修饰

> ④ 无法分析三重相互作用

<br>

<img width="367" alt="스크린샷 2025-04-05 9 27 33" src="https://github.com/user-attachments/assets/a03e0d40-9c2a-4a3b-9dec-965a478c5fa1" />

 **图 19.** 使用 AlphaFold3 进行 FCER2A、ITGAX、ITGB2 的三重相互作用

<br>

<br>

## **5。实施**

⑴ Anaconda环境搭建

<br>

__受保护_0__

<br>

⑵Python代码

<br>

<img width="706" height="342" alt="스크린샷 2025-12-09 오후 5 03 39" src="https://github.com/user-attachments/assets/f23aea0e-48de-4438-a589-811bde9782c6" />

<br>

---
 
_输入：2025.04.05 08:33_