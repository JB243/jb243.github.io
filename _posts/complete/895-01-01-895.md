## Stochastic Control Theory

Recommended post: 【Control Theory】 [Table of Contents for Control Theory](https://jb243.github.io/pages/1909)

---

**1.** [Sigma-algebra](#1-sigma-algebra)

**2.** [Terminology of Stochastic Control Theory](#2-terminology-of-stochastic-control-theory)

**3.** [Laws of Stochastic Control Theory](#3-laws-of-stochastic-control-theory)

---

**a.** [Reinforcement Learning](https://jb243.github.io/pages/2162)

**b.** [The Power of Belief](https://jb243.github.io/pages/869)

---

<br>

## **1. Sigma-algebra**

⑴ [Probability Space](https://jb243.github.io/pages/1623)

⑵ [Sigma-algebra](https://jb243.github.io/pages/910)(σ-algebra)

<br>

<br>

## **2. Terminology of Stochastic Control Theory**

⑴ Variable definitions

> ① **state** (system state) x<sub>t</sub>**:** denotes a specific value or a random variable; same below

> ② **observation** y<sub>t</sub>**:** in the perfect observation case, y<sub>t</sub> = x<sub>t</sub>

> ③ **noise** (system noise), **disturbance**, **primitive random variable** w<sub>t</sub>, v<sub>t</sub>

> ④ **system state noise** w<sub>t</sub>

> ⑤ **observation noise** v<sub>t</sub>

> ⑥ primitive random seed creating stochastic uncertainty x<sub>0</sub>

> ⑦ **control** u<sub>t</sub>

> ⑧ **control strategy / law / policy** g<sub>t</sub>

> ⑨ **system state sequence** `x<sub>t+1</sub> := f<sub>t</sub>(x<sub>t</sub>, u<sub>t</sub>, w<sub>t</sub>)`

> ⑩ **observation sequence** `y<sub>t</sub> := h<sub>t</sub>(x<sub>t</sub>, v<sub>t</sub>)`

> ⑪ **control input**, **action** `u<sub>t</sub> := g<sub>t</sub>(y<sub>0:t</sub>, u<sub>0:t-1</sub>)`. Using all past information is called **perfect recall**.

⑵ Classification by system sequence

> ① **DDS** (deterministic system)**:** `x<sub>t+1</sub> := f<sub>t</sub>(x<sub>t</sub>, u<sub>t</sub>, w<sub>t</sub>) = f<sub>t</sub>(x<sub>t</sub>, u<sub>t</sub>). y<sub>t</sub> := h<sub>t</sub>(x<sub>t</sub>, v<sub>t</sub>) = h<sub>t</sub>(x<sub>t</sub>)`. Case where at any time t both the state variable xt and the output variable y<sub>t</sub> are known

> ② **SDS** (stochastic dynamical model): `x<sub>t+1</sub> := f<sub>t</sub>(x<sub>t</sub>, u<sub>t</sub>, w<sub>t</sub>), y<sub>t+1</sub> := h<sub>t</sub>(x<sub>t</sub>, v<sub>t</sub>), w<sub>t</sub>, v<sub>t</sub> ≢ 0`.

⑶ Classification by control input

> ① **open loop control**: `u<sub>t</sub> := g<sub>t</sub>(y<sub>0:t</sub>, u<sub>0:t-1</sub>) = g<sub>t</sub>(u<sub>0:t-1</sub>)`.

> ② **feedback control**: cases where past outputs y<sub>0:t</sub> influence the control action u

> ③ **centralized stochastic control :** **(1)** stochastic dynamical system + **(2)** one controller + **(3)** controller with perfect recall

> ④ **multi-controller problem**: team problem, competitive game, etc.

⑷ Classification by policy

> ① **decision process**: a general framework that deals with decision-making problems where state, action, and reward follow through a process

> ② **Markov process**: (regardless of whether it is a decision process) the future depends only on the current state

<br>

<img width="577" height="29" alt="image" src="https://github.com/user-attachments/assets/5ce57777-d8e9-4464-ad03-14c48e2c9e82" />

<br>

>> ○ **Markov chain**: among Markov processes, refers to those with a finite or countably infinite state space

>> ○ **controlled Markov chain**: Markov chain + decision process

<br>

<img width="330" height="26" alt="스크린샷 2025-10-05 오전 2 11 59" src="https://github.com/user-attachments/assets/4433ae56-3122-497e-b289-8897944f23b9" />

<br>

> ③ **MDP** (Markov decision process): among decision processes, cases where the future depends only on the current state

>> ○ **dynamic programming**: recurrence relation (break the time dependence). If MDP refers to the system framework, dynamic programming refers to the methodology.

>> ○ **POMDP** (partially observed Markov decision process): an MDP system where only partial information rather than full state information can be used

>> ○ **constrained MDP**, **constrained POMDP** also exist

>> ○ [Related algorithms](https://jb243.github.io/pages/2162)

> ④ **Gaussian process**: the state process {X<sub>t</sub>} is such that any finite subset follows a joint Gaussian distribution

> ⑤ **Gaussian-Markov process**

>> ○ **Condition 1.** {X<sub>t</sub>} is a Gaussian process

>> ○ **Condition 2.** Markov property: P(X<sub>n+1</sub> ∈ A | X<sub>0</sub>, ···, X<sub>n</sub>) = P(X<sub>n+1</sub> ∈ A | X<sub>n</sub>)

<br>

<br>

## **3. Laws of Stochastic Control Theory**

⑴ **Lemma 1.** In open-loop control, x<sub>t</sub> is a function of x<sub>0</sub>, u<sub>0:t-1</sub>, w<sub>0:t-1</sub>, and y<sub>t</sub> is a function of x<sub>0</sub>, u<sub>0:t-1</sub>, w<sub>0:t-1</sub>, v<sub>t</sub>

<br>

<img width="599" height="207" alt="스크린샷 2025-10-05 오전 2 13 47" src="https://github.com/user-attachments/assets/ac28b4fd-761c-4b26-948d-c19f489626d5" />

<br>

⑵ **Lemma 2.** open-loop system vs. feedback system

> ① Under DDS, open-loop and feedback systems are equivalent: because uniqueness of u<sub>t</sub> in DDS naturally holds,

<br>

<img width="549" height="126" alt="스크린샷 2025-10-05 오전 2 14 14" src="https://github.com/user-attachments/assets/26b25c6a-7f14-447a-830c-c2f394adc13f" />

<br>

> ② Under SDS, open-loop and feedback systems are not equivalent

>> ○ **Counterexample 1.**

<br>

<img width="298" height="368" alt="스크린샷 2025-10-05 오전 2 14 49" src="https://github.com/user-attachments/assets/fcac0b86-524a-4099-bcad-0cfe27647da7" />

<br>

⑶ **Lemma 3.** **policy independence**: If W<sub>t</sub> is independent of X<sub>0:t-1</sub>, U<sub>0:t-1</sub>, then ℙ(x<sub>t+1</sub><sup>g</sup> ∈ A | x<sub>0:t</sub>, u<sub>0:t</sub>) = ℙ(x<sub>t+1</sub><sup>g</sup> ∈ A | x<sub>t</sub>, u<sub>t</sub>) = ℙ(f<sub>t</sub>(x<sub>t</sub>, u<sub>t</sub>, w<sub>t</sub>) ∈ A | x<sub>t</sub>, u<sub>t</sub>) (**Markov property**), so dependence on policy g disappears

<br>

<img width="300" height="285" alt="스크린샷 2025-10-05 오전 2 16 25" src="https://github.com/user-attachments/assets/a841d6d1-4d9a-46f9-9f78-b5753b49c126" />

<br>

> ① In DDS, if you know the current state, you can know the next state immediately, but in SDS, past states matter, so conditional probabilities on the history are important.

> ② That is, when w<sub>t</sub> is independent, system evolution follows natural laws + pure noise, so the policy is irrelevant; but if w<sub>t</sub> depends on the policy, the policy changes the noise distribution, so the future state distribution depends on the policy.

> ③ Sometimes written as W<sub>t</sub> ⫫ x<sub>0</sub>, U<sub>0:t-1</sub>, W<sub>0:t-2</sub> instead of W<sub>t</sub> ⫫ x<sub>0</sub>, U<sub>0:t-1</sub>, but the former is a stronger claim.

⑷ **Lemma 4.** **Gaussian process** (GP)

> ① Definition: the state process {X<sub>t</sub>} is such that any finite subset follows a joint Gaussian distribution

> ② **4-1.** Even if each X<sub>i</sub> is Gaussian, it does not imply {X<sub>i</sub>}<sub>i∈ℕ</sub> is a GP.

>> ○ Example: X<sub>2</sub> = X<sub>1</sub> *I*{|X<sub>1</sub>| ≤ k} + (-X<sub>1</sub>) *I*{|X<sub>1</sub>| > k}, Y = (X<sub>1</sub> + X<sub>2</sub>) / 2 is not a GP

> ③ **4-2.** For X<sub>t+1</sub> = AX<sub>t</sub> + BU<sub>t</sub> + GW<sub>t</sub>, X<sub>0</sub> ~ 𝒩(0, ∑<sub>0</sub>), W<sub>t</sub> ~ 𝒩(0, Q), {X<sub>t</sub>} is a GP

> ④ **4-3.** Under a feedback policy, {Xt} is generally not a GP

> > ○ Example: If Ut := gt(Yt) = gt(Xt) = Xt2, then X1 = AX0 + BX02 + GW0, which is not Gaussian

> ⑤ (Note) **MMSE** (minimum mean-square estimator)

> ⑥ (Note) **orthogonality principle**

> ⑦ (Note) **LMMSE** (linear minimum mean-square estimator): If X and Y are jointly Gaussian, then LMMSE = MMSE holds

⑸ **Lemma 5.** **multi-step prediction**

> ① In general, ℙ(xt+2g ∈ A | xt, ut, ut+1) ≠ ℙ(xt+2g ∈ A | x0:t, u0:t+1)

> ② Since ut+1 = gt(y0:t+1, u0:t) that is not independent of u0:t-1 implies information about wt via observation, conditioning on ut+1 breaks the past-independence of wt: here “past” means x0:t-1, u0:t-1

> > ○ **Counterexample 1.** In open-loop control, ut+1 = gt(u0:t) holds, so it cannot imply information about wt, hence equality holds.

> > ○ **Counterexample 2.** When wt is a constant

> > ○ **Counterexample 3.** When ut is defined to have the Markov property and memoryless feedback, e.g., ut = μt(xt): the following is the case yt = xt = ut

> ③ multi-step prediction with open-loop control

> ④ **Chapman-Kolmogorov decomposition**

⑹ **Lemma 6.** **linear Gaussian state-space model**

> ① (Note) **Gaussian-Markov process**

> > ○ **Condition 1.** {Xt} is a Gaussian process

> > ○ **Condition 2.** Markov property: P(Xn+1 ∈ A | X0, ···, Xn) = P(Xn+1 ∈ A | Xn)

> ② System definition

> > ○ Markov property: applies even with feedback policy

> > ○ multi-step Markov property

> > ○ mean propagation

> > ○ cross-covariance Cov(**X** t+m, **X** t)

> > ○ covariance propagation

> ③ **DALE** (discrete-time algebraic Lyapunov equation)

> > ○ If the absolute values of all eigenvalues (including complex ones) of a square matrix A are less than 1, the matrix is defined as stable: because A∞ = 0

> > ○ If A is stable, then ∑∞ = limt→∞ ∑t = limt→∞ 𝔼[(Xt - 𝔼[Xt])(Xt - 𝔼[Xt])ᵀ] exists uniquely

> > ○ Proof of uniqueness of ∑∞

> > ○ stability of A is a **sufficient**, but **not necessary** condition: ∑∞ may still exist uniquely even if A is not stable

> ④ **reachability**

> > ○ Definition

> > ○ **Theorem 1.** The following are all equivalent: assume w ∈ ℝs

> > > ○ In condition 3, the noise sequence w should be interpreted as the control input applied to the system; due to them, the system can be steered from 0 to a given state x over n time steps.

> > ○ **Theorem 2.** **Lyapunov stability test**

> > > ○ Note that in condition 2 it is PD (positive definite), not PSD (positive semidefinite)

⑺ **Lemma 7.** [Graph Theory](https://jb243.github.io/pages/616)

> ① strongly connected (= irreducible, communicable): a condition where from any node i in the graph one can reach any other node j

**Figure. 1.** Example of irreducible

**Figure. 2.** Example of reducible (state 3 is a sink)

> ② period**:** the period of a specific node i is the greatest common divisor of the lengths of all paths from i back to i

> > ○ Example: with two nodes A, B connected by two edges A=B, the period of each node is 2

**Figure. 3.** Example of a matrix with period m

S1 → S2 → ··· → Sm → S1 → ··· has such a cycle

> ③ aperiodic: all nodes have period 1

> > ○ aperiodic ⊂ irreduicible

> > ○ Example: if each node has a walk to itself, it is aperiodic

> ④ stationary state: If Pr(xn | xn-1) is independent of n, the Markov process is stationary (time-invariant)

> ⑤ regular

> > ○ regular ⊂ irreduicible

> > ○ For some natural number k, every entry of the power Mk of the transition matrix M is positive (i.e., nonzero)

> ⑥ transition matrix

> ⑦ Markov policy: ut = gt(xt)

> ⑧ One can prove the second law of thermodynamics (law of increasing entropy) using a Markov process

> > ○ Because one can simulate the law of diffusion: provided a uniform stationary distribution is assumed

> > ○ Related concept: random walk

> ⑨ **Perron-Frobenius theorem**

> > ○ **Theorem 1.** If a Markov chain with transition matrix P is strongly connected, there exists exactly one stationary distribution **q**

> > > ○ The stationary distribution satisfies P**q** = **q**

> > ○ **Theorem 2.** If a Markov chain with transition matrix P is strongly connected and aperiodic, it is called an **Ergodic Markov chain** and satisfies:

> > > ○ Pij: probability of transition from node j to node i. ∑i Pij = 1

> > > ○ **2-1.** The (i, j) entry Pij(k) of Pk converges to **q** i as k → ∞: note it converges to the same value for fixed i regardless of j

> > > ○ **2-2.** Regardless of the initial state **x** 0, the k-th state **x** k converges to **q** as k → ∞

⑻ **Lemma 8.** value function

> ① **recursive and backward iteration**: for example, with present value (discounting future value to present),

> > ○ JTg ∈ ℝ1×1

> > ○ π0 ∈ ℝ1×n: initial distribution of the Markov chain

> > ○ V0g ∈ ℝn×1: vector of state-wise value functions collecting expected cumulative cost at each state under policy g

> ② **Bellman equation****:** related to the discounted cost problem

> > ○ (Note) time-homogeneous: {xtg}t≥0 and {xtg}t≥τ,∀τ∈ℤ+ follow the same distribution

> > ○ **Condition 1.** time-homogeneous transition: Pt(j | i, u) = P(j | i, u) ∀t

> > ○ **Condition 2.** time-homogeneous cost: Ct(x, y) = C(x, y) ∀t

> > ○ **Condition 3.** stationary policy: gt = g ∀t

> > ○ If all the above hold, one can obtain the following fixed-point equation

> > ○ Since Pg is stable, all eigenvalues have absolute value less than 1, so det(I - βPg) = β det( (1/β)I - Pg ) ≠ 0

> > > ○ Vg ∈ ℝn×1: vector of state-wise value functions collecting expected discounted cumulative cost at each state under policy g

> > > ○ Pg ∈ ℝn×n: transition matrix; the (i, j) entry is the probability of transition from i to j

> ③ **Cesàro limit**: related to the long-term average cost problem

> ④ **Poisson equation**: related to average cost

> > ○ Jg is unique

> > ○ Lg: relative value function. Lg is not unique (**∵** Lg + α**1** ∀α ∈ ℝ is also a solution to the Poisson equation)

> > ○ Existence of solutions

⑼ **Lemma 9.** When not irreducible

> ① If Pg is not irreducible, the state space S splits into the transient states T and one or more recurrent communicating classes C1, ···

> ② transient state: visited only finitely many times. Eventually the process leaves the transient states and enters a recurrent state.

> > ○ The stationary distribution πg assigns probability 0 to all transient states.

> ③ recurrent state: since a recurrent communicating class is a closed set, no communication occurs with outside nodes

> > ○ i → j: means there exists a path with positive probability from i to j

> > ○ i ↔︎ j: means i → j and j → i; i and j communicate

> > ○ positive recurrent: the mean return time to that state is finite. A chain starting in a positive recurrent state has a unique stationary distribution.

> > ○ null recurrent: the mean return time to that state is infinite. No stationary distribution exists.

> > ○ absorbing state: a state that, once entered, you remain in forever

> ④ **Example 1.** Finite state space

> > Let S = {0, 1, ···, I}. Since Vg(0) = 0 and C(0, g(0)) = 0, we can focus only on Ś = S \ {0} = {1, ···, I}, the non-absorbing states. Let Ṽg be the value vector for states in Ś, and let Rg be the submatrix of Pg for transitions among states inside Ś. Then the system of equations for these states is Ṽg = c̃ + RgṼg. To show uniqueness of Ṽg, suppose there are two solutions Ṽ1g, Ṽ2g. Let their difference be Ug = Ṽ1g - Ṽ2g; subtracting the two equations yields Ug = RgUg = ⋯ = (Rg)nUg = ⋯ = **0** (∵ limn→∞ (Rg)n = 0, method of infinite descent) ⇔ Ṽ1g = Ṽ2g. Thus, in a finite state space where state 0 is absorbing and all other states can reach 0, the first-passage-time cost equation has a unique nonnegative solution.

> ⑤ **Example 2.** Countably infinite state space

> > Uniqueness is not trivial. Assuming the solution is bounded often allows one to show uniqueness. Consider the equation for the difference of two solutions Ug = RgUg. Connecting this to the Bellman equation yields Ug(ℓ+1) - Ug(ℓ) = (λ - 1)(Ug(ℓ) - Ug(ℓ-1)). The consecutive differences Δ(ℓ) = Ug(ℓ+1) - Ug(ℓ) form a geometric sequence with ratio (λ - 1). If |λ - 1| < 1, these differences converge to 0, suggesting a bounded solution. If |λ - 1| ≥ 1, the differences may diverge, implying that uniqueness may fail.

⑽ **Lemma 10.**
[Martingale](https://jb243.github.io/pages/910)

> ① **Doob's theorem**

> > ○ σ(X1, X2, ···, Xn): the smallest σ-algebra that makes X1, X2, ···, Xn measurable

> > ○ Doob's theorem: σ(X1, X2, ···, Xn) is equivalent to the collection of all functions of the form g(X1, X2, ···, Xn)

> > ○ The larger the σ-algebra, the more functions are measurable with respect to it; i.e., the more information it contains.

> ② filtration

> > ○ a collection of σ-algebras ordered increasingly by inclusion

> > ○ Ordered by ⊆; if ℱ1 ⊆ ℱ2, then ℱ2 is afterwards relative to ℱ1

> > ○ For convenience, let time index t = 0, 1, 2, ⋯; then the filtration is {ℱt} t∈ℤ+ and satisfies ℱs ⊆ ℱt for all s ≤ t

> > ○ Intuition: represents situations where information increases as observations accumulate over time

> ③ **martingale**

> > ○ Property of conditional expectation

> > > ○ For any random variable Y, 𝔼[Y | X1, ···, Xn] = 𝔼[Y | σ(X1, ···, Xn)] holds

> > > ○ Reason: because σ(X1, ···, Xn) is equivalent to the set of all functions generated by X1, ···, Xn

> > ○ Martingale: a stochastic process {Xt}t∈ℤ+ adapted to a filtration {ℱt}t∈ℤ+ that satisfies all of the following

> > > ○ **Condition 1.** Xt is ℱt-measurable for all t ∈ ℤ+

> > > ○ **Condition 2.** 𝔼[|Xt|] is finite for all t ∈ ℤ+

> > > ○ **Condition 3.** 𝔼[Xt | ℱs] = Xs almost surely for all s ≤ t and all t ∈ ℤ+

> > ○ Note: an i.i.d. process is generally not a martingale (except for the constant process)

> > ○ Application: 𝔼[Ug(Xtg) | Xt-1g] = Ug(Xt-1g)

Input: 2025.08.26 23:34
